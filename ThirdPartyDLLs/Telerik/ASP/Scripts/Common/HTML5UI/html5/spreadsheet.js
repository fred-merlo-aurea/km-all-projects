(function(b,a){a("util/undoredostack",["kendo.core"],b);
}(function(){(function(a){var b=a.Observable.extend({init:function(c){a.Observable.fn.init.call(this,c);
this.clear();
},events:["undo","redo"],push:function(c){this.stack=this.stack.slice(0,this.currentCommandIndex+1);
this.currentCommandIndex=this.stack.push(c)-1;
},undo:function(){if(this.canUndo()){var c=this.stack[this.currentCommandIndex--];
c.undo();
this.trigger("undo",{command:c});
}},redo:function(){if(this.canRedo()){var c=this.stack[++this.currentCommandIndex];
c.redo();
this.trigger("redo",{command:c});
}},clear:function(){this.stack=[];
this.currentCommandIndex=-1;
},canUndo:function(){return this.currentCommandIndex>=0;
},canRedo:function(){return this.currentCommandIndex!=this.stack.length-1;
}});
a.deepExtend(a,{util:{UndoRedoStack:b}});
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("util/main",["kendo.core"],b);
}(function(){(function(){var q=Math,n=window.kendo,f=n.deepExtend;
var i=q.PI/180,r=Number.MAX_VALUE,u=-Number.MAX_VALUE,N="undefined";
function g(P){return typeof P!==N;
}function G(R,Q){var P=x(Q);
return q.round(R*P)/P;
}function x(P){if(P){return q.pow(10,P);
}else{return 1;
}}function p(R,Q,P){return q.max(q.min(R,P),Q);
}function y(P){return P*i;
}function h(P){return P/i;
}function l(P){return typeof P==="number"&&!isNaN(P);
}function O(Q,P){return g(Q)?Q:P;
}function K(P){return P*P;
}function w(Q){var R=[];
for(var P in Q){R.push(P+Q[P]);
}return R.sort().join("");
}function j(R){var P=2166136261;
for(var Q=0;
Q<R.length;
++Q){P+=(P<<1)+(P<<4)+(P<<7)+(P<<8)+(P<<24);
P^=R.charCodeAt(Q);
}return P>>>0;
}function k(P){return j(w(P));
}var v=Date.now;
if(!v){v=function(){return new Date().getTime();
};
}function c(P){var R=P.length,Q,T=r,S=u;
for(Q=0;
Q<R;
Q++){S=q.max(S,P[Q]);
T=q.min(T,P[Q]);
}return{min:T,max:S};
}function e(P){return c(P).min;
}function d(P){return c(P).max;
}function J(P){return H(P).min;
}function I(P){return H(P).max;
}function H(P){var T=r,S=u;
for(var Q=0,R=P.length;
Q<R;
Q++){var U=P[Q];
if(U!==null&&isFinite(U)){T=q.min(T,U);
S=q.max(S,U);
}}return{min:T===r?undefined:T,max:S===u?undefined:S};
}function o(P){if(P){return P[P.length-1];
}}function a(P,Q){P.push.apply(P,Q);
return P;
}function E(P){return n.template(P,{useWithBlock:false,paramName:"d"});
}function A(P,Q){return g(Q)&&Q!==null?" "+P+"='"+Q+"' ":"";
}function z(P){var R="";
for(var Q=0;
Q<P.length;
Q++){R+=A(P[Q][0],P[Q][1]);
}return R;
}function D(P){var R="";
for(var Q=0;
Q<P.length;
Q++){var S=P[Q][1];
if(g(S)){R+=P[Q][0]+":"+S+";";
}}if(R!==""){return R;
}}function C(P){if(typeof P!=="string"){P+="px";
}return P;
}function B(R){var S=[];
if(R){var Q=n.toHyphens(R).split("-");
for(var P=0;
P<Q.length;
P++){S.push("k-pos-"+Q[P]);
}}return S.join(" ");
}function m(P){return P===""||P===null||P==="none"||P==="transparent"||!g(P);
}function b(Q){var P={1:"i",10:"x",100:"c",2:"ii",20:"xx",200:"cc",3:"iii",30:"xxx",300:"ccc",4:"iv",40:"xl",400:"cd",5:"v",50:"l",500:"d",6:"vi",60:"lx",600:"dc",7:"vii",70:"lxx",700:"dcc",8:"viii",80:"lxxx",800:"dccc",9:"ix",90:"xc",900:"cm",1000:"m"};
var S=[1000,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1];
var R="";
while(Q>0){if(Q<S[0]){S.shift();
}else{R+=P[S[0]];
Q-=S[0];
}}return R;
}function F(S){S=S.toLowerCase();
var P={i:1,v:5,x:10,l:50,c:100,d:500,m:1000};
var U=0,R=0;
for(var Q=0;
Q<S.length;
++Q){var T=P[S.charAt(Q)];
if(!T){return null;
}U+=T;
if(T>R){U-=2*R;
}R=T;
}return U;
}function s(Q){var P=Object.create(null);
return function(){var S="";
for(var R=arguments.length;
--R>=0;
){S+=":"+arguments[R];
}if(S in P){return P[S];
}return Q.apply(this,arguments);
};
}function L(T){var S=[],P=0,R=T.length,U,Q;
while(P<R){U=T.charCodeAt(P++);
if(U>=55296&&U<=56319&&P<R){Q=T.charCodeAt(P++);
if((Q&64512)==56320){S.push(((U&1023)<<10)+(Q&1023)+65536);
}else{S.push(U);
P--;
}}else{S.push(U);
}}return S;
}function M(P){return P.map(function(R){var Q="";
if(R>65535){R-=65536;
Q+=String.fromCharCode(R>>>10&1023|55296);
R=56320|R&1023;
}Q+=String.fromCharCode(R);
return Q;
}).join("");
}function t(P,Q){if(P.length<2){return P.slice();
}function R(T,V){var Y=[],U=0,W=0,X=0;
while(U<T.length&&W<V.length){if(Q(T[U],V[W])<=0){Y[X++]=T[U++];
}else{Y[X++]=V[W++];
}}if(U<T.length){Y.push.apply(Y,T.slice(U));
}if(W<V.length){Y.push.apply(Y,V.slice(W));
}return Y;
}return function S(T){if(T.length<=1){return T;
}var V=Math.floor(T.length/2);
var U=T.slice(0,V);
var W=T.slice(V);
U=S(U);
W=S(W);
return R(U,W);
}(P);
}f(n,{util:{MAX_NUM:r,MIN_NUM:u,append:a,arrayLimits:c,arrayMin:e,arrayMax:d,defined:g,deg:h,hashKey:j,hashObject:k,isNumber:l,isTransparent:m,last:o,limitValue:p,now:v,objectKey:w,round:G,rad:y,renderAttr:A,renderAllAttr:z,renderPos:B,renderSize:C,renderStyle:D,renderTemplate:E,sparseArrayLimits:H,sparseArrayMin:J,sparseArrayMax:I,sqr:K,valueOrDefault:O,romanToArabic:F,arabicToRoman:b,memoize:s,ucs2encode:M,ucs2decode:L,mergeSort:t}});
n.drawing.util=n.util;
n.dataviz.util=n.util;
}());
return window.kendo;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("util/text-metrics",["kendo.core","util/main"],b);
}(function(){(function(a){var e=document,f=window.kendo,b=f.Class,k=f.util,d=k.defined;
var h=b.extend({init:function(m){this._size=m;
this._length=0;
this._map={};
},put:function(n,q){var o=this,p=o._map,m={key:n,value:q};
p[n]=m;
if(!o._head){o._head=o._tail=m;
}else{o._tail.newer=m;
m.older=o._tail;
o._tail=m;
}if(o._length>=o._size){p[o._head.key]=null;
o._head=o._head.newer;
o._head.older=null;
}else{o._length++;
}},get:function(n){var o=this,m=o._map[n];
if(m){if(m===o._head&&m!==o._tail){o._head=m.newer;
o._head.older=null;
}if(m!==o._tail){if(m.older){m.older.newer=m.newer;
m.newer.older=m.older;
}m.older=o._tail;
m.newer=null;
o._tail.newer=m;
o._tail=m;
}return m.value;
}}});
var c=a("<div style='position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;padding: 0 !important; margin: 0 !important; border: 0 !important;line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;' />")[0];
function l(){return{width:0,height:0,baseline:0};
}var j=b.extend({init:function(m){this._cache=new h(1000);
this._initOptions(m);
},options:{baselineMarkerSize:1},measure:function(v,t,n){if(!v){return l();
}var u=k.objectKey(t),p=k.hashKey(v+u),o=this._cache.get(p);
if(o){return o;
}var s=l();
var r=n?n:c;
var m=this._baselineMarker().cloneNode(false);
for(var q in t){var w=t[q];
if(d(w)){r.style[q]=w;
}}a(r).text(v);
r.appendChild(m);
e.body.appendChild(r);
if((v+"").length){s.width=r.offsetWidth-this.options.baselineMarkerSize;
s.height=r.offsetHeight;
s.baseline=m.offsetTop+this.options.baselineMarkerSize;
}if(s.width>0&&s.height>0){this._cache.put(p,s);
}r.parentNode.removeChild(r);
return s;
},_baselineMarker:function(){return a("<div class='k-baseline-marker' style='display: inline-block; vertical-align: baseline;width: "+this.options.baselineMarkerSize+"px; height: "+this.options.baselineMarkerSize+"px;overflow: hidden;' />")[0];
}});
j.current=new j();
function i(o,n,m){return j.current.measure(o,n,m);
}function g(o,m){var p=[];
if(o.length>0&&document.fonts){try{p=o.map(function(q){return document.fonts.load(q);
});
}catch(n){f.logToConsole(n);
}Promise.all(p).then(m,m);
}else{m();
}}f.util.TextMetrics=j;
f.util.LRUCache=h;
f.util.loadFonts=g;
f.util.measureText=i;
}(window.kendo.jQuery));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("util/parse-xml",["kendo.core","util/main"],b);
}(function(){var w=String.fromCharCode;
var i={amp:38,lt:60,gt:62,quot:34,apos:39,nbsp:160};
function c(B){var A=[];
for(var z=0;
z<B.length;
++z){A.push(B.charCodeAt(z));
}return A;
}function x(A,z){if(z>65535){z-=65536;
A.push(z>>>10&1023|55296,56320|z&1023);
}else{A.push(z);
}}var u=c("<![CDATA[");
var d=c("]]>");
var e=c("-->");
var v=c("!--");
var g=c("/>");
var h=c("</");
var f=c("?>");
var q=c("?");
var m=c("<");
var l=c(">");
var s=c(";");
var j=c("=");
var a=c("&");
var r=c('"');
var b=c("'");
var t=c("#");
var n=c("x");
var y=c("X");
var k={};
function o(C,A){var E=0;
var Q=[];
var K={is:function(ac){var aa=Q.length,ab=ac.length;
while(--aa>=0&&--ab>=0){if(Q[aa].$tag!=ac[ab]&&ac[ab]!="*"){return false;
}}return ab<0?Q[Q.length-1]:null;
},exit:function(){throw k;
},stack:Q};
function M(aa){var ab=C[E++];
if(!(ab&240^240)){x(aa,(ab&3)<<18|(C[E++]&63)<<12|(C[E++]&63)<<6|C[E++]&63);
}else{if(!(ab&224^224)){x(aa,(ab&15)<<12|(C[E++]&63)<<6|C[E++]&63);
}else{if(!(ab&192^192)){x(aa,(ab&31)<<6|C[E++]&63);
}else{aa.push(ab);
}}}}function B(aa){throw new Error(aa+", at "+E);
}function N(ab){var aa=[];
while(E<C.length&&ab(C[E])){aa.push(C[E++]);
}return aa;
}function L(aa){return w.apply(0,N(aa));
}function P(){N(J);
}function D(aa){var ac=E;
for(var ab=0;
ab<aa.length;
++ab){if(C[E++]!=aa[ab]){E=ac;
return false;
}}return aa;
}function O(aa){if(!D(aa)){B("Expecting "+aa.join(", "));
}}function J(aa){return aa==9||aa==10||aa==13||aa==32;
}function F(aa){return aa>=48&&aa<=57;
}function G(aa){return aa>=48&&aa<=57||(aa|=32)>=97&&aa<=102;
}function I(aa){return aa==58||aa==95||(aa|=32)>=97&&aa<=122;
}function H(aa){return aa==45||F(aa)||I(aa);
}function T(){var aa=[];
while(E<C.length){if(D(e)){return z("comment",w.apply(0,aa));
}M(aa);
}}function Z(){var ab,aa;
if(D(q)){V();
}else{if(D(v)){T();
}else{ab=X();
aa=S(ab);
Q.push(aa);
if(D(g)){z("enter",ab,aa,true);
}else{O(l);
z("enter",ab,aa);
U(ab);
if(ab!=X()){B("Bad closing tag");
}z("leave",ab,aa);
P();
O(l);
}Q.pop();
}}}function U(ab){var aa=[];
while(E<C.length){if(D(h)){return aa.length&&z("text",w.apply(0,aa));
}else{if(D(u)){while(E<C.length&&!D(d)){M(aa);
}}else{if(D(m)){if(aa.length){z("text",w.apply(0,aa));
}Z();
aa=[];
}else{if(D(a)){W(aa);
}else{M(aa);
}}}}}B("Unclosed tag "+ab);
}function X(){if(!I(C[E])){B("Expecting XML name");
}return L(H);
}function Y(){var ab=D(r)||D(b);
if(!ab){B("Expecting string");
}var aa=[];
while(E<C.length){if(D(ab)){return w.apply(0,aa);
}else{if(D(a)){W(aa);
}else{M(aa);
}}}B("Unfinished string");
}function W(aa){var ab;
if(D(t)){if(D(n)||D(y)){ab=parseInt(L(G),16);
}else{ab=parseInt(L(F),10);
}if(isNaN(ab)){B("Bad numeric entity");
}}else{var ac=X();
ab=i[ac];
if(ab===undefined){B("Unknown entity "+ac);
}}x(aa,ab);
O(s);
}function V(){z("decl",X(),S());
O(f);
}function S(ac){var ab={$tag:ac};
while(E<C.length){P();
var aa=C[E];
if(aa==63||aa==62||aa==47){break;
}ab[X()]=(O(j),Y());
}return ab;
}function z(ae,ad,aa,ab){var ac=A&&A[ae];
if(ac){ac.call(K,ad,aa,ab);
}}var R=[];
M(R);
if(R[0]!=65279){E=0;
}while(E<C.length){P();
O(m);
Z();
P();
}}kendo.util.parseXML=function p(){try{return o.apply(this,arguments);
}catch(z){if(z!==k){throw z;
}}};
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("util/base64",["util/main"],b);
}(function(){(function(){var e=window.kendo,a=e.deepExtend,d=String.fromCharCode;
var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
function b(p){var q="";
var g,h,j,k,l,m,n;
var o=0;
p=c(p);
while(o<p.length){g=p.charCodeAt(o++);
h=p.charCodeAt(o++);
j=p.charCodeAt(o++);
k=g>>2;
l=(g&3)<<4|h>>4;
m=(h&15)<<2|j>>6;
n=j&63;
if(isNaN(h)){m=n=64;
}else{if(isNaN(j)){n=64;
}}q=q+f.charAt(k)+f.charAt(l)+f.charAt(m)+f.charAt(n);
}return q;
}function c(j){var k="";
for(var h=0;
h<j.length;
h++){var g=j.charCodeAt(h);
if(g<128){k+=d(g);
}else{if(g<2048){k+=d(192|g>>>6);
k+=d(128|g&63);
}else{if(g<65536){k+=d(224|g>>>12);
k+=d(128|g>>>6&63);
k+=d(128|g&63);
}}}}return k;
}a(e.util,{encodeBase64:b,encodeUTF8:c});
}());
return window.kendo;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("mixins/observers",["kendo.core"],b);
}(function(){(function(a){var e=Math,d=window.kendo,b=d.deepExtend,c=a.inArray;
var f={observers:function(){this._observers=this._observers||[];
return this._observers;
},addObserver:function(g){if(!this._observers){this._observers=[g];
}else{this._observers.push(g);
}return this;
},removeObserver:function(g){var i=this.observers();
var h=c(g,i);
if(h!=-1){i.splice(h,1);
}return this;
},trigger:function(i,g){var k=this._observers;
var j;
var h;
if(k&&!this._suspended){for(h=0;
h<k.length;
h++){j=k[h];
if(j[i]){j[i](g);
}}}return this;
},optionsChange:function(g){g=g||{};
g.element=this;
this.trigger("optionsChange",g);
},geometryChange:function(){this.trigger("geometryChange",{element:this});
},suspend:function(){this._suspended=(this._suspended||0)+1;
return this;
},resume:function(){this._suspended=e.max((this._suspended||0)-1,0);
return this;
},_observerField:function(g,h){if(this[g]){this[g].removeObserver(this);
}this[g]=h;
h.addObserver(this);
}};
b(d,{mixins:{ObserversMixin:f}});
}(window.kendo.jQuery));
return window.kendo;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/commands",["kendo.core","kendo.binder","kendo.window","kendo.list","kendo.tabstrip"],b);
}(function(){(function(g){if(g.support.browser.msie&&g.support.browser.version<9){return;
}var a=g.jQuery;
var d=g.spreadsheet.Command=g.Class.extend({init:function(k){this.options=k;
this._workbook=k.workbook;
this._property=k&&k.property;
this._state={};
},range:function(k){if(k!==undefined){this._setRange(k);
}return this._range;
},_setRange:function(k){this._range=k;
},redo:function(){this.exec();
},undo:function(){this.setState(this._state);
},getState:function(){this._state=this.range().getState(this._property);
},setState:function(k){this.range().setState(k);
},_forEachCell:function(k){var l=this.range();
var m=l._ref;
m.forEach(function(n){l.sheet().forEach(n.toRangeRef(),k.bind(this));
}.bind(this));
}});
var j=d.extend({init:function(k){d.fn.init.call(this,k);
this._target=k.target;
this._value=k.value;
},exec:function(){this.getState();
this.setState(this._value);
}});
g.spreadsheet.ColumnWidthCommand=j.extend({getState:function(){this._state=this.range().sheet().columnWidth(this._target);
},setState:function(k){this.range().sheet().columnWidth(this._target,k);
}});
g.spreadsheet.RowHeightCommand=j.extend({getState:function(){this._state=this.range().sheet().rowHeight(this._target);
},setState:function(k){this.range().sheet().rowHeight(this._target,k);
}});
g.spreadsheet.HyperlinkCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._link=k.link;
},exec:function(){var k=this.range();
this._prevLink=k.link();
k.link(this._link);
if(k.value()==null){this._hasSetValue=true;
k.value(this._link);
}},undo:function(){var k=this.range();
k.link(this._prevLink);
if(this._hasSetValue){k.value(null);
}}});
g.spreadsheet.GridLinesChangeCommand=j.extend({getState:function(){this._state=this._range.sheet().showGridLines();
},setState:function(k){this._range.sheet().showGridLines(k);
}});
var i=g.spreadsheet.PropertyChangeCommand=d.extend({_setRange:function(k){d.prototype._setRange.call(this,k.skipHiddenCells());
},init:function(k){d.fn.init.call(this,k);
this._value=k.value;
},exec:function(){var k=this.range();
if(k.enable()){this.getState();
k[this._property](this._value);
}}});
g.spreadsheet.ClearContentCommand=d.extend({exec:function(){this.getState();
this.range().clearContent();
}});
g.spreadsheet.EditCommand=i.extend({init:function(k){k.property=k.property||"input";
i.fn.init.call(this,k);
},rejectState:function(k){this.undo();
return{title:k.title,body:k.message,reason:"error",type:"validationError"};
},getState:function(){this._state=this.range().getState();
},exec:function(){var l=this.range();
var n=this._value;
this.getState();
if(this._property=="value"){l.value(n);
return;
}try{l.link(null);
if(n===""){l.value(null);
}else{l.input(n);
if(/\n/.test(l.value())){l.wrap(true);
}}l._adjustRowHeight();
var m=l._getValidationState();
if(m){return this.rejectState(m);
}}catch(k){if(k instanceof g.spreadsheet.calc.ParseError){return{title:"Error in formula",body:k+"",reason:"error"};
}else{throw k;
}}}});
g.spreadsheet.TextWrapCommand=i.extend({init:function(k){k.property="wrap";
i.fn.init.call(this,k);
this._value=k.value;
},getState:function(){var k={};
this.range().forEachRow(function(m){var l=m.topLeft().row;
k[l]=m.sheet().rowHeight(l);
});
this._state=this.range().getState(this._property);
this._rowHeight=k;
},undo:function(){var m=this.range().sheet();
var l=this._rowHeight;
this.range().setState(this._state);
for(var k in l){m.rowHeight(k,l[k]);
}}});
g.spreadsheet.AdjustDecimalsCommand=d.extend({init:function(k){this._decimals=k.value;
k.property="format";
d.fn.init.call(this,k);
},exec:function(){var m=this.range().sheet();
var k=this._decimals;
var l=g.spreadsheet.formatting;
this.getState();
m.batch(function(){this.range().forEachCell(function(q,o,n){var p=n.format;
if(p||k>0){p=l.adjustDecimals(p||"#",k);
m.range(q,o).format(p);
}});
}.bind(this));
}});
g.spreadsheet.BorderChangeCommand=d.extend({init:function(k){k.property="border";
d.fn.init.call(this,k);
this._type=k.border;
this._style=k.style;
},exec:function(){this.getState();
this[this._type](this._style);
},noBorders:function(){var k=this.range();
k.sheet().batch(function(){k.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);
}.bind(this),{});
},allBorders:function(l){var k=this.range();
k.sheet().batch(function(){k.borderLeft(l).borderTop(l).borderRight(l).borderBottom(l);
}.bind(this),{});
},leftBorder:function(k){this.range().leftColumn().borderLeft(k);
},rightBorder:function(k){this.range().rightColumn().borderRight(k);
},topBorder:function(k){this.range().topRow().borderTop(k);
},bottomBorder:function(k){this.range().bottomRow().borderBottom(k);
},outsideBorders:function(l){var k=this.range();
k.sheet().batch(function(){k.leftColumn().borderLeft(l);
k.topRow().borderTop(l);
k.rightColumn().borderRight(l);
k.bottomRow().borderBottom(l);
}.bind(this),{});
},insideBorders:function(k){this.range().sheet().batch(function(){this.allBorders(k);
this.outsideBorders(null);
}.bind(this),{});
},insideHorizontalBorders:function(l){var k=this.range();
k.sheet().batch(function(){k.borderBottom(l);
k.bottomRow().borderBottom(null);
}.bind(this),{});
},insideVerticalBorders:function(l){var k=this.range();
k.sheet().batch(function(){k.borderRight(l);
k.rightColumn().borderRight(null);
}.bind(this),{});
}});
g.spreadsheet.MergeCellCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._type=k.value;
},exec:function(){this.getState();
this[this._type]();
},activate:function(k){this.range().sheet().activeCell(k);
},getState:function(){this._state=this.range().getState();
},undo:function(){if(this._type!=="unmerge"){this.range().unmerge();
this.activate(this.range().topLeft());
}this.range().setState(this._state);
},cells:function(){var k=this.range();
var l=k._ref;
k.merge();
this.activate(l);
},horizontally:function(){var k=this.range().topRow()._ref;
this.range().forEachRow(function(l){l.merge();
});
this.activate(k);
},vertically:function(){var k=this.range().leftColumn()._ref;
this.range().forEachColumn(function(l){l.merge();
});
this.activate(k);
},unmerge:function(){var k=this.range();
var l=k._ref.topLeft;
k.unmerge();
this.activate(l);
}});
g.spreadsheet.FreezePanesCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._type=k.value;
},exec:function(){this.getState();
this._topLeft=this.range().topLeft();
this[this._type]();
},getState:function(){this._state=this.range().sheet().getState();
},undo:function(){this.range().sheet().setState(this._state);
},panes:function(){var l=this._topLeft;
var k=this.range().sheet();
k.frozenColumns(l.col).frozenRows(l.row);
},rows:function(){var l=this._topLeft;
var k=this.range().sheet();
k.frozenRows(l.row);
},columns:function(){var l=this._topLeft;
var k=this.range().sheet();
k.frozenColumns(l.col);
},unfreeze:function(){var k=this.range().sheet();
k.frozenRows(0).frozenColumns(0);
}});
g.spreadsheet.PasteCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._clipboard=this._workbook.clipboard();
},getState:function(){this._range=this._workbook.activeSheet().range(this._clipboard.pasteRef());
this._state=this._range.getState();
},exec:function(){var l=this._clipboard.canPaste();
this._clipboard.menuInvoked=true;
if(!l.canPaste){if(l.menuInvoked){return{reason:"error",type:"useKeyboard"};
}if(l.pasteOnMerged){return{reason:"error",type:"modifyMerged"};
}if(l.overflow){return{reason:"error",type:"overflow"};
}return{reason:"error"};
}this.getState();
this._clipboard.paste();
var k=this._workbook.activeSheet().range(this._clipboard.pasteRef());
k._adjustRowHeight();
}});
g.spreadsheet.AdjustRowHeightCommand=d.extend({exec:function(){var k=this.options;
var m=this._workbook.activeSheet();
var l=k.range||m.range(k.rowIndex);
l._adjustRowHeight();
}});
g.spreadsheet.ToolbarPasteCommand=d.extend({exec:function(){if(g.support.clipboard.paste){this._workbook._view.clipboard.focus().select();
document.execCommand("paste");
}else{return{reason:"error",type:"useKeyboard"};
}}});
g.spreadsheet.CopyCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._clipboard=k.workbook.clipboard();
},undo:a.noop,exec:function(){var k=this._clipboard.canCopy();
this._clipboard.menuInvoked=true;
if(!k.canCopy){if(k.menuInvoked){return{reason:"error",type:"useKeyboard"};
}else{if(k.multiSelection){return{reason:"error",type:"unsupportedSelection"};
}}return;
}this._clipboard.copy();
}});
function e(k){var l=document.createElement("textarea");
a(l).addClass("k-spreadsheet-clipboard").val(k).appendTo(document.body).focus().select();
document.execCommand("copy");
a(l).remove();
}g.spreadsheet.ToolbarCopyCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._clipboard=k.workbook.clipboard();
},undo:a.noop,exec:function(){if(g.support.clipboard.copy){var k=this._workbook._view.clipboard;
e(k.html());
k.trigger("copy");
}else{return{reason:"error",type:"useKeyboard"};
}}});
g.spreadsheet.CutCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._clipboard=k.workbook.clipboard();
},exec:function(){if(this.range().enable()&&this._clipboard.canCopy()){this.getState();
this._clipboard.cut();
}}});
g.spreadsheet.AutoFillCommand=d.extend({init:function(k){d.fn.init.call(this,k);
},origin:function(k){this._origin=k;
},exec:function(){this.getState();
try{this.range().fillFrom(this._origin);
}catch(k){if(k instanceof g.spreadsheet.Range.FillError){return{reason:"error",body:k+""};
}throw k;
}}});
g.spreadsheet.ToolbarCutCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._clipboard=k.workbook.clipboard();
},exec:function(){if(g.support.clipboard.copy){var k=this._workbook._view.clipboard;
e(k.html());
k.trigger("cut");
}else{return{reason:"error",type:"useKeyboard"};
}}});
g.spreadsheet.FilterCommand=d.extend({undo:function(){this.range().filter(this._state);
},exec:function(){var k=this.range();
this._state=k.hasFilter();
if(k.hasFilter()){k.filter(false);
}else{if(!k.intersectingMerged().length){k.filter(true);
}else{return{reason:"error",type:"filterRangeContainingMerges"};
}}}});
g.spreadsheet.SortCommand=d.extend({undo:function(){var k=this.range().sheet();
k.setState(this._state);
},exec:function(){var n=this.range();
var o=n.sheet();
var k=o.activeCell();
var m=this.options.sheet?k.topLeft.col:this.options.column||0;
var l=this.options.value==="asc"?true:false;
this._state=o.getState();
if(this.options.sheet){n=this.expandRange();
}if(!n.intersectingMerged().length){n.sort({column:m,ascending:l});
}else{return{reason:"error",type:"sortRangeContainingMerges"};
}},expandRange:function(){var k=this.range().sheet();
return new g.spreadsheet.Range(k._sheetRef,k);
}});
var c=g.spreadsheet.ApplyFilterCommand=d.extend({column:function(){return this.options.column||0;
},undo:function(){var k=this.range().sheet();
k.clearFilter(this.column());
if(this._state.length){this.range().filter(this._state);
}},getState:function(){var l=this.range().sheet();
var k=l.filter();
if(k){this._state=k.columns.filter(function(m){return m.index==this.column();
}.bind(this));
}},exec:function(){var p=this.range();
var k=this.column();
var l=p.sheet().filter();
var o;
var n;
var m=false;
if(this.options.valueFilter){n={column:k,filter:new g.spreadsheet.ValueFilter(this.options.valueFilter)};
}else{if(this.options.customFilter){n={column:k,filter:new g.spreadsheet.CustomFilter(this.options.customFilter)};
}}this.getState();
if(l&&l.ref.eq(p._ref)&&l.columns.length){l.columns.forEach(function(q){if(q.index===k){m=true;
}});
o=l.columns.map(function(q){return q.index===k?n:{column:q.index,filter:q.filter};
});
if(!m){o.push(n);
}}else{o=n;
}p.filter(o);
}});
g.spreadsheet.ClearFilterCommand=c.extend({exec:function(){var l=this.range();
var k=this.column();
this.getState();
l.clearFilter(k);
}});
g.spreadsheet.HideLineCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this.axis=k.axis;
},undo:function(){var k=this.range().sheet();
k.setAxisState(this._state);
},exec:function(){var k=this.range().sheet();
this._state=k.getAxisState();
if(this.axis=="row"){k.axisManager().hideSelectedRows();
}else{k.axisManager().hideSelectedColumns();
}}});
g.spreadsheet.UnHideLineCommand=g.spreadsheet.HideLineCommand.extend({exec:function(){var k=this.range().sheet();
this._state=k.getAxisState();
if(this.axis=="row"){k.axisManager().unhideSelectedRows();
}else{k.axisManager().unhideSelectedColumns();
}}});
var f=g.spreadsheet.DeleteCommand=d.extend({undo:function(){var k=this.range().sheet();
k.setState(this._state);
}});
g.spreadsheet.DeleteRowCommand=f.extend({exec:function(){var k=this.range().sheet();
this._state=k.getState();
k.axisManager().deleteSelectedRows();
}});
g.spreadsheet.DeleteColumnCommand=f.extend({exec:function(){var k=this.range().sheet();
this._state=k.getState();
k.axisManager().deleteSelectedColumns();
}});
var b=d.extend({init:function(k){d.fn.init.call(this,k);
this._value=k.value;
},undo:function(){var k=this.range().sheet();
k.setState(this._state);
}});
g.spreadsheet.AddColumnCommand=b.extend({exec:function(){var k=this.range().sheet();
this._state=k.getState();
if(this._value==="left"){k.axisManager().addColumnLeft();
}else{k.axisManager().addColumnRight();
}}});
g.spreadsheet.AddRowCommand=b.extend({exec:function(){var k=this.range().sheet();
if(!k.axisManager().canAddRow()){return{reason:"error",type:"shiftingNonblankCells"};
}this._state=k.getState();
if(this._value==="above"){k.axisManager().addRowAbove();
}else{k.axisManager().addRowBelow();
}}});
g.spreadsheet.EditValidationCommand=d.extend({init:function(k){d.fn.init.call(this,k);
this._value=k.value;
},exec:function(){this.range().validation(this._value);
}});
g.spreadsheet.OpenCommand=d.extend({cannotUndo:true,exec:function(){var k=this.options.file;
if(k.name.match(/.xlsx$/i)===null){return{reason:"error",type:"openUnsupported"};
}this.options.workbook.fromFile(this.options.file);
}});
g.spreadsheet.SaveAsCommand=d.extend({exec:function(){var k=this.options.name+this.options.extension;
if(this.options.extension===".xlsx"){this.options.workbook.saveAsExcel({fileName:k});
}else{if(this.options.extension===".pdf"){this.options.workbook.saveAsPDF(a.extend(this.options.pdf,{workbook:this.options.workbook,fileName:k}));
}}}});
var h=d.extend({init:function(k){d.fn.init.call(this,k);
this._name=k.name;
this._value=k.value;
},getState:function(){this._state=this._workbook.nameDefinition(this._name);
},setState:function(){this._workbook.nameDefinition(this._name,this._state);
this._workbook.trigger("change",{recalc:true});
}});
g.spreadsheet.DefineNameCommand=h.extend({exec:function(){this.getState();
try{this._workbook.defineName(this._name,this._value);
this._workbook.trigger("change",{recalc:true});
}catch(k){return{title:"Error",body:k+"",reason:"error"};
}}});
g.spreadsheet.DeleteNameCommand=h.extend({exec:function(){this.getState();
this._workbook.undefineName(this._name);
this._workbook.trigger("change",{recalc:true});
}});
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/formulabar",["kendo.core"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var b={wrapper:"k-spreadsheet-formula-bar"};
var c=d.ui.Widget.extend({init:function(e,f){d.ui.Widget.call(this,e,f);
e=this.element.addClass(c.classNames.wrapper);
this.formulaInput=new d.spreadsheet.FormulaInput(a("<div/>").appendTo(e));
},destroy:function(){if(this.formulaInput){this.formulaInput.destroy();
}this.formulaInput=null;
}});
d.spreadsheet.FormulaBar=c;
a.extend(true,c,{classNames:b});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/formulainput",["kendo.core"],b);
}(function(){(function(h,q){if(h.support.browser.msie&&h.support.browser.version<9){return;
}var a=h.jQuery;
var p=h.ui.Widget;
var l=".kendoFormulaInput";
var j=h.keys;
var b={wrapper:"k-spreadsheet-formula-input",listWrapper:"k-spreadsheet-formula-list"};
var n=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"];
var i={27:"esc",37:"left",39:"right",35:"end",36:"home",32:"spacebar"};
var m=/(^_|[^a-z0-9]$)/i;
var c=p.extend({init:function(r,s){p.call(this,r,s);
r=this.element;
r.addClass(c.classNames.wrapper).attr("contenteditable",true).attr("spellcheck",false).css("white-space","pre");
if(this.options.autoScale){r.on("input",this.scale.bind(this));
}this._highlightedRefs=[];
this._staticTokens=[];
this._formulaSource();
this._formulaList();
this._popup();
this._tooltip();
r.on("keydown",this._keydown.bind(this)).on("keyup",this._keyup.bind(this)).on("blur",this._blur.bind(this)).on("input click",this._input.bind(this)).on("focus",this._focus.bind(this)).on("paste",this._paste.bind(this));
},options:{name:"FormulaInput",autoScale:false,filterOperator:"startswith",scalePadding:30,minLength:1},events:["keyup","focus"],enable:function(r){if(r===undefined){return this.element.attr("contenteditable")==="true";
}this.enableEditing(r);
this.element.toggleClass("k-state-disabled",!r);
},enableEditing:function(r){if(r){this.element.attr("contenteditable",r);
}else{this.element.removeAttr("contenteditable");
}},getPos:function(){var t=this.element[0];
var v=q.getSelection();
var r=u(v.focusNode,v.focusOffset);
var s=u(v.anchorNode,v.anchorOffset);
if(r!=null&&s!=null){if(r>s){var w=r;
r=s;
s=w;
}return{begin:r,end:s,collapsed:r==s};
}function u(y,A){try{(function z(C){if(C===y){throw A;
}else{if(C.nodeType==1){for(var B=C.firstChild;
B;
B=B.nextSibling){z(B);
}}else{if(C.nodeType==3){A+=C.nodeValue.length;
}}}}(t));
}catch(x){return x;
}}},setPos:function(r,v){var u=this.element[0];
r=w(u,r);
if(v!=null){v=w(u,v);
}else{v=r;
}if(r&&v){var x=document.createRange();
x.setStart(r.node,r.pos);
x.setEnd(v.node,v.pos);
var y=q.getSelection();
var s=y.getRangeAt(0);
if(t(x,s)){y.removeAllRanges();
y.addRange(x);
}}function t(z,A){return z.startOffset!=A.startOffset||z.endOffset!=A.endOffset||z.startContainer!=A.endContainer||z.endContainer!=A.endContainer;
}function w(B,C){try{(function A(F){if(F.nodeType==3){var E=F.nodeValue.length;
if(E>=C){throw F;
}C-=E;
}else{if(F.nodeType==1){for(var D=F.firstChild;
D;
D=D.nextSibling){A(D);
}}}}(B));
}catch(z){return{node:z,pos:C};
}}},end:function(){this.setPos(this.length());
},home:function(){this.setPos(0);
},length:function(){return this.value().length;
},_formulaSource:function(){var s=[];
var t;
for(var r in h.spreadsheet.calc.runtime.FUNCS){if(!m.test(r)){t=r.toUpperCase();
s.push({value:t,text:t});
}}this.formulaSource=new h.data.DataSource({data:s});
},_formulaList:function(){this.list=new h.ui.StaticList(a("<ul />").addClass(c.classNames.listWrapper).insertAfter(this.element),{autoBind:false,selectable:true,change:this._formulaListChange.bind(this),dataSource:this.formulaSource,dataValueField:"value",template:"#:data.value#"});
this.list.element.on("mousedown",function(r){r.preventDefault();
});
},_formulaListChange:function(){var u=this._tokenContext();
if(!u||this._mute){return;
}var r=u.token;
var s=this.list.value()[0];
var t={replace:true,token:r,end:r.end};
if(!u.nextToken||u.nextToken.value!="("){s+="(";
}this._replaceAt(t,s);
this.popup.close();
},_popup:function(){this.popup=new h.ui.Popup(this.list.element,{anchor:this.element});
},_blur:function(){this.popup.close();
clearTimeout(this._focusId);
this.trigger("blur");
},_isFormula:function(){return/^=/.test(this.value());
},_keydown:function(r){var s=r.keyCode;
if(i[s]){this.popup.close();
this._navigated=true;
}else{if(this._move(s)){this._navigated=true;
r.preventDefault();
}}this._keyDownTimeout=setTimeout(this._syntaxHighlight.bind(this));
},_keyup:function(){var r=this.popup;
var s;
if(this._isFormula()&&!this._navigated){s=((this._tokenContext()||{}).token||{}).value;
this.filter(s);
if(!s||!this.formulaSource.view().length){r.close();
}else{r[r.visible()?"position":"open"]();
this.list.focusFirst();
}}this._navigated=false;
this._syntaxHighlight();
this.trigger("keyup");
},_input:function(){this._syntaxHighlight();
},_focus:function(){this._focusTimeout=setTimeout(this._syntaxHighlight.bind(this));
this.trigger("focus");
},_paste:function(s){s.preventDefault();
var t=this.getPos();
var r=s.originalEvent.clipboardData;
var u=r.getData("text/plain");
var v=this.value();
v=v.substr(0,t.begin)+u+v.substr(t.end);
this.value(v);
this.setPos(t.begin+u.length);
this.scale();
},_move:function(r){var s=this.list;
var u=false;
var t=this.popup;
if(r===j.DOWN){s.focusNext();
if(!s.focus()){s.focusFirst();
}u=true;
}else{if(r===j.UP){s.focusPrev();
if(!s.focus()){s.focusLast();
}u=true;
}else{if(r===j.ENTER){if(t.visible()){s.select(s.focus());
}t.close();
u=true;
}else{if(r===j.TAB){s.select(s.focus());
t.close();
u=true;
}else{if(r===j.PAGEUP){s.focusFirst();
u=true;
}else{if(r===j.PAGEDOWN){s.focusLast();
u=true;
}}}}}}return u;
},_tokenContext:function(){var s=this.getPos();
var v=this.value();
if(!v||!s||!s.collapsed){return null;
}var u=h.spreadsheet.calc.tokenize(v,this.row(),this.col());
var t;
for(var r=0;
r<u.length;
++r){t=u[r];
if(o(t,s)&&/^(?:str|sym|func)$/.test(t.type)){return{token:t,nextToken:u[r+1]};
}}return null;
},_sync:function(){if(this._editorToSync&&this.isActive()){this._editorToSync.value(this.value());
}},_textContainer:function(){var r=h.getComputedStyles(this.element[0],n);
r.position="absolute";
r.visibility="hidden";
r.whiteSpace="pre";
r.top=-3333;
r.left=-3333;
this._span=a("<span style='white-space: pre'/>").css(r).insertAfter(this.element);
},_tooltip:function(){this._cellTooltip=a('<div class="k-widget k-tooltip" style="position:absolute; display:none">A1</div>').insertAfter(this.element);
},tooltip:function(r){this._cellTooltip.text(r);
},toggleTooltip:function(r){this._cellTooltip.toggle(r);
},isActive:function(){return this.element[0]===h._activeElement();
},filter:function(r){if(!r||r.length<this.options.minLength){return;
}this._mute=true;
this.list.select(-1);
this._mute=false;
this.formulaSource.filter({field:this.list.options.dataValueField,operator:this.options.filterOperator,value:r});
},hide:function(){this.enableEditing(false);
this.element.hide();
this._cellTooltip.hide();
},show:function(){this.enableEditing(true);
this.element.show();
},row:function(){if(this.activeCell){return this.activeCell.row;
}},col:function(){if(this.activeCell){return this.activeCell.col;
}},position:function(r){if(!r){return;
}this.show();
this.element.css({top:r.top+1+"px",left:r.left+1+"px"});
this._cellTooltip.css({top:r.top-this._cellTooltip.height()-10+"px",left:r.left});
},resize:function(r){if(!r){return;
}this.element.css({width:r.width-1,height:r.height-1});
},canInsertRef:function(s){var t=this._canInsertRef(s);
var u=t&&t.token;
var r;
if(u){for(r=0;
r<this._staticTokens.length;
r++){if(e(u,this._staticTokens[r])){return null;
}}}return t;
},_canInsertRef:function(v){if(this.popup.visible()){return null;
}var x=v;
var w=this.getPos();
var z,y;
if(w&&this._isFormula()){if(w.begin===0){return null;
}z=h.spreadsheet.calc.tokenize(this.value(),this.row(),this.col());
for(var u=0;
u<z.length;
++u){y=z[u];
if(o(y,w)){return t(y);
}if(r(y)){return s(z[u-1],y);
}}return s(y,null);
}return null;
function r(A){return A.begin>w.begin;
}function t(A){if(A){if(/^(?:num|str|bool|sym|ref)$/.test(A.type)){return{replace:true,token:A,end:A.end};
}if(/^(?:op|punc|startexp)$/.test(A.type)){if(A.end==w.end){return s(A,z[u+1]);
}return s(z[u-1],A);
}}}function s(A,B){if(A==null){return null;
}if(B==null){if(/^(?:op|startexp)$/.test(A.type)||g(A.value)){return{token:A,end:w.end};
}return null;
}if(x){if(A.type=="op"&&/^(?:punc|op)$/.test(B.type)){return{token:A,end:w.end};
}}else{if(A.type=="startexp"){return{token:A,end:w.end};
}if(/^(?:ref|op|punc)$/.test(A.type)){return{token:A,end:w.end};
}if(/^(?:punc|op)$/.test(A.type)){return/^[,;({]$/.test(A.value)?{token:A,end:w.end}:null;
}}return false;
}},refAtPoint:function(r){var s=this._canInsertRef();
if(s){this._replaceAt(s,r.simplify().toString());
}},_replaceAt:function(r,s){var w=this.value();
var v=r.token;
var u=w.substr(r.end);
w=w.substr(0,r.replace?v.begin:r.end)+s;
var t=w.length;
w+=u;
this._value(w);
this.setPos(t);
this.scale();
this._syntaxHighlight();
this._sync();
},syncWith:function(s){var v=this;
var r="input"+l;
var t=v._sync.bind(v),u;
if(h.support.browser.msie){r="keydown"+l;
u=function(){setTimeout(t);
};
}v._editorToSync=s;
v.element.off(r).on(r,u||t);
},scale:function(){var r=this.element;
var t,s;
if(!this._span){this._textContainer();
}this._span.html(r.html());
t=this._span.width()+this.options.scalePadding;
s=this._span.height();
if(t>r.width()){r.width(t);
}if(s>r.height()){r.height(s);
}},_value:function(r){this.element.text(r);
},value:function(s){if(s===undefined){var r=this.element[0].innerText;
if(h.support.browser.mozilla){r=r.replace(/\n$/,"");
}return r;
}this._value(s);
this._syntaxHighlight();
},highlightedRefs:function(){return this._highlightedRefs.slice();
},_syntaxHighlight:function(){var u=this.getPos();
var y=this.value();
var v=h.spreadsheet.Pane.classNames.series;
var s=[];
var w=0;
var t=[];
var x=[];
var r;
if(u&&!u.collapsed){return;
}if(!/^=/.test(y)){if(this._staticTokens.length||this._highlightedRefs.length){this._staticTokens=[];
this._highlightedRefs=[];
this.element.text(y);
}if(this.popup){this.popup.close();
}return;
}else{x=h.spreadsheet.calc.tokenize(y,this.row(),this.col());
x.forEach(function(A){A.active=false;
A.cls=["k-syntax-"+A.type];
if(A.type=="ref"){A.colorClass=v[w++%v.length];
A.cls.push(A.colorClass);
s.push(A);
}if(u&&A.type=="punc"){if(g(A.value)){t.unshift(A);
}else{if(d(A.value)){var z=t.shift();
if(z){if(f(A.value,z.value)){if(o(A,u)||o(z,u)){A.cls.push("k-syntax-paren-match");
z.cls.push("k-syntax-paren-match");
}}else{A.cls.push("k-syntax-error");
z.cls.push("k-syntax-error");
}}else{A.cls.push("k-syntax-error");
}}}}if(u&&o(A,u)){A.cls.push("k-syntax-at-point");
A.active=true;
r=A;
}if(A.type=="func"&&!k(A.value)&&(!u||!o(A,u))){A.cls.push("k-syntax-error");
}});
x.reverse().forEach(function(C){var z=C.begin,A=C.end;
var B=h.htmlEncode(y.substring(z,A));
y=y.substr(0,z)+"<span class='"+C.cls.join(" ")+"'>"+B+"</span>"+y.substr(A);
});
this.element.html(y);
}if(u){this.setPos(u.begin,u.end);
}if(r&&/^(?:startexp|op|punc)$/.test(r.type)){this._setStaticTokens(x);
}this._highlightedRefs=s;
},_setStaticTokens:function(t){var r,s;
this._staticTokens=[];
for(r=0;
r<t.length;
r++){s=t[r];
if(/^(?:num|str|bool|sym|ref)$/.test(s.type)){this._staticTokens.push(s);
}}},destroy:function(){this._editorToSync=null;
this.element.off(l);
clearTimeout(this._focusTimeout);
clearTimeout(this._keyDownTimeout);
this._cellTooltip=null;
this._span=null;
this.popup.destroy();
this.popup=null;
p.fn.destroy.call(this);
},insertNewline:function(){var t=this.value();
var s=this.getPos();
var r=s.end==t.length;
t=t.substr(0,s.begin)+(r?"\n\n":"\n"+t.substr(s.end));
this.value(t);
this.setPos(s.begin+1);
}});
function g(r){return r=="("||r=="["||r=="{";
}function d(r){return r==")"||r=="]"||r=="}";
}function f(r,s){return s=="("?r==")":s=="["?r=="]":s=="{"?r=="}":false;
}function o(r,s){return r.begin<=s.begin&&r.end>=s.end;
}function k(r){return h.spreadsheet.calc.runtime.FUNCS[r.toLowerCase()];
}function e(r,s){if(!r||!s){return false;
}if(r.type=="ref"&&s.type=="ref"){return r.ref.eq(s.ref);
}else{return r.value===s.value;
}}h.spreadsheet.FormulaInput=c;
a.extend(true,c,{classNames:b});
}(kendo,window));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/eventlistener",["kendo.core"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var e={8:"backspace",9:"tab",13:"enter",27:"esc",37:"left",38:"up",39:"right",40:"down",35:"end",36:"home",32:"spacebar",33:"pageup",34:"pagedown",46:"delete",113:":edit"};
var g=navigator.platform.toUpperCase().indexOf("MAC")>=0;
var c=function(h){if(h>47&&h<58||h>64&&h<91||h>95&&h<112||h>185&&h<193||h>218&&h<223){return true;
}return false;
};
var f=function(h){var i=e[h];
if(!i&&c(h)){i=":alphanum";
}return i;
};
var b=d.Class.extend({init:function(k,j,h){this._handlers={};
this.target=k;
this._observer=j||window;
this.keyDownProxy=this.keyDown.bind(this);
this.mouseProxy=this.mouse.bind(this);
this.threshold=5;
this._pressLocation=null;
k.on("keydown",this.keyDownProxy);
k.on("contextmenu mousedown cut copy paste scroll wheel click dblclick focus",this.mouseProxy);
a(document.documentElement).on("mousemove mouseup",this.mouseProxy);
if(h){for(var i in h){this.on(i,h[i]);
}}},keyDown:function(h){this.handleEvent(h,f(h.keyCode));
},mouse:function(k){var l;
if(k.which){l=k.which==3;
}else{if(k.button){l=k.button==2;
}}var m=k.type;
if(m==="mousedown"){if(l){m="rightmousedown";
}else{this._pressLocation={x:k.pageX,y:k.pageY};
}}if(m==="mouseup"){if(!l){this._pressLocation=null;
}}if(m==="mousemove"&&this._pressLocation){var i=this._pressLocation.x-k.pageX;
var j=this._pressLocation.y-k.pageY;
var h=Math.sqrt(i*i+j*j);
if(h>this.threshold){m="mousedrag";
}}this.handleEvent(k,m);
},handleEvent:function(i,l){var j="";
i.mod=g?i.metaKey:i.ctrlKey&&!i.altKey;
if(i.altKey){j+="alt+";
}if(i.shiftKey){j+="shift+";
}if(i.ctrlKey){j+="ctrl+";
}j+=l;
var h=this._handlers["*+"+l];
if(h){h.call(this._observer,i,j);
}var k=this._handlers[j];
if(k){k.call(this._observer,i,j);
}},on:function(i,h){var j=this._handlers;
if(typeof h==="string"){h=this._observer[h];
}if(typeof i==="string"){i=i.split(",");
}i.forEach(function(k){j[k]=h;
});
},destroy:function(){this.target.off("keydown",this.keyDownProxy);
this.target.off("keydown",this.mouseProxy);
a(document.documentElement).off("mousemove mouseup",this.mouseProxy);
}});
d.spreadsheet.EventListener=b;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/rangelist",["kendo.core"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var m=d.Class.extend({init:function h(u,w,t,v){this.level=u;
this.value=w;
this.left=t;
this.right=v;
}});
var g=new function f(){this.left=this;
this.right=this;
this.level=0;
}();
function i(t){return t;
}function o(t){if(t.left.level===t.level){var u=t;
t=t.left;
u.left=t.right;
t.right=u;
}return t;
}function q(t){if(t.right.right.level===t.level){var u=t;
t=t.right;
u.right=t.left;
t.left=u;
t.level+=1;
}return t;
}function a(t,u){if(t===g){return new m(1,u,g,g);
}else{if(t.value.start-u.start>0){t.left=a(t.left,u);
}else{t.right=a(t.right,u);
}}return q(o(t));
}function n(v,w){if(v===g){return v;
}var t=v.value.start-w.start;
if(t===0){if(v.left!==g&&v.right!==g){var u=v.left;
while(u.right!==g){u=u.right;
}v.value=u.value;
v.left=n(v.left,v.value);
}else{if(v.left===g){v=v.right;
}else{v=v.left;
}}}else{if(t>0){v.left=n(v.left,w);
}else{v.right=n(v.right,w);
}}if(v.left.level<v.level-1||v.right.level<v.level-1){v.level-=1;
if(v.right.level>v.level){v.right.level=v.level;
}v=o(v);
v.right=o(v.right);
v.right.right=o(v.right.right);
v=q(v);
v.right=q(v.right);
}return v;
}var j=d.Class.extend({init:function r(u,t,v){this.start=u;
this.end=t;
this.value=v;
},intersects:function(t){return t.start<=this.end&&t.end>=this.start;
}});
var l=d.Class.extend({init:function(){this.root=g;
},insert:function(t){this.root=a(this.root,t);
},remove:function(t){this.root=n(this.root,t);
},findrange:function(u){var t=this.root;
while(t!=g){if(u<t.value.start){t=t.left;
}else{if(u>t.value.end){t=t.right;
}else{return t.value;
}}}return null;
},values:function(){var t=[];
s(this.root,t);
return t;
},intersecting:function(v,t){var u=[];
b(this.root,new j(v,t),u);
return u;
},map:function(t){var u=new l();
e(u,this.root,t);
return u;
},clone:function(){return this.map(i);
},first:function(){var t=this.root;
while(t.left!=g){t=t.left;
}return t;
},last:function(){var t=this.root;
while(t.right!=g){t=t.right;
}return t;
}});
function s(t,u){if(t===g){return;
}s(t.left,u);
u.push(t.value);
s(t.right,u);
}function b(t,u,v){if(t===g){return;
}var w=t.value;
if(u.start<w.start){b(t.left,u,v);
}if(w.intersects(u)){v.push(w);
}if(u.end>w.end){b(t.right,u,v);
}}function e(v,u,t){if(u===g){return;
}e(v,u.left,t);
v.insert(t(u.value));
e(v,u.right,t);
}var k=d.Class.extend({init:function(u,t,v){if(t===undefined){this.tree=u;
}else{this.tree=new l();
this.tree.insert(new j(u,t,v));
}},values:function(){return this.tree.values();
},map:function(t){return new k(this.tree.map(t));
},intersecting:function(u,t){return this.tree.intersecting(u,t);
},first:function(){return this.tree.first().value;
},last:function(){return this.tree.last().value;
},insert:function(u,t,v){return this.tree.insert(new j(u,t,v));
},value:function(D,t,E){if(E===undefined){if(t===undefined){t=D;
}return this.intersecting(D,t)[0].value;
}var A=this.tree.intersecting(D-1,t+1);
if(A.length){var u=A[0],w=A[A.length-1];
if(u.end<D){if(u.value===E){D=u.start;
}else{A.shift();
}}if(w.start>t){if(w.value===E){t=w.end;
}else{A.pop();
}}for(var v=0,x=A.length;
v<x;
v++){var y=A[v];
var C=y.value;
var B=y.start;
var z=y.end;
this.tree.remove(y);
if(B<D){if(C!==E){this.insert(B,D-1,C);
}else{D=B;
}}if(z>t){if(C!==E){this.insert(t+1,z,C);
}else{t=z;
}}}}this.insert(D,t,E);
},expandedValues:function(y,t){var w=this.intersecting(y,t);
var x=[];
var v=0;
for(var u=y;
u<=t;
u++){if(w[v].end<u){v++;
}x.push({index:u-y,value:w[v].value});
}return x;
},sortedIndices:function(x,u,y,v){var w=this.expandedValues(x,u);
var t=function(z,A){if(z.value===A.value){return z.index-A.index;
}return y(z.value,A.value);
};
if(v){t=function(z,A){var B=v[z.index];
var C=v[A.index];
if(B.value===C.value){return y(z.value,A.value);
}return z.index-A.index;
};
}w.sort(t);
return w;
},sort:function(x,t,v){if(this.intersecting(x,t).length===1){return;
}var y=this.expandedValues(x,t);
for(var u=0,w=v.length;
u<w;
u++){this.value(u+x,u+x,y[v[u].index].value);
}},copy:function(z,y,B){var C=this.intersecting(z,y);
var A=B;
var t;
for(var u=0,v=C.length;
u<v;
u++){var x=C[u].start;
if(x<z){x=z;
}var w=C[u].end;
if(w>y){w=y;
}t=A+(w-x);
this.value(A,t,C[u].value);
A=++t;
}},iterator:function(u,t){return new c(u,t,this.intersecting(u,t));
},getState:function(){return this.tree.clone();
},setState:function(t){this.tree=t;
}});
var c=d.Class.extend({init:function(v,t,u){this.start=v;
this.end=t;
this.index=0;
this.ranges=u;
},unique:function(){return this.ranges.map(function(t){return t.value;
});
},at:function(t){while(this.ranges[this.index].end<t){this.index++;
}return this.ranges[this.index].value;
},forEach:function(t){for(var u=this.start;
u<=this.end;
u++){t(this.at(u),u);
}this.index=0;
}});
var p=k.extend({init:function(u,t,v){this.tree=new l();
this.range=new j(u,t,v);
},intersecting:function(z,t){var x=this.tree.intersecting(z,t);
var y=[];
var w;
if(!x.length){return[this.range];
}for(var u=0,v=x.length;
u<v;
u++){w=x[u];
if(w.start>z){y.push(new j(z,w.start-1,this.range.value));
}y.push(w);
z=w.end+1;
}if(w.end<t){y.push(new j(w.end+1,t,this.range.value));
}return y;
},insert:function(u,t,v){if(v!==this.range.value){this.tree.insert(new j(u,t,v));
}},lastRangeStart:function(){var t=this.tree.root;
if(t===g){return this.range.start;
}while(t.right!==g){t=t.right;
}return t.value.end+1;
}});
d.spreadsheet.RangeTree=l;
d.spreadsheet.RangeList=k;
d.spreadsheet.SparseRangeList=p;
d.spreadsheet.ValueRange=j;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/propertybag",["kendo.core"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var a=c.jQuery;
var d=c.Class.extend({init:function(g){this.list=g;
},get:function(g){return this.parse(this.list.value(g,g));
},set:function(h,g,i){if(i===undefined){i=g;
g=h;
}this.list.value(h,g,i);
},parse:function(g){return g;
},copy:function(i,h,g){this.list.copy(i,h,g);
},iterator:function(h,g){return this.list.iterator(h,g);
}});
var b=d.extend({set:function(h,g,i){this.list.value(h,g,JSON.stringify(i));
},parse:function(g){return JSON.parse(g);
}});
var f=d.extend({init:function(i,g,h){d.prototype.init.call(this,i);
this.validations=h;
this.formats=g;
},set:function(h,g,i){if(i instanceof Date){i=c.spreadsheet.dateToNumber(i);
this.formats.value(h,g,e(c.culture().calendar.patterns.d));
}this.list.value(h,g,i);
}});
function e(g){return g.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}c.spreadsheet.PropertyBag=c.Class.extend({specs:[{property:f,name:"value",value:null,sortable:true,serializable:true,depends:"format"},{property:d,name:"format",value:null,sortable:true,serializable:true},{property:d,name:"formula",value:null,sortable:true,serializable:true},{property:d,name:"background",value:null,sortable:true,serializable:true},{property:b,name:"borderBottom",value:null,sortable:false,serializable:true},{property:b,name:"borderRight",value:null,sortable:false,serializable:true},{property:b,name:"borderLeft",value:null,sortable:false,serializable:true},{property:b,name:"borderTop",value:null,sortable:false,serializable:true},{property:d,name:"color",value:null,sortable:true,serializable:true},{property:d,name:"fontFamily",value:null,sortable:true,serializable:true},{property:d,name:"underline",value:null,sortable:true,serializable:true},{property:d,name:"fontSize",value:null,sortable:true,serializable:true},{property:d,name:"italic",value:null,sortable:true,serializable:true},{property:d,name:"bold",value:null,sortable:true,serializable:true},{property:d,name:"textAlign",value:null,sortable:true,serializable:true},{property:d,name:"verticalAlign",value:null,sortable:true,serializable:true},{property:d,name:"wrap",value:null,sortable:true,serializable:true},{property:d,name:"validation",value:null,sortable:false,serializable:true},{property:d,name:"enable",value:null,sortable:false,serializable:true},{property:d,name:"link",value:null,sortable:false,serializable:true},{property:d,name:"editor",value:null,sortable:false,serializable:true}],init:function(g){this.properties={};
this.lists={};
this.specs.forEach(function(h){this.lists[h.name]=new c.spreadsheet.SparseRangeList(0,g,h.value);
},this);
this.specs.forEach(function(h){this.properties[h.name]=new h.property(this.lists[h.name],this.lists[h.depends]);
},this);
},getState:function(){var g={};
this.specs.forEach(function(h){g[h.name]=this.lists[h.name].getState();
},this);
return g;
},setState:function(g){this.specs.forEach(function(h){this.lists[h.name].setState(g[h.name]);
},this);
},get:function(h,g){if(g===undefined){return this.lists[h];
}return this.properties[h].get(g);
},set:function(h,i,g,j){this.properties[h].set(i,g,j);
},fromJSON:function(g,j){for(var h=0;
h<this.specs.length;
h++){var i=this.specs[h];
if(i.serializable){if(j[i.name]!==undefined){this.set(i.name,g,g,j[i.name],false);
}}}},copy:function(h,g,i){this.specs.forEach(function(j){this.properties[j.name].copy(h,g,i);
},this);
},iterator:function(h,i,g){return this.properties[h].iterator(i,g);
},sortable:function(){return this.specs.filter(function(g){return g.sortable;
}).map(function(g){return this.lists[g.name];
},this);
},iterators:function(i,g){var h=this.specs.filter(function(j){return j.serializable;
});
return h.map(function(k){var j=this.iterator(k.name,i,g);
return{name:k.name,value:k.value,at:function(l){return k.property.fn.parse(j.at(l));
}};
},this);
},forEach:function(n,h,g){var m=this.iterators(n,h);
for(var k=n;
k<=h;
k++){var p={};
for(var j=0;
j<m.length;
j++){var l=m[j];
var o=l.at(k);
if(o!==l.value){p[l.name]=o;
}}g(p);
}},forEachProperty:function(g){for(var h in this.properties){g(this.properties[h]);
}}});
c.spreadsheet.ALL_PROPERTIES=a.map(c.spreadsheet.PropertyBag.prototype.specs,function(g){return g.name;
});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/references",["kendo.core"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var k=kendo.spreadsheet;
var b=kendo.Class;
function c(m){var n=Math.floor(m/26)-1;
return(n>=0?c(n):"")+String.fromCharCode(65+m%26);
}function e(m){if(/^[a-z0-9_]*$/i.test(m)){return m;
}return"'"+m.replace(/\x27/g,"\\'")+"'";
}function d(q,p,n,o){var m="";
++p;
if(!isFinite(p)){p="";
}else{if(o!=null&&!(o&2)){p="$"+p;
}}if(!isFinite(n)){n="";
}else{m=c(n);
if(o!=null&&!(o&1)){m="$"+m;
}}if(q){return e(q)+"!"+m+p;
}else{return m+p;
}}var j=b.extend({type:"ref",sheet:"",clone:function(){return this;
},hasSheet:function(){return this._hasSheet;
},simplify:function(){return this;
},setSheet:function(n,m){this.sheet=n;
if(m!=null){this._hasSheet=m;
}return this;
},absolute:function(){return this;
},relative:function(){return this;
},adjust:function(){return this;
},toString:function(){return this.relative(0,0,3,3).print(0,0);
},forEach:function(m,n){m.call(n,this);
},map:function(m,n){return m.call(n,this);
},intersects:function(m){return this.intersect(m)!==g;
},isCell:function(){return false;
},toRow:function(){return this;
},toColumn:function(){return this;
},first:function(){return this;
},lastRange:function(){return this;
},size:function(){return 1;
},rangeAt:function(){return this;
},nextRangeIndex:function(){return 0;
},previousRangeIndex:function(){return 0;
},eq:function(q){var o=this;
var p=q;
if(o===g||p===g){return o===p;
}if(p instanceof a||p instanceof i&&!(o instanceof a)){o=q;
p=this;
}if(o instanceof a){p=p.simplify();
return p instanceof a&&o.row==p.row&&o.col==p.col&&o.sheet==p.sheet;
}else{if(o instanceof i){if(p instanceof i){return p.topLeft.eq(o.topLeft)&&p.bottomRight.eq(o.bottomRight);
}if(p instanceof l){return p.single()&&o.eq(p.refs[0]);
}}else{if(o instanceof l&&p instanceof l){var r=o.refs;
var s=p.refs;
if(r.length!=s.length){return false;
}for(var m=0,n=r.length;
m<n;
m++){if(!r[m].eq(s[m])){return false;
}}return true;
}}}return o===p;
},concat:function(m){return new l([this,m]);
},replaceAt:function(m,n){return n;
},forEachColumnIndex:function(m){this.forEachAxisIndex("col",m);
},forEachRowIndex:function(m){this.forEachAxisIndex("row",m);
},forEachAxisIndex:function(m,n){var p=[];
var o=m==="row"?"forEachRow":"forEachColumn";
this[o](function(r){var q=r.first()[m];
if(p.indexOf(q)===-1){p.push(q);
}});
p.sort(function(q,r){return q>r?1:q<r?-1:0;
}).forEach(n);
},valid:function(){return false;
},renameSheet:function(n,m){if(this.sheet&&this.sheet.toLowerCase()==n.toLowerCase()){this.sheet=m;
return true;
}}});
j.display=d;
var g=new (j.extend({init:function h(){},print:function(){return"#NULL!";
},eq:function(m){return m===this;
},forEach:function(){}}))();
var f=j.extend({ref:"name",init:function f(m){this.name=m;
},clone:function(){return new f(this.name).setSheet(this.sheet,this.hasSheet());
},print:function(){var m=e(this.name);
if(this.hasSheet()){m=e(this.sheet)+"!"+m;
}return m;
}});
var a=j.extend({ref:"cell",init:function a(o,m,n){this.row=o;
this.col=m;
this.rel=n||0;
},clone:function(){return new a(this.row,this.col,this.rel).setSheet(this.sheet,this.hasSheet());
},intersect:function(m){if(m instanceof a){if(this.eq(m)){return this;
}else{return g;
}}return m.intersect(this);
},print:function(t,s,o){var n=this.col,q=this.row,p=this.rel,m;
if(t==null&&p){var r=this.hasSheet()?e(this.sheet)+"!":"";
if(isFinite(n)){n=p&1?"C["+n+"]":"C"+(n+1);
}else{n="";
}if(isFinite(q)){q=p&2?"R["+q+"]":"R"+(q+1);
}else{q="";
}return r+q+n;
}else{m=this.absolute(t,s);
if(o){q=m.row%1048576;
n=m.col%16384;
if(q<0){q+=1048576;
}if(n<0){n+=16384;
}return d(this._hasSheet&&this.sheet,q,n,p);
}return m.valid()?d(this._hasSheet&&this.sheet,m.row,m.col,p):"#REF!";
}},absolute:function(n,m){var o=this.clone();
if(o.rel&3===0){return o;
}if(o.rel&1){o.col=(o.col+m)%16384;
}if(o.rel&2){o.row=(o.row+n)%1048576;
}o.rel=0;
return o;
},toRangeRef:function(){return new i(this,this);
},relative:function(n,m,p){if(p==null){p=this.rel;
}var q=p&2?this.row-n:this.row;
var o=p&1?this.col-m:this.col;
return new a(q,o,p).setSheet(this.sheet,this.hasSheet());
},height:function(){return 1;
},width:function(){return 1;
},toString:function(){return d(null,this.row,this.col,3);
},isCell:function(){return true;
},leftColumn:function(){return this;
},rightColumn:function(){return this;
},topRow:function(){return this;
},bottomRow:function(){return this;
},forEachRow:function(m){m(this.toRangeRef());
},forEachColumn:function(m){m(this.toRangeRef());
},adjust:function(q,m,t,s,o,r,n){var p=this.absolute(q,m);
if(o){if(p.row>=r){if(n<0&&p.row<r-n){return g;
}p.row+=n;
}}else{if(p.col>=r){if(n<0&&p.col<r-n){return g;
}p.col+=n;
}}if(t!=null&&s!=null){p=p.relative(t,s,this.rel);
}return p;
},valid:function(){if(this.rel){throw new Error("valid() called on relative reference");
}var m=this.col,n=this.row;
return !(isFinite(m)&&m<0||isFinite(n)&&n<0);
}});
var i=j.extend({ref:"range",init:function i(n,m){if(n._hasSheet&&m._hasSheet&&n.sheet.toLowerCase()!=m.sheet.toLowerCase()){this.endSheet=m.sheet;
}this.topLeft=new a(n.row,n.col,n.rel);
this.bottomRight=new a(m.row,m.col,m.rel);
this.normalize();
},clone:function(){return new i(this.topLeft.clone(),this.bottomRight.clone()).setSheet(this.sheet,this.hasSheet());
},_containsRange:function(m){return this._containsCell(m.topLeft)&&this._containsCell(m.bottomRight);
},_containsCell:function(m){return m.sheet==this.sheet&&m.row>=this.topLeft.row&&m.col>=this.topLeft.col&&m.row<=this.bottomRight.row&&m.col<=this.bottomRight.col;
},contains:function(m){if(m instanceof Array){var n=this;
return m.some(function(o){return n.contains(o);
});
}if(m instanceof a){return this._containsCell(m);
}if(m instanceof i){return this._containsRange(m);
}return false;
},_intersectRange:function(u){if(this.sheet!=u.sheet){return g;
}var n=this.topLeft.col;
var p=this.topLeft.row;
var o=this.bottomRight.col;
var m=this.bottomRight.row;
var r=u.topLeft.col;
var t=u.topLeft.row;
var s=u.bottomRight.col;
var q=u.bottomRight.row;
if(n<=s&&r<=o&&p<=q&&t<=m){return new i(new a(Math.max(p,t),Math.max(n,r)),new a(Math.min(m,q),Math.min(o,s))).setSheet(this.sheet,this.hasSheet());
}else{return g;
}},intersect:function(m){if(m instanceof a){return this._containsCell(m)?m:g;
}if(m instanceof i){return this._intersectRange(m).simplify();
}if(m instanceof l){return m.intersect(this);
}return g;
},simplify:function(){if(this.isCell()){return new a(this.topLeft.row,this.topLeft.col,this.topLeft.rel).setSheet(this.sheet,this.hasSheet());
}return this;
},normalize:function(){var m=this.topLeft,n=this.bottomRight;
var r=m.row,o=m.col,s=n.row,p=n.col;
var v=m.rel&2,t=m.rel&1;
var w=n.rel&2,u=n.rel&1;
var x,q=false;
if(r>s){q=true;
x=r;
r=s;
s=x;
x=v;
v=w;
w=x;
}if(o>p){q=true;
x=o;
o=p;
p=x;
x=t;
t=u;
u=x;
}if(q){this.topLeft=new a(r,o,t|v);
this.bottomRight=new a(s,p,u|w);
}return this;
},print:function(p,o,m){if(m||this.absolute(p,o).valid()){var n=this.topLeft.print(p,o,m)+":"+this.bottomRight.print(p,o,m);
if(this.hasSheet()){n=e(this.sheet)+(this.endSheet?":"+e(this.endSheet):"")+"!"+n;
}return n;
}return"#REF!";
},absolute:function(n,m){return new i(this.topLeft.absolute(n,m),this.bottomRight.absolute(n,m)).setSheet(this.sheet,this.hasSheet());
},relative:function(n,m,p,o){if(o==null){o=p;
}return new i(this.topLeft.relative(n,m,p),this.bottomRight.relative(n,m,o)).setSheet(this.sheet,this.hasSheet());
},height:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.row-this.topLeft.row+1;
},width:function(){if(this.topLeft.rel!=this.bottomRight.rel){throw new Error("Mixed relative/absolute references");
}return this.bottomRight.col-this.topLeft.col+1;
},collapse:function(){return this.topLeft.toRangeRef();
},leftColumn:function(){return new i(this.topLeft,new a(this.bottomRight.row,this.topLeft.col));
},rightColumn:function(){return new i(new a(this.topLeft.row,this.bottomRight.col),this.bottomRight);
},topRow:function(){return new i(this.topLeft,new a(this.topLeft.row,this.bottomRight.col));
},bottomRow:function(){return new i(new a(this.bottomRight.row,this.topLeft.col),this.bottomRight);
},toRangeRef:function(){return this;
},toRow:function(m){return new i(new a(this.topLeft.row+m,this.topLeft.col),new a(this.topLeft.row+m,this.bottomRight.col));
},toColumn:function(m){return new i(new a(this.topLeft.row,this.topLeft.col+m),new a(this.bottomRight.row,this.topLeft.col+m));
},forEachRow:function(m){var r=this.topLeft.row;
var o=this.bottomRight.row;
var q=this.topLeft.col;
var n=this.bottomRight.col;
for(var p=r;
p<=o;
p++){m(new i(new a(p,q),new a(p,n)));
}},forEachColumn:function(m){var r=this.topLeft.row;
var o=this.bottomRight.row;
var q=this.topLeft.col;
var n=this.bottomRight.col;
for(var p=q;
p<=n;
p++){m(new i(new a(r,p),new a(o,p)));
}},intersecting:function(m){return m.filter(function(n){return n.toRangeRef().intersects(this);
},this);
},union:function(r,o){var p=this.intersecting(r);
var u=this.topLeft.row;
var t=this.topLeft.col;
var n=this.bottomRight.row;
var m=this.bottomRight.col;
var q=false;
p.forEach(function(v){v=v.toRangeRef();
if(v.topLeft.row<u){q=true;
u=v.topLeft.row;
}if(v.topLeft.col<t){q=true;
t=v.topLeft.col;
}if(v.bottomRight.row>n){q=true;
n=v.bottomRight.row;
}if(v.bottomRight.col>m){q=true;
m=v.bottomRight.col;
}if(o){o(v);
}});
var s=new i(new a(u,t),new a(n,m));
if(q){return s.union(r,o);
}else{return s;
}},resize:function(q){var o=Math.max.bind(Math,0);
function p(t){return t||0;
}var s=this.topLeft.row+p(q.top);
var n=this.topLeft.col+p(q.left);
var m=this.bottomRight.row+p(q.bottom);
var r=this.bottomRight.col+p(q.right);
if(n<0&&r<0||s<0&&m<0){return g;
}else{if(s<=m&&n<=r){return new i(new a(o(s),o(n)),new a(o(m),o(r)));
}else{return g;
}}},move:function(n,m){return new i(new a(this.topLeft.row+n,this.topLeft.col+m),new a(this.bottomRight.row+n,this.bottomRight.col+m));
},first:function(){return this.topLeft;
},isCell:function(){return !this.endSheet&&this.topLeft.eq(this.bottomRight);
},toString:function(){return this.topLeft+":"+this.bottomRight;
},adjust:function(p,m,u,r,o,q,n){var s=this.topLeft.adjust(p,m,u,r,o,q,n);
var t=this.bottomRight.adjust(p,m,u,r,o,q,n);
if(s===g&&t===g){return g;
}if(s===g){s=this.topLeft.absolute(p,m);
if(o){s.row=q;
}else{s.col=q;
}if(u!=null&&r!=null){s=s.relative(u,r,this.topLeft.rel);
}}else{if(t===g){t=this.bottomRight.absolute(p,m);
if(o){t.row=q-1;
}else{t.col=q-1;
}if(u!=null&&r!=null){t=t.relative(u,r,this.bottomRight.rel);
}}}return new i(s,t).setSheet(this.sheet,this.hasSheet()).simplify();
},valid:function(){return this.topLeft.valid()&&this.bottomRight.valid();
}});
var l=j.extend({init:function l(m){this.refs=m;
this.length=m.length;
},clone:function(){return new l(this.refs.slice());
},intersect:function(o){var m=[];
for(var n=0;
n<this.length;
++n){var p=o.intersect(this.refs[n]);
if(p!==g){m.push(p);
}}if(m.length>0){return new l(m).simplify();
}return g;
},simplify:function(){var m=new l(this.refs.reduce(function(n,o){o=o.simplify();
if(o!==g){n.push(o);
}return n;
},[]));
if(m.empty()){return g;
}if(m.single()){return m.refs[0];
}return m;
},absolute:function(n,m){return new l(this.refs.map(function(o){return o.absolute(n,m);
}));
},forEach:function(m,n){this.refs.forEach(m,n);
},toRangeRef:function(){return this.refs[0].toRangeRef();
},contains:function(m){return this.refs.some(function(n){return n.contains(m);
});
},map:function(m,n){return new l(this.refs.map(m,n));
},first:function(){return this.refs[0].first();
},lastRange:function(){return this.refs[this.length-1];
},size:function(){return this.length;
},single:function(){return this.length==1;
},empty:function(){return this.length===0;
},isCell:function(){return this.single()&&this.refs[0].isCell();
},rangeAt:function(m){return this.refs[m];
},nextRangeIndex:function(m){if(m===this.length-1){return 0;
}else{return m+1;
}},previousRangeIndex:function(m){if(m===0){return this.length-1;
}else{return m-1;
}},concat:function(m){return new l(this.refs.concat([m]));
},print:function(o,m,n){return this.refs.map(function(p){return p.print(o,m,n);
}).join(",");
},replaceAt:function(m,o){var n=this.refs.slice();
n.splice(m,1,o);
return new l(n);
},leftColumn:function(){return this.map(function(m){return m.leftColumn();
});
},rightColumn:function(){return this.map(function(m){return m.rightColumn();
});
},topRow:function(){return this.map(function(m){return m.topRow();
});
},bottomRow:function(){return this.map(function(m){return m.bottomRow();
});
},forEachRow:function(m){this.forEach(function(n){n.forEachRow(m);
});
},forEachColumn:function(m){this.forEach(function(n){n.forEachColumn(m);
});
},adjust:function(p,m,s,r,o,q,n){return this.map(function(t){return t.adjust(p,m,s,r,o,q,n);
}).simplify();
},toString:function(){return this.refs.map(function(m){return m.toString();
}).join(", ");
},valid:function(){for(var m=this.refs.length;
--m>=0;
){if(this.refs[m].valid()){return false;
}}return true;
},renameSheet:function(n,m){this.refs.forEach(function(o){o.renameSheet(n,m);
});
}});
k.NULLREF=g;
k.SHEETREF=new i(new a(0,0),new a(Infinity,Infinity));
k.FIRSTREF=new a(0,0);
k.Ref=j;
k.NameRef=f;
k.CellRef=a;
k.RangeRef=i;
k.UnionRef=l;
k.SHEETREF.print=function(){return"#SHEET";
};
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/autofillcalculator",["kendo.core"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var d=c.spreadsheet.RangeRef;
var b=c.spreadsheet.CellRef;
var a=c.Class.extend({init:function(e){this._grid=e;
},rectIsVertical:function(g,e,i,j){var h=this._grid.rectangle(g.toRangeRef());
var f=this._grid.rectangle(e.toRangeRef());
return Math.abs(f[j]-h[j])>Math.abs(h[i]-f[i]);
},autoFillDest:function(o,h){var p=o.topLeft;
var f=o.bottomRight;
var n;
var k=h.row>=p.row;
var j=h.col>=p.col;
if(k){n=j?4:3;
}else{n=j?2:1;
}var m,l,g,i;
if(n===4){m=p;
l=f;
i=h.row>l.row||h.col>l.col;
if(i){h=new b(Math.max(h.row,l.row),Math.max(h.col,l.col));
}if(this.rectIsVertical(l,h,"right","bottom")){g=new b(h.row,l.col);
}else{g=new b(l.row,h.col);
}}else{if(n===3){var e=new b(p.col,f.row);
if(h.row>f.row&&this.rectIsVertical(e,h,"left","bottom")){m=p;
g=new b(h.row,f.col);
}else{m=f;
g=new b(p.row,h.col);
}}else{if(n===2){var q=new b(p.row,f.col);
if(h.col>f.col&&!this.rectIsVertical(q,h,"right","top")){m=p;
g=new b(f.row,h.col);
}else{m=f;
g=new b(h.row,p.col);
}}else{m=f;
if(this.rectIsVertical(p,h,"left","top")){g=new b(h.row,p.col);
}else{g=new b(p.row,h.col);
}}}}return this._grid.normalize(new d(m,g));
}});
c.spreadsheet.AutoFillCalculator=a;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/navigator",["kendo.core","spreadsheet/autofillcalculator"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var d=c.spreadsheet.RangeRef;
var a=c.spreadsheet.CellRef;
var b=c.Class.extend({init:function(g,f,h,i){this.rangeGetter=h;
this.prevLeft=function(k){var j=i(this.range(k));
var l=this.range(f.prevVisible(j.topLeft[g]));
return i(l).topLeft[g];
};
this.nextRight=function(k){var j=i(this.range(k));
var l=this.range(f.nextVisible(j.bottomRight[g]));
return i(l).bottomRight[g];
};
this.nextLeft=function(j){var k=i(this.range(j));
return f.nextVisible(k.bottomRight[g]);
};
this.prevRight=function(j){var k=i(this.range(j));
return f.prevVisible(k.topLeft[g]);
};
},boundary:function(g,f){this.top=g;
this.bottom=f;
},range:function(f){return this.rangeGetter(f,this.top,this.bottom);
}});
var e=c.Class.extend({init:function(f){this._sheet=f;
this.columns=this._sheet._grid._columns;
this.autoFillCalculator=new c.spreadsheet.AutoFillCalculator(f._grid);
this.colEdge=new b("col",this._sheet._grid._columns,this.columnRange.bind(this),this.union.bind(this));
this.rowEdge=new b("row",this._sheet._grid._rows,this.rowRange.bind(this),this.union.bind(this));
},height:function(f){this._viewPortHeight=f;
},union:function(f){return this._sheet.unionWithMerged(f);
},columnRange:function(g,h,f){return this._sheet._ref(h,g,f-h,1);
},rowRange:function(h,f,g){return this._sheet._ref(h,f,1,g-f);
},selectionIncludesMergedCells:function(){return this._sheet.select().contains(this._sheet._mergedCells);
},setSelectionValue:function(g){var f=this._sheet.selection();
setTimeout(function(){f.value(g());
});
},selectAll:function(){this._sheet.select(this._sheet._sheetRef);
},select:function(h,g,f){h=this.refForMode(h,g);
if(f){h=this._sheet.select().concat(h);
}this._sheet.select(h);
},refForMode:function(h,g){var f=this._sheet._grid;
switch(g){case"range":h=f.normalize(h);
break;
case"row":h=f.rowRef(h.row);
break;
case"column":h=f.colRef(h.col);
break;
case"sheet":h=this._sheet._sheetRef;
break;
}return h;
},startSelection:function(i,g,f,j){if(g=="autofill"){this._sheet.startAutoFill();
}else{if(j&&g=="range"){var h=new d(this._sheet.activeCell().first(),i);
this._sheet.select(h,false,false);
this._sheet.startSelection();
}else{this._sheet.startSelection();
this.select(i,g,f);
}}},completeSelection:function(){this._sheet.completeSelection();
},selectForContextMenu:function(g,f){var h=this._sheet;
if(!h.select().contains(this.refForMode(g,f))){this.select(g,f);
}},modifySelection:function(f){var j=this.determineDirection(f);
var p=this._sheet;
var r=this._viewPortHeight;
var m=p._grid._rows;
var i=p._grid._columns;
var l=p.currentOriginalSelectionRange();
var o=p.select().toRangeRef();
var g=p.activeCell();
var q=l.topLeft.clone();
var h=l.bottomRight.clone();
var n;
this.colEdge.boundary(o.topLeft.row,o.bottomRight.row);
this.rowEdge.boundary(o.topLeft.col,o.bottomRight.col);
switch(j){case"expand-left":q.col=this.colEdge.prevLeft(q.col);
n=q;
break;
case"shrink-right":q.col=this.colEdge.nextLeft(q.col);
n=q;
break;
case"expand-right":h.col=this.colEdge.nextRight(h.col);
n=h;
break;
case"shrink-left":h.col=this.colEdge.prevRight(h.col);
n=h;
break;
case"expand-up":q.row=this.rowEdge.prevLeft(q.row);
n=q;
break;
case"shrink-down":q.row=this.rowEdge.nextLeft(q.row);
n=q;
break;
case"expand-down":h.row=this.rowEdge.nextRight(h.row);
n=h;
break;
case"shrink-up":h.row=this.rowEdge.prevRight(h.row);
n=h;
break;
case"expand-page-up":q.row=m.prevPage(q.row,r);
break;
case"shrink-page-up":h.row=m.prevPage(h.row,r);
break;
case"expand-page-down":h.row=m.nextPage(h.row,r);
break;
case"shrink-page-down":q.row=m.nextPage(q.row,r);
break;
case"first-col":q.col=i.firstVisible();
h.col=g.bottomRight.col;
n=q;
break;
case"last-col":h.col=i.lastVisible();
q.col=g.topLeft.col;
n=h;
break;
case"first-row":q.row=m.firstVisible();
h.row=g.bottomRight.row;
n=q;
break;
case"last-row":h.row=m.lastVisible();
q.row=g.topLeft.row;
n=h;
break;
case"last":h.row=m.lastVisible();
h.col=i.lastVisible();
q=g.topLeft;
n=h;
break;
case"first":q.row=m.firstVisible();
q.col=i.firstVisible();
h=g.bottomRight;
n=q;
break;
}var k=new d(q,h);
if(!this.union(k).intersects(g)){this.modifySelection(j.replace("shrink","expand"));
return;
}if(n){p.focus(n);
}this.updateCurrentSelectionRange(k);
},moveActiveCell:function(k){var n=this._sheet;
var f=n.activeCell();
var o=f.topLeft;
var g=f.bottomRight;
var h=n.originalActiveCell();
var m=n._grid._rows;
var j=n._grid._columns;
var l=h.row;
var i=h.col;
switch(k){case"left":i=j.prevVisible(o.col);
break;
case"up":l=m.prevVisible(o.row);
break;
case"right":i=j.nextVisible(g.col);
break;
case"down":l=m.nextVisible(g.row);
break;
case"first-col":i=j.firstVisible();
break;
case"last-col":i=j.lastVisible();
break;
case"first-row":l=m.firstVisible();
break;
case"last-row":l=m.lastVisible();
break;
case"last":l=m.lastVisible();
i=j.lastVisible();
break;
case"first":l=m.firstVisible();
i=j.firstVisible();
break;
case"next-page":l=m.nextPage(g.row,this._viewPortHeight);
break;
case"prev-page":l=m.prevPage(g.row,this._viewPortHeight);
break;
}n.select(new a(l,i));
},navigateInSelection:function(k){var r=this._sheet;
var f=r.activeCell();
var s=f.topLeft;
var g=r.originalActiveCell();
var n=r._grid._rows;
var i=r._grid._columns;
var m=g.row;
var h=g.col;
var p=r.currentNavigationRange();
var q=p.topLeft;
var o=p.bottomRight;
var l=false;
var t=s.col;
var u=s.row;
while(!l){var j=new a(m,h);
switch(k){case"next":if(o.eq(j)){p=r.nextNavigationRange();
m=p.topLeft.row;
h=p.topLeft.col;
}else{h=i.nextVisible(t,true);
if(h>o.col){h=q.col;
m=n.nextVisible(m,true);
}}break;
case"previous":if(q.eq(j)){p=r.previousNavigationRange();
m=p.bottomRight.row;
h=p.bottomRight.col;
}else{h=i.prevVisible(t,true);
if(h<q.col){h=o.col;
m=n.prevVisible(m,true);
}}break;
case"lower":if(o.eq(j)){p=r.nextNavigationRange();
m=p.topLeft.row;
h=p.topLeft.col;
}else{m=n.nextVisible(u,true);
if(m>o.row){m=q.row;
h=i.nextVisible(h,true);
}}break;
case"upper":if(q.eq(j)){p=r.previousNavigationRange();
m=p.bottomRight.row;
h=p.bottomRight.col;
}else{m=n.prevVisible(u,true);
if(m<q.row){m=o.row;
h=i.prevVisible(h,true);
}}break;
default:throw new Error("Unknown entry navigation: "+k);
}l=!this.shouldSkip(m,h);
t=h;
u=m;
}if(r.singleCellSelection()){r.select(new a(m,h));
}else{r.activeCell(new a(m,h));
}},extendSelection:function(i,h){var j=this._sheet;
var g=j._grid;
if(h==="autofill"){this.resizeAutoFill(i);
return;
}if(h==="range"){i=g.normalize(i);
}else{if(h==="row"){i=g.rowRef(i.row).bottomRight;
}else{if(h==="column"){i=g.colRef(i.col).bottomRight;
}}}var f=j.originalActiveCell().toRangeRef();
this.updateCurrentSelectionRange(new d(f.topLeft,i));
},shouldSkip:function(i,f){var h=new a(i,f);
var g=false;
this._sheet.forEachMergedCell(function(j){if(j.intersects(h)&&!j.collapse().eq(h)){g=true;
}});
return g;
},resizeAutoFill:function(m){var p=this._sheet;
var o=p.select();
var i=p._autoFillOrigin;
var f=this.autoFillCalculator.autoFillDest(o,m);
var l=this.punch(o,f);
var h,g,n;
if(!l){var j=p.range(f)._previewFillFrom(p.range(i));
if(j){g=j.direction;
var k=j.props;
if(g===0||g==1){n=k[k.length-1];
h=n[n.length-1].value;
}else{if(g===2){n=k[0];
h=n[n.length-1].value;
}else{if(g===3){n=k[k.length-1];
h=n[0].value;
}}}}}p.updateAutoFill(f,l,h,g);
},determineDirection:function(f){var k=this._sheet.currentSelectionRange();
var g=this._sheet.activeCell();
var i=g.topLeft.col==k.topLeft.col;
var j=g.bottomRight.col==k.bottomRight.col;
var l=g.topLeft.row==k.topLeft.row;
var h=g.bottomRight.row==k.bottomRight.row;
switch(f){case"left":f=j?"expand-left":"shrink-left";
break;
case"right":f=i?"expand-right":"shrink-right";
break;
case"up":f=h?"expand-up":"shrink-up";
break;
case"down":f=l?"expand-down":"shrink-down";
break;
case"prev-page":f=h?"expand-page-up":"shrink-page-up";
break;
case"next-page":f=l?"expand-page-down":"shrink-page-down";
break;
}return f;
},updateCurrentSelectionRange:function(f){var g=this._sheet;
g.select(g.originalSelect().replaceAt(g.selectionRangeIndex(),f),false);
},punch:function(i,j){var h;
if(j.topLeft.eq(i.topLeft)){if(j.bottomRight.row<i.bottomRight.row){var g=this.rowEdge.nextRight(j.bottomRight.row);
h=new d(new a(g,i.topLeft.col),i.bottomRight);
}else{if(j.bottomRight.col<i.bottomRight.col){var f=this.colEdge.nextRight(j.bottomRight.col);
h=new d(new a(i.topLeft.row,f),i.bottomRight);
}}}return h;
}});
c.spreadsheet.SheetNavigator=e;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/axismanager",["kendo.core"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a=b.Class.extend({init:function(c){this._sheet=c;
},forEachSelectedColumn:function(c){var d=this._sheet;
d.batch(function(){d.select().forEachColumnIndex(function(f,e){c(d,f,e);
});
},{layout:true,recalc:true});
},forEachSelectedRow:function(c){var d=this._sheet;
d.batch(function(){d.select().forEachRowIndex(function(f,e){c(d,f,e);
});
},{layout:true,recalc:true});
},includesHiddenColumns:function(c){return this._sheet._grid._columns.includesHidden(c.topLeft.col,c.bottomRight.col);
},includesHiddenRows:function(c){return this._sheet._grid._rows.includesHidden(c.topLeft.row,c.bottomRight.row);
},selectionIncludesHiddenColumns:function(){return this.includesHiddenColumns(this._sheet.select());
},selectionIncludesHiddenRows:function(){return this.includesHiddenRows(this._sheet.select());
},deleteSelectedColumns:function(){this.forEachSelectedColumn(function(e,d,c){e.deleteColumn(d-c);
});
},deleteSelectedRows:function(){this.forEachSelectedRow(function(e,d,c){e.deleteRow(d-c);
});
},hideSelectedColumns:function(){this.forEachSelectedColumn(function(k,j){k.hideColumn(j);
});
var i=this._sheet;
var f=i.select().toRangeRef();
var e=f.topLeft.col;
var g=f.bottomRight.col;
var h=null;
while(true){var d=g<i._columns._count;
var c=e>=0;
if(!c&&!d){break;
}if(d&&!i.isHiddenColumn(g)){h=g;
break;
}if(c&&!i.isHiddenColumn(e)){h=e;
break;
}e--;
g++;
}if(h!==null){f=new b.spreadsheet.RangeRef(new b.spreadsheet.CellRef(0,h),new b.spreadsheet.CellRef(i._rows._count-1,h));
i.range(f).select();
}},hideSelectedRows:function(){this.forEachSelectedRow(function(k,j){k.hideRow(j);
});
var h=this._sheet;
var f=h.select().toRangeRef();
var i=f.topLeft.row;
var c=f.bottomRight.row;
var g=null;
while(true){var d=c<h._rows._count;
var e=i>=0;
if(!e&&!d){break;
}if(d&&!h.isHiddenRow(c)){g=c;
break;
}if(e&&!h.isHiddenRow(i)){g=i;
break;
}i--;
c++;
}if(g!==null){f=new b.spreadsheet.RangeRef(new b.spreadsheet.CellRef(g,0),new b.spreadsheet.CellRef(g,h._columns._count-1));
h.range(f).select();
}},unhideSelectedColumns:function(){this.forEachSelectedColumn(function(d,c){d.unhideColumn(c);
});
},unhideSelectedRows:function(){this.forEachSelectedRow(function(d,c){d.unhideRow(c);
});
},addColumnLeft:function(){this.forEachSelectedColumn(function(e,d,c){e.insertColumn(d-c);
});
},addColumnRight:function(){this.forEachSelectedColumn(function(e,d,c){e.insertColumn(d+(c+1));
});
},canAddRow:function(){var c=this._sheet.select().toRangeRef();
var d=c.height();
return this._sheet.canInsertRow(0,d);
},addRowAbove:function(){this.forEachSelectedRow(function(e,d,c){e.insertRow(d-c);
});
},addRowBelow:function(){this.forEachSelectedRow(function(e,d,c){e.insertRow(d+(c+1));
});
}});
b.spreadsheet.AxisManager=a;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/clipboard",["kendo.core"],b);
}(function(){(function(g){if(g.support.browser.msie&&g.support.browser.version<9){return;
}var a=g.jQuery;
var c=g.spreadsheet.CellRef;
var e=g.Class.extend({init:function(m){this.workbook=m;
this.origin=g.spreadsheet.NULLREF;
this.iframe=document.createElement("iframe");
this.iframe.className="k-spreadsheet-clipboard-paste";
this.menuInvoked=true;
this._external={};
this._uid=g.guid();
document.body.appendChild(this.iframe);
},canCopy:function(){var n={canCopy:true};
var m=this.workbook.activeSheet().select();
if(m===g.spreadsheet.NULLREF){n.canCopy=false;
}if(m instanceof g.spreadsheet.UnionRef){n.canCopy=false;
n.multiSelection=true;
}if(this.menuInvoked){n.canCopy=false;
n.menuInvoked=true;
}return n;
},canPaste:function(){var o=this.workbook.activeSheet();
var n=this.pasteRef();
var p={canPaste:true};
if(n===g.spreadsheet.NULLREF){var m=this.isExternal();
p.pasteOnMerged=this.intersectsMerged();
p.canPaste=p.pasteOnMerged?false:m;
return p;
}if(!n.eq(o.unionWithMerged(n))){p.canPaste=false;
p.pasteOnMerged=true;
}if(this.menuInvoked){p.canPaste=false;
p.menuInvoked=true;
}if(n.bottomRight.row>=o._rows._count||n.bottomRight.col>=o._columns._count){p.canPaste=false;
p.overflow=true;
}return p;
},intersectsMerged:function(){var n=this.workbook.activeSheet();
var o=this.parse(this._external);
this.origin=f(o);
var m=this.pasteRef();
return !m.eq(n.unionWithMerged(m));
},copy:function(){var m=this.workbook.activeSheet();
this.origin=m.select();
this.contents=m.selection().getState();
delete this._external.html;
delete this._external.plain;
},cut:function(){var m=this.workbook.activeSheet();
this.copy();
m.range(m.select()).clear();
},pasteRef:function(){var q=this.workbook.activeSheet();
var n=q.activeCell().first();
var o=this.origin.first();
var p=o.row-n.row;
var m=o.col-n.col;
return this.origin.relative(p,m,3);
},destroy:function(){document.body.removeChild(this.iframe);
},paste:function(){var o={};
var n=this.workbook.activeSheet();
if(this._isInternal()){o=this.contents;
}else{o=this.parse(this._external);
this.origin=f(o);
}var m=this.pasteRef();
n.range(m).setState(o,this);
n.triggerChange({recalc:true,ref:m});
},external:function(m){if(m&&(m.html||m.plain)){this._external=m;
}else{return this._external;
}},isExternal:function(){return !this._isInternal();
},parse:function(m){var p=h();
if(m.html){var n=this.iframe.contentWindow.document;
n.open();
n.write(m.html);
n.close();
var q=a(n).find("table:first");
if(q.length){p=i(q.find("tbody:first"));
}else{if(!m.plain){var o=a(n.body).find(":not(style)");
k(p,0,0,d(o.text()));
}else{p=j(m.plain);
}}}else{p=j(m.plain);
}return p;
},_isInternal:function(){if(this._external.html===undefined){return true;
}var m=a("<div/>").html(this._external.html).find("table.kendo-clipboard-"+this._uid).length?true:false;
var n=a("<div/>").html(this._external.plain).find("table.kendo-clipboard-"+this._uid).length?true:false;
if(m||n){return true;
}return false;
}});
g.spreadsheet.Clipboard=e;
function h(){var m=new c(0,0,0);
return{ref:m,mergedCells:[],data:[],foreign:true,origRef:m.toRangeRef()};
}function k(q,p,n,r){var o=q.data||(q.data=[]);
if(!o[p]){o[p]=[];
}o[p][n]=r;
var m=q.origRef.bottomRight;
m.row=Math.max(m.row,p);
m.col=Math.max(m.col,n);
}function f(m){return m.origRef;
}function l(m){return m.replace(/^-(?:ms|moz|webkit)-/,"");
}function b(n){var m={};
["borderBottom","borderRight","borderLeft","borderTop"].forEach(function(o){m[o]=n[o+"Style"]=="none"?null:{size:1,color:n[o+"Color"]};
});
return m;
}function d(n){var p=window.getComputedStyle(n[0]);
var q=n[0].innerText;
var m=b(p);
var o={value:q===""?null:q,borderBottom:m.borderBottom,borderRight:m.borderRight,borderLeft:m.borderLeft,borderTop:m.borderTop,fontSize:parseInt(p["font-size"],10)};
if(p["background-color"]!=="rgb(0, 0, 0)"&&p["background-color"]!=="rgba(0, 0, 0, 0)"){o.background=p["background-color"];
}if(p.color!=="rgb(0, 0, 0)"&&p.color!=="rgba(0, 0, 0, 0)"){o.color=p.color;
}if(p["text-decoration"]=="underline"){o.underline=true;
}if(p["font-style"]=="italic"){o.italic=true;
}if(p["font-weight"]=="bold"){o.bold=true;
}if(l(p["text-align"])!=="right"){o.textAlign=l(p["text-align"]);
}if(p["vertical-align"]!=="middle"){o.verticalAlign=p["vertical-align"];
}if(p["word-wrap"]!=="normal"){o.wrap=true;
}return o;
}function i(n){var m=h();
n.find("tr").each(function(o,p){a(p).find("td").each(function(s,z){var y=parseInt(a(z).attr("rowspan"),10)-1||0;
var t=parseInt(a(z).attr("colspan"),10)-1||0;
var q="<td/>";
var r;
if(y){var u=o+y;
for(var w=o;
w<=u;
w++){var x=n.find("tr").eq(w);
if(w>o){q="<td class='rowspan'></td>";
if(s===0){x.find("td").eq(s).after(q);
}else{var v=Math.min(x.find("td").length,s);
x.find("td").eq(v-1).after(q);
}}if(t){for(r=s;
r<t+s;
r++){q="<td class='rowspan colspan'></td>";
x.find("td").eq(r).after(q);
}}}}else{if(t){for(r=s;
r<t+s;
r++){q="<td class='colspan'></td>";
a(p).find("td").eq(r).after(q);
}}}});
});
n.find("tr").each(function(o,p){a(p).find("td").each(function(r,w){var u=parseInt(a(w).attr("rowspan"),10)-1||0;
var s=parseInt(a(w).attr("colspan"),10)-1||0;
k(m,o,r,d(a(w)));
if(u||s){var v=String.fromCharCode(65+r);
var t=String.fromCharCode(65+r+s);
var q=v+(o+1)+":"+t+(o+1+u);
m.mergedCells.push(q);
}});
});
return m;
}function j(o){var r=h();
if(o.indexOf("\t")===-1&&o.indexOf("\n")==-1){k(r,0,0,{value:o});
}else{var q=o.split("\n");
for(var p=0;
p<q.length;
p++){var n=q[p].split("\t");
for(var m=0;
m<n.length;
m++){k(r,p,m,{value:n[m]});
}}}return r;
}}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/range",["kendo.core","util/text-metrics"],b);
}(function(){(function(e){if(e.support.browser.msie&&e.support.browser.version<9){return;
}var a=e.jQuery;
var m=e.spreadsheet.UnionRef;
var c=e.spreadsheet.CellRef;
var k=e.spreadsheet.RangeRef;
var i=["color","fontFamily","underline","italic","bold","textAlign","verticalAlign","background","format","link","editor"];
var b={borderTop:{complement:"borderBottom",direction:{top:-1,bottom:-1}},borderLeft:{complement:"borderRight",direction:{left:-1,right:-1}},borderRight:{complement:"borderLeft",direction:{left:1,right:1}},borderBottom:{complement:"borderTop",direction:{top:1,bottom:1}}};
var j=e.Class.extend({init:function(n,o){this._sheet=o;
this._ref=n;
},clone:function(){return new j(this._ref.clone(),this._sheet);
},skipHiddenCells:function(){var o=[];
var p=this,q=p._sheet;
var s=q.isHiddenRow.bind(q);
var r=q.isHiddenColumn.bind(q);
p._ref.forEach(function n(x){if(x instanceof m){x.forEach(n);
}else{x=p._normalize(x.toRangeRef());
var z=x.topLeft,t=x.bottomRight;
var y=h(z.row,t.row,s);
var u=h(z.col,t.col,r);
for(var v=0;
v<y.length;
++v){for(var w=0;
w<u.length;
++w){o.push(new k(new c(y[v].begin,u[w].begin),new c(y[v].end,u[w].end)));
}}}});
return q.range(o.length>1?new m(o):o[0]);
},_normalize:function(n){return this._sheet._grid.normalize(n);
},_set:function(n,r,o){var p=this;
var q=p._sheet;
p._ref.forEach(function(s){q._set(s.toRangeRef(),n,r);
});
if(!o){q.triggerChange({recalc:n=="formula"||n=="value"||n=="validation",value:r,ref:p._ref});
}return p;
},_get:function(n){return this._sheet._get(this._ref.toRangeRef(),n);
},_property:function(n,o){if(o===undefined){return this._get(n);
}else{return this._set(n,o);
}},value:function(n){if(n!==undefined){this._set("formula",null,true);
}return this._property("value",n);
},resize:function(n){var o=this._resizedRef(n);
return new j(o,this._sheet);
},_resizedRef:function(n){return this._ref.map(function(o){return o.toRangeRef().resize(n);
});
},_border:function(p,s){var q;
var n=b[p].complement;
var o=b[p].direction;
var r=this._sheet;
r.batch(function(){q=this._property(p,s);
if(s!==undefined){this._resizedRef(o).forEach(function(t){if(t!==e.spreadsheet.NULLREF){new j(t,r)._property(n,null);
}});
}}.bind(this),{});
return q;
},_collapsedBorder:function(p){var q=this._property(p);
var n=b[p].complement;
var o=b[p].direction;
this._resizedRef(o).forEach(function(s){if(!q&&s!==e.spreadsheet.NULLREF){var r=new j(s,this._sheet);
q=r._property(n);
}}.bind(this));
return q;
},borderTop:function(n){return this._border("borderTop",n);
},borderRight:function(n){return this._border("borderRight",n);
},borderBottom:function(n){return this._border("borderBottom",n);
},borderLeft:function(n){return this._border("borderLeft",n);
},collapsedBorderTop:function(){return this._collapsedBorder("borderTop");
},collapsedBorderRight:function(){return this._collapsedBorder("borderRight");
},collapsedBorderBottom:function(){return this._collapsedBorder("borderBottom");
},collapsedBorderLeft:function(){return this._collapsedBorder("borderLeft");
},input:function(t){var n=this._get("format"),u;
if(t!==undefined){var r=this._ref.toRangeRef().topLeft;
u=e.spreadsheet.calc.parse(this._sheet.name(),r.row,r.col,t);
this._sheet.batch(function(){var v=null;
if(u.type=="exp"){v=e.spreadsheet.calc.compile(u);
}else{if(n!="@"){if(u.type=="date"){this.format(u.format||l(e.culture().calendar.patterns.d));
}else{if(u.type=="percent"){this.format(u.value*100==(u.value*100|0)?"0%":"0.00%");
}else{if(u.format&&!n){this.format(u.format);
}}}}else{if(u.type!="string"){u.value=t;
}}}this.formula(v);
if(!v){this.value(u.value);
}}.bind(this),{recalc:true,value:t,ref:this._ref,editorChange:this._sheet.isInEditMode()});
return this;
}else{t=this._get("value");
var o=this._get("formula");
var s=n&&!o&&e.spreadsheet.formatting.type(t,n);
if(o){t="="+o;
}else{OUT:{if(n&&s=="date"){var p=e.spreadsheet.formatting.text(t,n);
u=e.spreadsheet.calc.parse(null,null,null,p);
if(typeof u.value=="number"){var q=e.spreadsheet.formatting.text(u.value,n);
if(p==q){t=p;
break OUT;
}}}if(s==="date"){t=e.toString(e.spreadsheet.numberToDate(t),e.culture().calendar.patterns.d);
}else{if(s==="percent"){t=t*100+"%";
}else{if(typeof t=="string"&&(/^[=']/.test(t)||/^(?:true|false)$/i.test(t)||f(t))){t="'"+t;
}}}}}return t;
}},enable:function(n){if(n===undefined){n=true;
this._sheet.forEach(this._ref.toRangeRef(),function(o,p,q){if(q.enable===false){n=false;
}});
return n;
}this._property("enable",n);
},formula:function(o){if(o===undefined){var n=this._get("formula");
return n?""+n:null;
}return this._property("formula",o);
},validation:function(o){if(o===undefined){var n=this._get("validation");
return n?n.toJSON():null;
}return this._property("validation",o);
},_getValidationState:function(){var q=this._ref.toRangeRef();
var t=q.topLeft.row;
var s=q.topLeft.col;
var o=q.bottomRight.row;
var n=q.bottomRight.col;
var p,r;
for(p=s;
p<=n;
p++){for(r=t;
r<=o;
r++){var u=this._sheet._validation(r,p);
if(u&&u.type==="reject"&&u.value===false){return u;
}}}return false;
},merge:function(){this._ref=this._sheet._merge(this._ref);
return this;
},unmerge:function(){var n=this._sheet._mergedCells;
this._ref.forEach(function(o){o.toRangeRef().intersecting(n).forEach(function(p){n.splice(n.indexOf(p),1);
});
});
this._sheet.triggerChange({});
return this;
},select:function(){this._sheet.select(this._ref);
return this;
},values:function(w){if(this._ref instanceof m){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===e.spreadsheet.NULLREF){if(w!==undefined){throw new Error("Unsupported for NULLREF.");
}else{return[];
}}var q=this._ref.toRangeRef();
var u=q.topLeft.row;
var t=q.topLeft.col;
var o=q.bottomRight.row;
var n=q.bottomRight.col;
var p,r;
if(w===undefined){w=new Array(q.height());
for(var x=0;
x<w.length;
x++){w[x]=new Array(q.width());
}for(p=t;
p<=n;
p++){for(r=u;
r<=o;
r++){w[r-u][p-t]=this._sheet._value(r,p);
}}return w;
}else{this._sheet._set(q,"formula",null);
for(p=t;
p<=n;
p++){for(r=u;
r<=o;
r++){var s=w[r-u];
if(s){var v=s[p-t];
if(v!==undefined){this._sheet._value(r,p,v);
}}}}this._sheet.triggerChange({recalc:true,ref:q});
return this;
}},_properties:function(r){if(this._ref instanceof m){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===e.spreadsheet.NULLREF){if(r!==undefined){throw new Error("Unsupported for NULLREF.");
}else{return[];
}}var s=this._ref.toRangeRef();
var y=s.topLeft.row;
var x=s.topLeft.col;
var o=s.bottomRight.row;
var n=s.bottomRight.col;
var p,t;
var w=this._sheet;
if(r===undefined){r=new Array(s.height());
w.forEach(s,function(C,z,A){C-=y;
z-=x;
var B=r[C]||(r[C]=[]);
B[z]=A;
});
return r;
}else{var q;
s=s.clone();
var v=function(z){var A=q[z];
s.topLeft.row=s.bottomRight.row=t;
s.topLeft.col=s.bottomRight.col=p;
if(z=="value"){w._set(s,"formula",null);
}w._set(s,z,A);
};
for(p=x;
p<=n;
p++){for(t=y;
t<=o;
t++){var u=r[t-y];
if(u){q=u[p-x];
if(q){Object.keys(q).forEach(v);
}}}}w.triggerChange({recalc:true,ref:this._ref});
return this;
}},clear:function(o){var n=!o||!Object.keys(o).length;
var q=this._sheet;
var p={recalc:n||o&&o.contentsOnly===true,ref:this._ref};
q.batch(function(){if(p.recalc){this.formula(null);
}if(n){this.validation(null);
}if(n||o&&o.formatOnly===true){i.forEach(function(r){this[r](null);
}.bind(this));
this.unmerge();
}}.bind(this),p);
return this;
},clearContent:function(){return this.clear({contentsOnly:true});
},clearFormat:function(){return this.clear({formatOnly:true});
},isSortable:function(){return !(this._ref instanceof m||this._ref===e.spreadsheet.NULLREF);
},sort:function(n){if(this._ref instanceof m){throw new Error("Unsupported for multiple ranges.");
}if(this._ref===e.spreadsheet.NULLREF){throw new Error("Unsupported for NULLREF.");
}if(n===undefined){n={column:0};
}n=n instanceof Array?n:[n];
this._sheet._sortBy(this._ref.toRangeRef(),n.map(function(p,o){if(typeof p==="number"){p={column:p};
}return{index:p.column===undefined?o:p.column,ascending:p.ascending===undefined?true:p.ascending};
}));
return this;
},isFilterable:function(){return !(this._ref instanceof m);
},filter:function(n){if(this._ref instanceof m){throw new Error("Unsupported for multiple ranges.");
}if(n===false){this.clearFilters();
}else{n=n===true?[]:n instanceof Array?n:[n];
this._sheet._filterBy(this._ref.toRangeRef(),n.map(function(p,o){return{index:p.column===undefined?o:p.column,filter:p.filter};
}));
}return this;
},clearFilter:function(n){this._sheet.clearFilter(n);
},clearFilters:function(){var n=this._sheet.filter();
var p=[];
if(n){for(var o=0;
o<n.columns.length;
o++){p.push(o);
}this._sheet.batch(function(){this.clearFilter(p);
this._filter=null;
},{layout:true,filter:true});
}},hasFilter:function(){var n=this._sheet.filter();
return !!n;
},leftColumn:function(){return new j(this._ref.leftColumn(),this._sheet);
},rightColumn:function(){return new j(this._ref.rightColumn(),this._sheet);
},topRow:function(){return new j(this._ref.topRow(),this._sheet);
},bottomRow:function(){return new j(this._ref.bottomRow(),this._sheet);
},column:function(n){return new j(this._ref.toColumn(n),this._sheet);
},row:function(n){return new j(this._ref.toRow(n),this._sheet);
},forEachRow:function(n){this._ref.forEachRow(function(o){n(new j(o,this._sheet));
}.bind(this));
},forEachColumn:function(n){this._ref.forEachColumn(function(o){n(new j(o,this._sheet));
}.bind(this));
},sheet:function(){return this._sheet;
},topLeft:function(){return this._ref.toRangeRef().topLeft;
},intersectingMerged:function(){var o=this._sheet;
var n=[];
o._mergedCells.forEach(function(p){if(p.intersects(this._ref)){n.push(p.toString());
}}.bind(this));
return n;
},getState:function(p){var r=this._ref.first();
var q={ref:r,data:[],origRef:this._ref};
var o;
if(!p){o=e.spreadsheet.ALL_PROPERTIES;
q.mergedCells=this.intersectingMerged();
}else{if(p==="input"){o=["value","formula"];
}else{if(p==="border"){o=["borderLeft","borderTop","borderRight","borderBottom"];
}else{o=[p];
}}}var n=q.data;
this.forEachCell(function(x,u,s){var t={};
var w=x-r.row;
var v=u-r.col;
if(!n[w]){n[w]=[];
}n[w][v]=t;
o.forEach(function(y){t[y]=typeof s[y]=="undefined"?null:s[y];
});
});
return q;
},setState:function(s,n){var r=this._sheet;
var p=this._ref.first();
var q=s.ref.row-p.row;
var o=s.ref.col-p.col;
r.batch(function(){if(s.mergedCells){this.unmerge();
}var t=p.row;
s.data.forEach(function(v,w){if(n&&!n.isExternal()&&r.isHiddenRow(s.ref.row+w)){return;
}var u=p.col;
v.forEach(function(x,y){if(n&&!n.isExternal()&&r.isHiddenColumn(s.ref.col+y)){return;
}var B=n?r.range(t,u):r.range(p.row+w,p.col+y);
if(B.enable()){for(var A in x){if(A!="value"){if(!(n&&A=="enable")){B._set(A,x[A]);
}}}if(!x.formula){if(n&&n.isExternal()){try{if(x.value==null){B._set("value",null);
}else{B.input(x.value);
}}catch(z){B._set("value",x.value);
}}else{B._set("value",x.value);
}}}u++;
});
t++;
});
if(s.mergedCells){s.mergedCells.forEach(function(u){u=r._ref(u).relative(q,o,3);
r.range(u).merge();
},this);
}}.bind(this),{recalc:true});
},_adjustRowHeight:function(){var p=this._sheet;
var q=this.getState();
var o=[];
for(var n=0;
n<q.mergedCells.length;
n++){o.push(p.range(q.mergedCells[n]));
}this.forEachRow(function(s){if(s.topLeft().row>=s.sheet()._rows._count){return;
}var r=s.sheet().rowHeight(s.topLeft().row);
s.forEachCell(function(x,v,t){var u=p.range(x,v);
var y=0;
for(var w=0;
w<o.length;
w++){if(u._ref.intersects(o[w]._ref)){y+=t.width;
break;
}}var z=Math.max(p.columnWidth(v),y);
r=Math.max(r,e.spreadsheet.util.getTextHeight(t.value,z,t.fontSize,t.wrap));
});
p.rowHeight(s.topLeft().row,Math.max(p.rowHeight(s.topLeft().row),r));
});
},forEachCell:function(n){this._ref.forEach(function(o){this._sheet.forEach(o.toRangeRef(),n.bind(this));
}.bind(this));
},hasValue:function(){var n=false;
this.forEachCell(function(q,p,o){if(Object.keys(o).length!==0){n=true;
}});
return n;
},wrap:function(n){if(n===undefined){return !!this._property("wrap");
}this.forEachRow(function(p){var o=p.sheet().rowHeight(p.topLeft().row);
p.forEachCell(function(s,r,q){var t=this._sheet.columnWidth(r);
if(q.value!==null&&q.value!==undefined){o=Math.max(o,e.spreadsheet.util.getTextHeight(q.value,t,q.fontSize,true));
}});
p.sheet().rowHeight(p.topLeft().row,o);
}.bind(this));
this._property("wrap",n);
return this;
},fontSize:function(n){if(n===undefined){return this._property("fontSize");
}this.forEachRow(function(p){var o=p.sheet().rowHeight(p.topLeft().row);
p.forEachCell(function(s,r,q){var t=this._sheet.columnWidth(r);
if(q.value!==null&&q.value!==undefined){o=Math.max(o,e.spreadsheet.util.getTextHeight(q.value,t,n,q.wrap));
}});
p.sheet().rowHeight(p.topLeft().row,o);
}.bind(this));
this._property("fontSize",n);
return this;
},draw:function(o,n){this._sheet.draw(this,o,n);
}});
function h(n,o,q){while(n<=o&&q(n)){n++;
}if(n>o){return[];
}for(var p=n+1;
p<=o;
++p){if(q(p)){return[{begin:n,end:p-1}].concat(h(p+1,o,q));
}}return[{begin:n,end:o}];
}a.each(i,function(n,o){j.prototype[o]=function(p){return this._property(o,p);
};
});
function l(n){return n.replace(/M/g,"m").replace(/'/g,'"').replace(/tt/,"am/pm");
}function f(n){return !/^=/.test(n)&&/number|percent/.test(e.spreadsheet.calc.parse(null,0,0,n).type);
}var g=a('<div style="position: absolute !important; top: -4000px !important; height: auto !important;padding: 1px !important; margin: 0 !important; border: 1px solid black !important;line-height: normal !important; visibility: hidden !important;white-space: pre-wrap !important; word-break: break-all !important;" />')[0];
function d(p,q,n,r){var o={baselineMarkerSize:0,width:q+"px","font-size":(n||12)+"px","word-break":r===true?"break-all":"normal","white-space":r===true?"pre-wrap":"pre"};
return e.util.measureText(p,o,g).height;
}e.spreadsheet.util={getTextHeight:d};
e.spreadsheet.Range=j;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/runtime",["spreadsheet/references"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var f={};
var L=kendo.spreadsheet;
L.calc=f;
var r=f.runtime={};
var i=kendo.Class;
var J=L.Ref;
var h=L.CellRef;
var I=L.RangeRef;
var M=L.UnionRef;
var C=L.NULLREF;
function g(Q){if(Q instanceof g){return Q;
}this.code=Q;
}g.prototype.toString=function(){return"#"+this.code+(this.code=="NAME"?"?":"!");
};
var k=i.extend({init:function k(Q,R,T,S){this.callback=Q;
this.formula=R;
this.ss=T;
this.parent=S;
},resolve:function(R){var Q=this;
if(R instanceof J){Q.resolveCells([R],function(){Q._resolve(R);
});
}else{Q._resolve(R);
}},error:function(Q){return new g(Q);
},_resolve:function(R){if(R===undefined){R=null;
}if(Array.isArray(R)){R=this.asMatrix(R);
}var Q=this.formula;
Q.value=R;
if(this.ss.onFormula(Q)&&this.callback){this.callback.call(Q,R);
}},resolveCells:function(Q,T){var S=this,V=[];
(function X(Z){for(var aa=0;
aa<Z.length;
++aa){var ab=Z[aa];
if(ab instanceof J){R(S.getRefCells(ab));
}if(Array.isArray(ab)){X(ab);
}}}(Q));
if(!V.length){return T.call(S);
}for(var Y=V.length,W=0;
W<V.length;
++W){U(V[W]);
}function U(Z){Z.exec(S.ss,function(){if(!--Y){T.call(S);
}},S);
}function R(Z){for(var ab=0;
ab<Z.length;
++ab){var aa=Z[ab];
if(aa.formula){V.push(aa.formula);
}}return true;
}},cellValues:function(Q,R){var T=[];
for(var S=0;
S<Q.length;
++S){var U=Q[S];
if(U instanceof J){U=this.getRefData(U);
T=T.concat(U);
}else{if(Array.isArray(U)){T=T.concat(this.cellValues(U));
}else{if(U instanceof y){T=T.concat(this.cellValues(U.data));
}else{T.push(U);
}}}}if(R){return R.apply(this,T);
}return T;
},fetchName:function(S,Q){var R=this.formula;
var U=this.ss.nameValue(S,R.sheet,R.row,R.col);
if(U instanceof s){U=U.clone(R.sheet,R.row,R.col,true);
var T=new L.ValidationFormulaContext(this.ss.workbook);
U.exec(T,Q,this);
}else{if(U instanceof J){U=U.absolute(R.row,R.col);
if(!U.sheet){U.sheet=R.sheet;
}}Q(U==null?new g("NAME"):U);
}},force:function(Q){if(Q instanceof J){return this.getRefData(Q);
}return Q;
},func:function(T,R,Q){T=T.toLowerCase();
var S=t[T];
if(S){return S.call(this,R,Q);
}R(new g("NAME"));
},bool:function(Q){if(Q instanceof J){Q=this.getRefData(Q);
}if(typeof Q=="string"){return Q.toLowerCase()=="true";
}if(typeof Q=="number"){return Q!==0;
}if(typeof Q=="boolean"){return Q;
}return Q!=null;
},asMatrix:function(T){if(T instanceof y){return T;
}var V=this;
if(T instanceof I){var W=T.topLeft;
var X=W.row,R=W.col;
var Q=V.getRefCells(T);
var S=new y(V);
if(isFinite(T.width())){S.width=T.width();
}if(isFinite(T.height())){S.height=T.height();
}if(!isFinite(X)){X=0;
}if(!isFinite(R)){R=0;
}Q.forEach(function(Y){S.set(Y.row-X,Y.col-R,Y.value);
});
return S;
}if(Array.isArray(T)&&T.length>0){var S=new y(V),U=0;
T.forEach(function(aa){var Y=0;
var Z=1;
aa.forEach(function(ab){var ac=ab instanceof I;
if(ab instanceof J&&!ac){ab=V.getRefData(ab);
}if(ac||Array.isArray(ab)){ab=V.asMatrix(ab);
}if(ab instanceof y){ab.each(function(ae,af,ad){S.set(U+af,Y+ad,ae);
});
Z=Math.max(Z,ab.height);
Y+=ab.width;
}else{S.set(U,Y++,ab);
}});
U+=Z;
});
return S;
}},getRefCells:function(S,R){var Q=this.formula;
return this.ss.getRefCells(S,R,Q.sheet,Q.row,Q.col);
},getRefData:function(R){var Q=this.formula;
return this.ss.getData(R,Q.sheet,Q.row,Q.col);
},workbook:function(){return this.ss.workbook;
}});
var y=i.extend({init:function y(Q){this.context=Q;
this.height=0;
this.width=0;
this.data=[];
},clone:function(){var Q=new y(this.context);
Q.height=this.height;
Q.width=this.width;
Q.data=this.data.map(function(R){return R.slice();
});
return Q;
},get:function(S,Q){var R=this.data[S];
var T=R?R[Q]:null;
return T instanceof J?this.context.getRefData(T):T;
},set:function(T,Q,R){var S=this.data[T];
if(S==null){S=this.data[T]=[];
}S[Q]=R;
if(T>=this.height){this.height=T+1;
}if(Q>=this.width){this.width=Q+1;
}},each:function(R,S){for(var T=0;
T<this.height;
++T){for(var Q=0;
Q<this.width;
++Q){var U=this.get(T,Q);
if(S||U!=null){U=R.call(this.context,U,T,Q);
if(U!==undefined){return U;
}}}}},map:function(Q,R){var S=new y(this.context);
this.each(function(U,V,T){S.set(V,T,Q.call(this,U,V,T));
},R);
return S;
},eachRow:function(Q){for(var R=0;
R<this.height;
++R){var S=Q.call(this.context,R);
if(S!==undefined){return S;
}}},eachCol:function(R){for(var Q=0;
Q<this.width;
++Q){var S=R.call(this.context,Q);
if(S!==undefined){return S;
}}},mapRow:function(Q){var R=new y(this.context);
this.eachRow(function(S){R.set(S,0,Q.call(this.context,S));
});
return R;
},mapCol:function(Q){var R=new y(this.context);
this.eachCol(function(S){R.set(0,S,Q.call(this.context,S));
});
return R;
},toString:function(){return JSON.stringify(this.data);
},transpose:function(){var Q=new y(this.context);
this.each(function(S,T,R){Q.set(R,T,S);
});
return Q;
},unit:function(T){this.width=this.height=T;
var Q=this.data=new Array(T);
for(var R=T;
--R>=0;
){var U=Q[R]=new Array(T);
for(var S=T;
--S>=0;
){U[S]=R==S?1:0;
}}return this;
},multiply:function(R){var Q=this,U=new y(Q.context);
for(var V=0;
V<Q.height;
++V){for(var S=0;
S<R.width;
++S){var W=0;
for(var T=0;
T<Q.width;
++T){var X=Q.get(V,T);
var Y=R.get(T,S);
if(typeof X!="number"||typeof Y!="number"){throw new g("VALUE");
}W+=X*Y;
}U.set(V,S,W);
}}return U;
},adds:function(R,V){var Q=this,T=new y(Q.context);
var W=V?-1:1;
for(var U=0;
U<Q.height;
++U){for(var S=0;
S<Q.width;
++S){var X=Q.get(U,S),Y=R.get(U,S);
T.set(U,S,X+W*Y);
}}return T;
},determinant:function(){var Q=this.clone().data;
var W=Q.length;
var S=1,R,V,T,U;
for(R=0;
R<W;
R++){for(V=R;
V<W&&!Q[V][R];
V++){}if(V==W){return 0;
}if(V!=R){S=-S;
for(U=R;
U<W;
U++){var X=Q[R][U];
Q[R][U]=Q[V][U];
Q[V][U]=X;
}}for(T=R+1;
T<W;
T++){for(U=R+1;
U<W;
U++){Q[T][U]-=Q[R][U]*Q[T][R]/Q[R][R];
}}S*=Q[R][R];
}return S;
},inverse:function(){var X=this.width;
var W=this.augment(new y(this.context).unit(X));
var Q=W.data;
var Y;
for(var V=0;
V<X;
++V){var T=a(V,X,function(Z){return Q[Z][V];
});
if(!Q[T][V]){return null;
}if(V!=T){Y=Q[V];
Q[V]=Q[T];
Q[T]=Y;
}for(var S=V+1;
S<X;
++S){for(var U=V+1;
U<2*X;
++U){Q[S][U]-=Q[V][U]*Q[S][V]/Q[V][V];
}Q[S][V]=0;
}}for(var S=0;
S<X;
++S){for(var R=Q[S][S],U=0;
U<2*X;
++U){Q[S][U]/=R;
}}for(var V=X;
--V>=0;
){for(var S=V;
--S>=0;
){if(Q[S][V]){for(var U=2*X;
--U>=X;
){Q[S][U]-=Q[V][U]*Q[S][V];
}}}}return W.slice(0,X,X,X);
},augment:function(Q){var S=this.clone(),R=S.width;
Q.each(function(V,U,T){S.set(U,T+R,V);
});
return S;
},slice:function(V,Q,R,W){var U=new y(this.context);
for(var S=0;
S<R;
++S){for(var T=0;
T<W;
++T){U.set(S,T,this.get(V+S,Q+T));
}}return U;
}});
function a(S,Q,R){var T=R(S),U=S;
while(++S<Q){var V=R(S);
if(V>T){T=V;
U=S;
}}return U;
}var s=i.extend({init:function s(T,R,S,V,U,Q){this.refs=T;
this.handler=R;
this.print=S;
this.absrefs=null;
this.sheet=V;
this.row=U;
this.col=Q;
this.onReady=[];
this.pending=false;
},clone:function(V,U,Q,R){var S=V.toLowerCase();
var T=this.refs;
if(R||S!=this.sheet.toLowerCase()){T=T.map(function(W){if(!W.hasSheet()&&(!W.sheet||W.sheet.toLowerCase()!=S)){W=W.clone().setSheet(V);
}return W;
});
}return new s(T,this.handler,this.print,V,U,Q);
},resolve:function(Q){this.pending=false;
this.onReady.forEach(function(R){R(Q);
});
},exec:function(T,Q,S){if("value" in this){if(Q){Q(this.value);
}}else{if(Q){this.onReady.push(Q);
}var R=new k(this.resolve,this,T,S);
while(S){if(S.formula===this){this.pending=false;
R.resolve(new g("CIRCULAR"));
return;
}S=S.parent;
}if(this.pending){return;
}this.pending=true;
if(!this.absrefs){this.absrefs=this.refs.map(function(U){return U.absolute(this.row,this.col);
},this);
}this.handler.call(R);
}},reset:function(){this.onReady=[];
this.pending=false;
delete this.value;
},renameSheet:function(R,Q){R=R.toLowerCase();
this.absrefs=null;
if(this.sheet.toLowerCase()==R){this.sheet=Q;
}this.refs.forEach(function(S){S.renameSheet(R,Q);
});
},adjust:function(Q,Y,Z,R){Q=Q.toLowerCase();
var U=this.row;
var S=this.col;
var V=this.sheet.toLowerCase();
var T=false;
if(V==Q){if(Y=="row"&&U>=Z){this.row+=R;
T=true;
}if(Y=="col"&&S>=Z){this.col+=R;
T=true;
}}var X=this.row;
var W=this.col;
this.absrefs=null;
this.refs=this.refs.map(function(aa){if(aa===C){return aa;
}if(aa.sheet.toLowerCase()!=Q){if(T){if(Y=="row"&&U>=Z){aa=aa.relative(R,0);
}if(Y=="col"&&S>=Z){aa=aa.relative(0,R);
}}return aa;
}return aa.adjust(U,S,X,W,Y=="row",Z,R);
},this);
},toString:function(){return this.print(this.row,this.col);
}});
var t=Object.create(null);
t["if"]=function(R,Q){var U=this;
var S=Q[0],V=Q[1],T=Q[2];
this.resolveCells([S],function(){var W=U.asMatrix(S);
if(W){V(function(X){T(function(Y){var aa=U.asMatrix(X);
var Z=U.asMatrix(Y);
R(W.map(function(ad,ac,ab){if(ad instanceof g){return ad;
}else{if(U.bool(ad)){return aa?aa.get(ac,ab):X;
}else{return Z?Z.get(ac,ab):Y;
}}}));
});
});
}else{S=this.force(S);
if(S instanceof g){R(S);
}else{if(U.bool(S)){V(R);
}else{T(R);
}}}});
};
t.f=function(Q){Q((1+Math.sqrt(5))/2);
};
function j(Z,Q){var R="function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ";
var ae="function resolve(args, callback) { var toResolve = [], i = 0; ";
var ad,X,ac="'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; ",ab=false;
var S=false,aa=false;
ac+=Q.map(T).join("");
ac+="if (i < args.length) return new CalcError('N/A'); ";
ac+="return xargs; } ";
R+="return { args: xargs, width: width, height: height, arrays: arrays }; } ";
var V;
if(ab){ae+="this.resolveCells(toResolve, callback); } ";
V=new Function("CalcError",ac+ae+R+" return { resolve: resolve, check: check, arrayArgs: arrayArgs };");
}else{V=new Function("CalcError",ac+" return { check: check };");
}V=V(g);
if(!aa){delete V.arrayArgs;
}return V;
function T(ak){ad=ak[0];
var ah="{ ";
if(Array.isArray(ad)){R+="while (i < args.length) { ";
ae+="while (i < args.length) { ";
ah+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";
ah+="while (i < args.length) { ";
ah+=ak.map(T).join("");
ah+="} ";
ah+="xargs = stack.pop(); ";
ae+="} ";
R+="} ";
}else{if(ad=="+"){R+="while (i < args.length) { ";
ae+="while (i < args.length) { ";
ah+="xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ";
ah+="do { ";
ah+=ak.slice(1).map(T).join("");
ah+="} while (i < args.length); ";
ah+="xargs = stack.pop(); ";
ae+="} ";
R+="} ";
}else{if(ad=="?"){ah+="if (!("+U(ak[1])+")) return new CalcError(err); ";
}else{var aj=ak[1];
if(Array.isArray(aj)&&/^#?collect/.test(aj[0])){var ai=aj[2];
W();
ah+="try {var $"+ad+" = this.cellValues(args.slice(i";
if(ai){ah+=", i + "+ai;
}ah+=")).filter(function($"+ad+"){ ";
if(aj[0]=="collect"){ah+="if ($"+ad+" instanceof CalcError) throw $"+ad+"; ";
}ah+="return "+U(aj[1])+"; }, this); ";
if(ai){ah+="i += "+ai+"; ";
}else{ah+="i = args.length; ";
}ah+="xargs.push($"+ad+")} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ";
ae+="toResolve.push(args.slice(i)); ";
}else{if(aj=="rest"){ah+="xargs.push(args.slice(i)); i = args.length; ";
}else{if(S=/^\*/.test(ad)){aa=true;
ad=ad.substr(1);
}ah+="var $"+ad+" = args[i++]; ";
var ag=false;
if(/!$/.test(aj)){aj=aj.substr(0,aj.length-1);
ag=true;
}else{ah+="if ($"+ad+" instanceof CalcError) return $"+ad+"; ";
}ah+=af(aj,ag)+"xargs.push($"+ad+"); ";
}}}}}ah+="} ";
return ah;
}function W(){if(X){return"$"+ad+"";
}ab=true;
X=true;
ae+="toResolve.push(args[i++]); ";
return"($"+ad+" = this.force($"+ad+"))";
}function Y(){return"((typeof "+W()+" == 'number') || (typeof $"+ad+" == 'boolean') || (typeof $"+ad+" == 'string' && !/^(?:=|true|false)/i.test($"+ad+") ? (tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $"+ad+"), /^date|number|percent$/.test(tmp.type) ? ($"+ad+" = +tmp.value, true) : false) : false))";
}function af(ai,ag){X=false;
var ah="if (!("+U(ai)+")) { ";
if(X&&!ag){ah+=" if ($"+ad+" instanceof CalcError) return $"+ad+"; ";
}ah+="return new CalcError(err); } ";
if(!X){ae+="i++; ";
}if(S){R+="var $"+ad+" = this.asMatrix(args[i]); if ($"+ad+") { xargs.push($"+ad+"); width = Math.max(width, $"+ad+".width); height = Math.max(height, $"+ad+".height); arrays.push(true) } else { xargs.push(args[i]); arrays.push(false); } i++; ";
}else{R+="xargs.push(args[i++]); arrays.push(false); ";
}return ah;
}function U(ah){if(Array.isArray(ah)){if(ah[0]=="or"){return"("+ah.slice(1).map(U).join(") || (")+")";
}if(ah[0]=="and"){return"("+ah.slice(1).map(U).join(") && (")+")";
}if(ah[0]=="values"){return"("+ah.slice(1).map(function(ai){return W()+" === "+ai;
}).join(") || (")+")";
}if(ah[0]=="null"){return"("+U("null")+" ? (($"+ad+" = "+ah[1]+"), true) : false)";
}if(ah[0]=="between"||ah[0]=="[between]"){return"("+W()+" >= "+ah[1]+" && $"+ad+" <= "+ah[2]+" ? true : ((err = 'NUM'), false))";
}if(ah[0]=="(between)"){return"("+W()+" > "+ah[1]+" && $"+ad+" < "+ah[2]+" ? true : ((err = 'NUM'), false))";
}if(ah[0]=="(between]"){return"("+W()+" > "+ah[1]+" && $"+ad+" <= "+ah[2]+" ? true : ((err = 'NUM'), false))";
}if(ah[0]=="[between)"){return"("+W()+" >= "+ah[1]+" && $"+ad+" < "+ah[2]+" ? true : ((err = 'NUM'), false))";
}if(ah[0]=="assert"){var ag=ah[2]||"N/A";
return"(("+ah[1]+") ? true : (err = "+JSON.stringify(ag)+", false))";
}if(ah[0]=="not"){return"!("+U(ah[1])+")";
}throw new Error("Unknown array type condition: "+ah[0]);
}if(ah=="number"||ah=="datetime"){return Y();
}if(ah=="integer"||ah=="date"){return"("+Y()+" && (($"+ad+" |= 0), true))";
}if(ah=="divisor"){return"("+Y()+" && ($"+ad+" == 0 ? ((err = 'DIV/0'), false) : true))";
}if(ah=="number+"){return"("+Y()+" && ($"+ad+" >= 0 ? true : ((err = 'NUM'), false)))";
}if(ah=="integer+"){return"("+Y()+" && (($"+ad+" |= 0) >= 0 ? true : ((err = 'NUM'), false)))";
}if(ah=="number++"){return"("+Y()+" && ($"+ad+" > 0 ? true : ((err = 'NUM'), false)))";
}if(ah=="integer++"){return"("+Y()+" && (($"+ad+" |= 0) > 0 ? true : ((err = 'NUM'), false)))";
}if(ah=="string"){return"((typeof "+W()+" == 'string' || typeof $"+ad+" == 'boolean' || typeof $"+ad+" == 'number') ? ($"+ad+" += '', true) : false)";
}if(ah=="boolean"){return"(typeof "+W()+" == 'boolean')";
}if(ah=="logical"){return"(typeof "+W()+" == 'boolean' || (typeof $"+ad+" == 'number' ? ($"+ad+" = !!$"+ad+", true) : false))";
}if(ah=="matrix"){W();
return"((m = this.asMatrix($"+ad+")) ? ($"+ad+" = m) : false)";
}if(ah=="#matrix"){return"((m = this.asMatrix($"+ad+")) ? ($"+ad+" = m) : false)";
}if(ah=="ref"){return"($"+ad+" instanceof kendo.spreadsheet.Ref)";
}if(ah=="area"){return"($"+ad+" instanceof kendo.spreadsheet.CellRef || $"+ad+" instanceof kendo.spreadsheet.RangeRef)";
}if(ah=="cell"){return"($"+ad+" instanceof kendo.spreadsheet.CellRef)";
}if(ah=="null"){return"("+W()+" == null)";
}if(ah=="anyvalue"){return"("+W()+" != null && i <= args.length)";
}if(ah=="forced"){return"("+W()+", i <= args.length)";
}if(ah=="anything"){return"(i <= args.length)";
}if(ah=="blank"){return"("+W()+" == null || $"+ad+" === '')";
}throw new Error("Can't check for type: "+ah);
}}function P(T,S,Q){if(Q instanceof g){return Q;
}try{return S.apply(T,Q);
}catch(R){if(R instanceof g){return R;
}else{throw R;
}}}function x(S,T,R,Q){return function(V,U){function W(){if(Q){var ac=Q.call(this,U);
U=ac.args;
if(ac.width>0&&ac.height>0){var aa=new y(this);
for(var ab=0;
ab<ac.height;
++ab){for(var X=0;
X<ac.width;
++X){var ad=[];
for(var Y=0;
Y<U.length;
++Y){if(ac.arrays[Y]){var Z=U[Y];
ad[Y]=Z.get(ab%Z.height,X%Z.width);
}else{ad[Y]=U[Y];
}}ad=R.call(this,ad);
aa.set(ab,X,P(this,S,ad));
}}return V(aa);
}}var ad=R.call(this,U);
V(P(this,S,ad));
}if(T){T.call(this,U,W);
}else{W.call(this);
}};
}function w(S,T,R,Q){return function(V,U){function W(){if(Q){var ae=Q.call(this,U);
U=ae.args;
if(ae.width>0&&ae.height>0){var ac=new y(this);
var Y=ae.width*ae.height;
var ab=function(ah,ag){return function(ai){ac.set(ah,ag,ai);
--Y;
if(Y===0){return V(ac);
}};
};
for(var ad=0;
ad<ae.height&&Y>0;
++ad){for(var X=0;
X<ae.width&&Y>0;
++X){var af=[];
for(var Z=0;
Z<U.length;
++Z){if(ae.arrays[Z]){var aa=U[Z];
af[Z]=aa.get(ad%aa.height,X%aa.width);
}else{af[Z]=U[Z];
}}af=R.call(this,af);
if(af instanceof g){ac.set(ad,X,af);
--Y;
if(Y===0){return V(ac);
}}else{af.unshift(ab(ad,X));
S.apply(this,af);
}}}return;
}}var ae=R.call(this,U);
if(ae instanceof g){V(ae);
}else{ae.unshift(V);
S.apply(this,ae);
}}if(T){T.call(this,U,W);
}else{W.call(this);
}};
}function q(R,Q){R=R.toLowerCase();
t[R]=Q;
return{args:function(S,V){var T=j(R,S);
if(V){if(T.arrayArgs){console.log(T.arrayArgs.toString());
}if(T.resolve){console.log(T.resolve.toString());
}if(T.check){console.log(T.check.toString());
}}var U=t[R]=x(Q,T.resolve,T.check,T.arrayArgs);
U.kendoSpreadsheetArgs=S;
return this;
},argsAsync:function(S,V){var T=j(R,S);
if(V){if(T.arrayArgs){console.log(T.arrayArgs.toString());
}if(T.resolve){console.log(T.resolve.toString());
}if(T.check){console.log(T.check.toString());
}}var U=t[R]=w(Q,T.resolve,T.check,T.arrayArgs);
U.kendoSpreadsheetArgs=S;
return this;
}};
}function l(S,R,Q){R++;
return(1461*(S+4800+((R-14)/12|0))/4|0)+(367*(R-2-12*((R-14)/12|0))/12|0)-(3*((S+4900+((R-14)/12|0))/100|0)/4|0)+Q-32075;
}function v(T){var U,W,S,R,V,Q,X;
U=T+68569;
W=4*U/146097|0;
U=U-((146097*W+3)/4|0);
R=4000*(U+1)/1461001|0;
U=U-(1461*R/4|0)+31;
S=80*U/2447|0;
Q=U-(2447*S/80|0);
U=S/11|0;
V=S+2-12*U;
X=100*(W-49)+R+U;
V--;
return{year:X,month:V,date:Q,day:(T+1)%7,ord:E[u(X)][V]+Q};
}var d=l(1900,0,-1);
var n=[31,28,31,30,31,30,31,31,30,31,30,31];
var E=[[0,31,59,90,120,151,181,212,243,273,304,334],[0,31,60,91,121,152,182,213,244,274,305,335]];
function u(Q){if(Q%4){return 0;
}if(Q%100){return 1;
}if(Q%400){return 0;
}return 1;
}function p(Q){return u(Q)?366:365;
}function o(R,Q){return u(R)&&Q==1?29:n[Q];
}function N(Q){return v((Q|0)+d);
}function F(S,R,Q){return l(S,R,Q)-d;
}var B=60*1000;
var A=60*B;
var z=24*A;
function O(V){var Q=V-(V|0);
if(Q<0){Q++;
}var T=Math.round(z*Q);
var R=Math.floor(T/A);
T-=R*A;
var S=Math.floor(T/B);
T-=S*B;
var U=Math.floor(T/1000);
T-=U*1000;
return{hours:R,minutes:S,seconds:U,milliseconds:T};
}function K(R){var Q=N(R),S=O(R);
return new Date(Q.year,Q.month,Q.date,S.hours,S.minutes,S.seconds,S.milliseconds);
}function G(Q,R,T,S){return(Q+(R+(T+S/1000)/60)/60)/24;
}function m(Q){var R=G(Q.getHours(),Q.getMinutes(),Q.getSeconds(),Q.getMilliseconds());
Q=F(Q.getFullYear(),Q.getMonth(),Q.getDate());
if(Q<0){return Q-1+R;
}else{return Q+R;
}}function H(Q){return kendo.parseDate(Q)||kendo.parseDate(Q,["MMMM dd yyyy","MMMM dd yy","MMM dd yyyy","MMM dd yy","dd MMMM yyyy","dd MMMM yy","dd MMM yyyy","dd MMM yy","MMMM dd, yyyy","MMMM dd, yy","MMM dd, yyyy","MMM dd, yy","MMMM dd","MMM dd","MMMM yyyy","MMM yyyy","dd MMMM","dd MMM"]);
}r.CalcError=g;
r.Formula=s;
r.Matrix=y;
r.packDate=F;
r.unpackDate=N;
r.packTime=G;
r.unpackTime=O;
r.serialToDate=K;
r.dateToSerial=m;
r.daysInMonth=o;
r.isLeapYear=u;
r.daysInYear=p;
r.parseDate=H;
L.dateToNumber=m;
L.numberToDate=K;
L.defineFunction=q;
L.CalcError=g;
r.defineFunction=q;
r.defineAlias=function(Q,R){var S=t[R];
if(!S){throw new Error("Function "+R+" is not yet defined");
}if(!S.kendoSpreadsheetAliases){S.kendoSpreadsheetAliases=[R];
}S.kendoSpreadsheetAliases.push(Q);
t[Q]=S;
};
r.FUNCS=t;
var D=["or","number",["null",0]];
var c=[["*a",D],["*b",D]];
var b=[["*a",["or","anyvalue",["null",0]]],["*b",["or","anyvalue",["null",0]]]];
q("binary+",function(Q,R){return Q+R;
}).args(c);
q("binary-",function(Q,R){return Q-R;
}).args(c);
q("binary*",function(Q,R){return Q*R;
}).args(c);
q("binary/",function(Q,R){return Q/R;
}).args([["*a",D],["*b","divisor"]]);
q("binary^",function(Q,R){return Math.pow(Q,R);
}).args(c);
q("binary&",function(Q,R){if(Q==null){Q="";
}if(R==null){R="";
}return""+Q+R;
}).args([["*a",["or","number","string","boolean","null"]],["*b",["or","number","string","boolean","null"]]]);
q("binary=",function(Q,R){return Q===R;
}).args(b);
q("binary<>",function(Q,R){return Q!==R;
}).args(b);
q("binary<",e(function(Q,R){return Q<R;
})).args(b);
q("binary<=",e(function(Q,R){return Q<=R;
})).args(b);
q("binary>",e(function(Q,R){return Q>R;
})).args(b);
q("binary>=",e(function(Q,R){return Q>=R;
})).args(b);
q("unary+",function(Q){return Q;
}).args([["*a",D]]);
q("unary-",function(Q){return -Q;
}).args([["*a",D]]);
q("unary%",function(Q){return Q/100;
}).args([["*a",D]]);
q("binary:",function(Q,R){return new I(Q,R).setSheet(Q.sheet||this.formula.sheet,Q.hasSheet());
}).args([["a","cell"],["b","cell"]]);
q("binary,",function(Q,R){return new M([Q,R]);
}).args([["a","ref"],["b","ref"]]);
q("binary ",function(Q,R){return Q.intersect(R);
}).args([["a","ref"],["b","ref"]]);
q("not",function(Q){return !this.bool(Q);
}).args([["*a",["or","anyvalue",["null",0]]]]);
q("isblank",function(Q){if(Q instanceof h){Q=this.getRefData(Q);
return Q==null;
}return false;
}).args([["*value","anything!"]]);
q("iserror",function(Q){return Q instanceof g;
}).args([["*value","forced!"]]);
q("iserr",function(Q){return Q instanceof g&&Q.code!="N/A";
}).args([["*value","forced!"]]);
q("isna",function(Q){return Q instanceof g&&Q.code=="N/A";
}).args([["*value","forced!"]]);
q("islogical",function(Q){return typeof Q=="boolean";
}).args([["*value","forced!"]]);
q("isnontext",function(Q){return typeof Q!="string";
}).args([["*value","forced!"]]);
q("istext",function(Q){return typeof Q=="string";
}).args([["*value","forced!"]]);
q("isnumber",function(Q){return typeof Q=="number";
}).args([["*value","forced!"]]);
q("isref",function(Q){return Q instanceof h||Q instanceof I;
}).args([["*value","anything!"]]);
t[",getname"]=function(R,Q){this.fetchName(Q[0],R);
};
function e(Q){return function(R,S){if(typeof R=="string"&&typeof S!="string"){S=S==null?"":S+"";
}if(typeof R!="string"&&typeof S=="string"){R=R==null?"":R+"";
}if(typeof R=="number"&&S==null){S=0;
}if(typeof S=="number"&&R==null){R=0;
}if(typeof R=="string"&&typeof S=="string"){R=R.toLowerCase();
S=S.toLowerCase();
}if(typeof S==typeof R){return Q(R,S);
}else{return new g("VALUE");
}};
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/validation",["spreadsheet/runtime"],b);
}(function(){var a=kendo.jQuery;
if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var g=kendo.spreadsheet;
var f={};
g.validation=f;
var b=g.calc;
var c=kendo.Class;
var h="_matrix({0})";
var e='DATEVALUE("{0}")';
b.runtime.defineFunction("_matrix",function(j){return j;
}).args([["m","matrix"]]);
function d(o,n,j,p){var q;
var k;
var l;
var m;
if(typeof p==="string"){p=JSON.parse(p);
}if(p.from){if(p.dataType==="list"&&!p.fromIsListValue){p.from=kendo.format(h,p.from);
p.fromIsListValue=true;
}if(p.dataType==="date"){l=b.runtime.parseDate(p.from);
if(l){p.from=kendo.format(e,p.from);
p.fromIsDateValue=true;
}}p.from=b.compile(b.parseFormula(o,n,j,p.from));
}if(p.to){if(p.dataType==="date"){m=b.runtime.parseDate(p.to);
if(m){p.to=kendo.format(e,p.to);
p.toIsDateValue=true;
}}p.to=b.compile(b.parseFormula(o,n,j,p.to));
}if(p.dataType=="custom"){k=f.validationComparers.custom;
}else{if(p.dataType=="list"){k=f.validationComparers.list;
}else{k=f.validationComparers[p.comparerType];
}}if(!k){throw kendo.format("'{0}' comparer is not implemented.",p.comparerType);
}q=function(t){var s=this.to&&this.to_value?this.to_value:undefined;
if(t===null||t===""){if(this.allowNulls){this.value=true;
}else{this.value=false;
}}else{if(this.dataType=="custom"){this.value=k(t,this.from_value,s);
}else{if(this.dataType=="list"){var r=this._getListData();
this.value=k(t,r,s);
}else{this.value=k(t,this.from_value,s);
}}}return this.value;
};
return new kendo.spreadsheet.validation.Validation(a.extend(p,{handler:q,sheet:o,row:n,col:j}));
}var i=c.extend({init:function i(j){this.handler=j.handler;
this.from=j.from;
this.to=j.to;
this.dataType=j.dataType;
this.comparerType=j.comparerType;
this.type=j.type?j.type:"warning";
this.allowNulls=j.allowNulls?true:false;
this.fromIsDateValue=j.fromIsDateValue?true:false;
this.toIsDateValue=j.toIsDateValue?true:false;
this.showButton=j.showButton;
this.fromIsListValue=j.fromIsListValue?true:false;
this.sheet=j.sheet;
this.row=j.row;
this.col=j.col;
if(j.tooltipMessageTemplate){this.tooltipMessageTemplate=j.tooltipMessageTemplate;
}if(j.tooltipTitleTemplate){this.tooltipTitleTemplate=j.tooltipTitleTemplate;
}if(j.messageTemplate){this.messageTemplate=j.messageTemplate;
}if(j.titleTemplate){this.titleTemplate=j.titleTemplate;
}},_formatMessages:function(l){var m=this.from?this.from_value:"";
var o=this.to?this.to_value:"";
var n=this.from?this.from.toString():"";
var p=this.to?this.to.toString():"";
var k=this.dataType;
var q=this.type;
var j=this.comparerType;
return kendo.format(l,m,o,n,p,k,q,j);
},_setMessages:function(){this.title="";
this.message="";
if(this.tooltipTitleTemplate){this.tooltipTitle=this._formatMessages(this.tooltipTitleTemplate);
}if(this.tooltipMessageTemplate){this.tooltipMessage=this._formatMessages(this.tooltipMessageTemplate);
}if(this.titleTemplate){this.title=this._formatMessages(this.titleTemplate);
}if(this.messageTemplate){this.message=this._formatMessages(this.messageTemplate);
}},_getListData:function(){if(!this.from_value||!this.from_value.data){return[];
}var k=this.from_value.data;
var m;
var n;
var l=[];
for(m=0;
m<k.length;
m++){var j=k[m];
if(j){for(n=0;
n<j.length;
n++){l.push(j[n]);
}}}return l;
},clone:function(m,l,j){var k=this._getOptions();
if(k.from){k.from=k.from.clone(m,l,j);
}if(k.to){k.to=k.to.clone(m,l,j);
}return new i(a.extend(k,{handler:this.handler},{sheet:m,row:l,col:j}));
},exec:function(p,m,l,k){var o=this;
function n(q){if(q instanceof kendo.spreadsheet.Ref){q=p.getData(q);
if(Array.isArray(q)){q=q[0];
}}return q;
}var j=function(q){o.from_value=n(q);
o.value=o.handler.call(o,m,l);
o._setMessages();
if(k){k(o.value);
}};
if(o.to){o.to.exec(p,function(q){o.to_value=n(q);
o.from.exec(p,j);
});
}else{o.from.exec(p,j);
}},reset:function(){if(this.from){this.from.reset();
}if(this.to){this.to.reset();
}delete this.value;
},adjust:function(j,n,o,k){if(this.from){this.from.adjust(j,n,o,k);
}if(this.to){this.to.adjust(j,n,o,k);
}if(this.sheet.toLowerCase()==j.toLowerCase()){var m=this.row;
var l=this.col;
switch(n){case"row":if(m>=o){this.row+=k;
}break;
case"col":if(l>=o){this.col+=k;
}break;
}}},toJSON:function(){var j=this._getOptions();
if(j.from){j.from=j.from.toString();
if(j.dataType==="list"){j.from=j.from.replace(/^_matrix\((.*)\)$/i,"$1");
delete j.fromIsListValue;
}if(j.dataType==="date"){if(this.fromIsDateValue){j.from=j.from.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");
delete j.fromIsDateValue;
}}}if(j.to){j.to=j.to.toString();
if(j.dataType==="date"){if(this.toIsDateValue){j.to=j.to.replace(/^DATEVALUE\("(.*)"\)$/i,"$1");
delete j.toIsDateValue;
}}}return j;
},_getOptions:function(){return{from:this.from,to:this.to,dataType:this.dataType,type:this.type,comparerType:this.comparerType,row:this.row,col:this.col,sheet:this.sheet,allowNulls:this.allowNulls,fromIsListValue:this.fromIsListValue,fromIsDateValue:this.fromIsDateValue,toIsDateValue:this.toIsDateValue,tooltipMessageTemplate:this.tooltipMessageTemplate,tooltipTitleTemplate:this.tooltipTitleTemplate,messageTemplate:this.messageTemplate,titleTemplate:this.titleTemplate,showButton:this.showButton};
}});
f.compile=d;
f.validationComparers={greaterThan:function(k,j){return k>j;
},lessThan:function(k,j){return k<j;
},between:function(l,j,k){return l>=j&&l<=k;
},equalTo:function(k,j){return k==j;
},notEqualTo:function(k,j){return k!=j;
},greaterThanOrEqualTo:function(k,j){return k>=j;
},lessThanOrEqualTo:function(k,j){return k<=j;
},notBetween:function(l,j,k){return l<j||l>k;
},custom:function(k,j){return j;
},list:function(k,j){return j.indexOf(k)>-1;
}};
f.Validation=i;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sheet",["kendo.core","kendo.color","spreadsheet/runtime","spreadsheet/validation","spreadsheet/references"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var d=b.spreadsheet.RangeRef;
var a=b.spreadsheet.CellRef;
var c=b.spreadsheet.Range;
var e=b.Class.extend({init:function(g){this._sheet=g;
this.selection=b.spreadsheet.FIRSTREF.toRangeRef();
this.originalSelection=b.spreadsheet.FIRSTREF.toRangeRef();
this._activeCell=b.spreadsheet.FIRSTREF.toRangeRef();
this.originalActiveCell=b.spreadsheet.FIRSTREF;
},currentSelectionRange:function(){return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();
},currentOriginalNavigationRange:function(){return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();
},currentNavigationRange:function(){if(this.singleCellSelection()){return this._sheet._sheetRef;
}else{return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();
}},nextNavigationRange:function(){if(!this.singleCellSelection()){this.selectionRangeIndex=this.selection.nextRangeIndex(this.selectionRangeIndex);
}return this.currentNavigationRange();
},previousNavigationRange:function(){if(!this.singleCellSelection()){this.selectionRangeIndex=this.selection.previousRangeIndex(this.selectionRangeIndex);
}return this.currentNavigationRange();
},activeCell:function(g){if(g){this.originalActiveCell=g.first();
this._activeCell=this._sheet.unionWithMerged(g.toRangeRef());
this._sheet.focus(g);
this._sheet.triggerChange({activeCell:true,selection:true});
}return this._activeCell;
},select:function(i,h,g){if(i){if(i.eq(this.originalSelection)){return;
}this.originalSelection=i;
this.selection=h;
if(g!==false){if(i.isCell()){this.activeCell(i);
}else{this.activeCell(this.selection.lastRange().first());
}this.selectionRangeIndex=this.selection.size()-1;
}else{this._sheet.triggerChange({selection:true});
}}return this.selection;
},singleCellSelection:function(){return this._activeCell.eq(this.selection);
}});
var f=b.Observable.extend({init:function(){b.Observable.prototype.init.call(this);
this._reinit.apply(this,arguments);
},_reinit:function(l,h,m,i,j,k){var g=l*h-1;
this._rows=new b.spreadsheet.Axis(l,m);
this._columns=new b.spreadsheet.Axis(h,i);
this._mergedCells=[];
this._frozenRows=0;
this._frozenColumns=0;
this._suspendChanges=false;
this._filter=null;
this._showGridLines=true;
this._gridLinesColor=null;
this._grid=new b.spreadsheet.Grid(this._rows,this._columns,l,h,j,k);
this._sheetRef=this._grid.normalize(b.spreadsheet.SHEETREF);
this._properties=new b.spreadsheet.PropertyBag(g);
this._sorter=new b.spreadsheet.Sorter(this._grid,this._properties.sortable());
this._viewSelection=new e(this);
this._editSelection=new e(this);
this._formulaSelections=[];
},_selectionState:function(){return this._inEdit?this._editSelection:this._viewSelection;
},navigator:function(){if(!this._navigator){this._navigator=new b.spreadsheet.SheetNavigator(this);
}return this._navigator;
},axisManager:function(){if(!this._axisManager){this._axisManager=new b.spreadsheet.AxisManager(this);
}return this._axisManager;
},_name:function(g){if(!g){return this._sheetName;
}this._sheetName=g;
return this;
},name:function(){return this._name();
},_property:function(g,i,h){if(i===undefined){return g();
}else{g(i);
return this.triggerChange(h);
}},_field:function(g,i,h){if(i===undefined){return this[g];
}else{this[g]=i;
return this.triggerChange(h);
}},suspendChanges:function(g){if(g===undefined){return this._suspendChanges;
}this._suspendChanges=g;
return this;
},triggerChange:function(g){if(!this._suspendChanges){this.trigger("change",g);
}return this;
},setDataSource:function(h,g){if(this.dataSourceBinder){this.dataSourceBinder.destroy();
}this.dataSourceBinder=new b.spreadsheet.SheetDataSourceBinder({dataSource:h,sheet:this,columns:g});
this.dataSource=this.dataSourceBinder.dataSource;
},hideColumn:function(g){return this._property(this._columns.hide.bind(this._columns),g,{layout:true});
},unhideColumn:function(g){return this._property(this._columns.unhide.bind(this._columns),g,{layout:true});
},isHiddenColumn:function(g){return this._grid._columns.hidden(g);
},_copyRange:function(m,o){var g=this._grid;
var l=g.rowCount;
var k=g.normalize(m.topLeft);
var j=g.normalize(m.bottomRight);
var i=k.col*l+k.row;
var h=j.col*l+j.row;
var n=o.col*l+o.row;
this._properties.copy(i,h,n);
},_adjustReferences:function(k,m,i,j){this._mergedCells=j.reduce(function(n,o){o=o.adjust(null,null,null,null,k=="row",m,i);
if(o instanceof d){n.push(o);
}return n;
},[]);
if(this._workbook){var g=this._name();
this._workbook._sheets.forEach(function(n){n._forFormulas(function(o){o.adjust(g,k,m,i);
});
n._forValidations(function(o){o.adjust(g,k,m,i);
});
});
this._workbook.adjustNames(g,k=="row",m,i);
}var l=this.select();
l=l.adjust(null,null,null,null,k=="row",m,i);
if(l!==b.spreadsheet.NULLREF){this.select(l);
}var h=k=="col"?this._columns:this._rows;
h.adjust(m,i);
},_forFormulas:function(g){var j=this._properties;
var h=j.get("formula").values();
var i=h.length;
h.forEach(function(k,l){g.call(this,k.value,l,i);
},this);
},_forValidations:function(g){var h=this._properties;
h.get("validation").values().forEach(function(i){g.call(this,i.value);
},this);
},canInsertRow:function(j,g){g=g||1;
var h=this._grid;
var i=this.range(h.rowCount-g,0,g,h.columnCount);
return !i.hasValue();
},insertRow:function(g){if(!this.canInsertRow(g)){throw new Error("Shifting nonblank cells off the worksheet is not supported!");
}this.batch(function(){var l=this._grid;
var j=l.columnCount;
var p=l.rowCount;
var k=this.frozenRows();
if(g<k){this.frozenRows(k+1);
}var m=this._mergedCells.slice();
for(var i=0;
i<j;
i++){var o=new d(new a(g,i),new a(g,i));
var q=l.normalize(o.topLeft);
var h=l.normalize(o.bottomRight);
var n=new d(new a(q.row,q.col),new a(p-2,h.col));
this._copyRange(n,new a(q.row+1,q.col));
new c(o,this).clear();
}this._adjustReferences("row",g,1,m);
},{recalc:true,layout:true,insertRow:{index:g},ref:new d(new a(g,0),new a(Infinity,Infinity))});
this.trigger("insertRow",{index:g});
return this;
},isEnabledRow:function(h){var g=new d(new a(h,0),new a(h,this._grid.columnCount));
return new c(g,this).enable();
},deleteRow:function(g){if(!this.isEnabledRow(g)){return this;
}this.batch(function(){var l=this._grid;
var j=l.columnCount;
var k=this.frozenRows();
if(g<k){this.frozenRows(k-1);
}var m=this._mergedCells.slice();
for(var i=0;
i<j;
i++){var p=new d(new a(g,i),new a(g,i));
new c(p,this).clear();
var q=l.normalize(p.topLeft);
var h=l.normalize(p.bottomRight);
var n=new d(new a(q.row+1,q.col),new a(Infinity,h.col));
this._copyRange(n,q);
var o=l.normalize(n.bottomRight);
new c(new d(o,o),this).clear();
}this._adjustReferences("row",g,-1,m);
},{recalc:true,layout:true,deleteRow:{index:g},ref:new d(new a(g,0),new a(Infinity,Infinity))});
this.trigger("deleteRow",{index:g});
return this;
},insertColumn:function(g){this.batch(function(){var l=this._grid;
var j=l.columnCount;
var k=this.frozenColumns();
if(g<k){this.frozenColumns(k+1);
}var m=this._mergedCells.slice();
for(var i=j;
i>=g;
i--){var o=new d(new a(0,i),new a(Infinity,i));
new c(o,this).clear();
if(i==g){break;
}var p=l.normalize(o.topLeft);
var h=l.normalize(o.bottomRight);
var n=new d(new a(p.row,p.col-1),new a(h.row,h.col-1));
this._copyRange(n,p);
}this._adjustReferences("col",g,1,m);
},{recalc:true,layout:true,insertColumn:{index:g},ref:new d(new a(0,g),new a(Infinity,Infinity))});
return this;
},isEnabledColumn:function(g){var h=new d(new a(0,g),new a(Infinity,g));
return new c(h,this).enable();
},deleteColumn:function(g){if(!this.isEnabledColumn(g)){return this;
}this.batch(function(){var l=this._grid;
var j=l.columnCount;
var k=this.frozenColumns();
if(g<k){this.frozenColumns(k-1);
}var m=this._mergedCells.slice();
for(var i=g;
i<j;
i++){var o=new d(new a(0,i),new a(Infinity,i));
new c(o,this).clear();
if(i==j-1){break;
}var p=l.normalize(o.topLeft);
var h=l.normalize(o.bottomRight);
var n=new d(new a(p.row,p.col+1),new a(h.row,h.col+1));
this._copyRange(n,p);
}this._adjustReferences("col",g,-1,m);
},{recalc:true,layout:true,deleteColumn:{index:g},ref:new d(new a(0,g),new a(Infinity,Infinity))});
return this;
},hideRow:function(g){return this._property(this._rows.hide.bind(this._rows),g,{layout:true});
},unhideRow:function(g){return this._property(this._rows.unhide.bind(this._rows),g,{layout:true});
},isHiddenRow:function(g){return this._grid._rows.hidden(g);
},columnWidth:function(g,h){return this._property(this._columns.value.bind(this._columns,g,g),h,{layout:true});
},rowHeight:function(h,g){return this._property(this._rows.value.bind(this._rows,h,h),g,{layout:true});
},frozenRows:function(g){return this._field("_frozenRows",g,{layout:true});
},frozenColumns:function(g){return this._field("_frozenColumns",g,{layout:true});
},showGridLines:function(g){return this._field("_showGridLines",g,{layout:true});
},gridLinesColor:function(g){return this._field("_gridLinesColor",g,{layout:true});
},_ref:function(k,g,i,h){var j=null;
if(k instanceof b.spreadsheet.Ref){return k;
}if(k instanceof b.spreadsheet.Range){return k._ref.toRangeRef();
}if(typeof k==="string"){j=b.spreadsheet.calc.parseReference(k);
}else{if(!i){i=1;
}if(!h){h=1;
}j=new d(new a(k,g),new a(k+i-1,g+h-1));
}return j;
},range:function(j,g,i,h){return new c(this._ref(j,g,i,h),this);
},forEachMergedCell:function(h,g){var i=false;
if(typeof g==="undefined"){g=h;
i=true;
}this._mergedCells.forEach(function(j){if(i||j.intersects(h)){g(j);
}});
},forEachFilterHeader:function(h,g){var j=false;
if(typeof g==="undefined"){g=h;
j=true;
}if(this._filter){var i=[];
this._filter.ref.forEachColumn(function(l){if(j||l.intersects(h)){i.push(l.topLeft);
}});
this._mergedCells.forEach(function(l){i=i.map(function(m){if(l.intersects(m)){return l;
}return m;
});
});
i.reduce(function k(m,l){if(m.indexOf(l)<0){m.push(l);
}return m;
},[]).forEach(g);
}},forEach:function(k,h){if(!(k instanceof d)){k=this._ref(k);
}var n=this._grid.normalize(k.topLeft);
var g=this._grid.normalize(k.bottomRight);
for(var i=n.col;
i<=g.col;
i++){var l=n.row;
var m=this._grid.index(l,i);
var j=this._grid.index(g.row,i);
this._properties.forEach(m,j,function(o){h(l++,i,o);
});
}},startResizing:function(g){this._initialPosition=g;
this._resizeInProgress=true;
},startAutoFill:function(){this._autoFillInProgress=true;
var g=this.select();
this._autoFillOrigin=g;
this._autoFillDest=g;
this.triggerChange({selection:true});
},updateAutoFill:function(g,j,i,h){this._autoFillDest=g;
this._autoFillPunch=j;
this._autoFillHint=i;
this._autoFillDirection=h;
this.triggerChange({selection:true});
},autoFillRef:function(){return this._autoFillDest;
},autoFillPunch:function(){return this._autoFillPunch;
},autoFillInProgress:function(){return this._autoFillInProgress;
},resizingInProgress:function(){return this._resizeInProgress;
},completeResizing:function(){if(this._resizeInProgress){this._resizeInProgress=false;
var h=this.resizeHintPosition();
if(this._initialPosition&&h){var g=this.resizeHandlePosition();
if(g.col!==-Infinity){this.trigger("commandRequest",{command:"ColumnWidthCommand",options:{target:g.col,value:this.columnWidth(g.col)-(this._initialPosition.x-h.x)}});
}else{this.trigger("commandRequest",{command:"RowHeightCommand",options:{target:g.row,value:this.rowHeight(g.row)-(this._initialPosition.y-h.y)}});
}}else{this.trigger("change",{resize:true});
}}},resizeHandlePosition:function(){return this._resizeHandlePosition;
},resizeHintPosition:function(g){if(g!==undefined){this._resizeHintPosition=g;
this.trigger("change",{resize:true});
}return this._resizeHintPosition;
},removeResizeHandle:function(){if(this._resizeHandlePosition){this._resizeHintPosition=undefined;
this._resizeHandlePosition=undefined;
this._initialPosition=undefined;
this.trigger("change",{resize:true});
}},positionResizeHandle:function(g){this._resizeHandlePosition=g;
this.trigger("change",{resize:true});
},startSelection:function(){this._selectionInProgress=true;
},completeSelection:function(){if(this._selectionInProgress){this._selectionInProgress=false;
this._resizeHintPosition=undefined;
this.trigger("change",{selection:true});
}if(this._autoFillInProgress){this._autoFillInProgress=false;
var g=this._autoFillDest;
var h=this._autoFillOrigin;
if(this._autoFillPunch){this.trigger("commandRequest",{command:"ClearContentCommand",options:{operatingRange:this.range(this._autoFillPunch)}});
}else{if(!g.eq(h)){this.trigger("commandRequest",{command:"AutoFillCommand",options:{operatingRange:this.range(g),origin:this.range(h)}});
}else{this.triggerChange({selection:true});
}}this._autoFillDest=null;
this._autoFillPunch=null;
this._autoFillOrigin=null;
this.select(g);
}},selectionInProgress:function(){return this._selectionInProgress;
},select:function(i,g){var j=this._selectionState();
var h;
if(i){i=this._ref(i);
h=this._grid.isAxis(i)?i:this.unionWithMerged(i);
}return j.select(i,h,g);
},originalSelect:function(){return this._selectionState().originalSelection;
},currentSelectionRange:function(){return this._selectionState().currentSelectionRange();
},currentOriginalSelectionRange:function(){return this._selectionState().currentOriginalNavigationRange();
},currentNavigationRange:function(){return this._selectionState().currentNavigationRange();
},nextNavigationRange:function(){return this._selectionState().nextNavigationRange();
},previousNavigationRange:function(){return this._selectionState().previousNavigationRange();
},selectionRangeIndex:function(){return this._selectionState().selectionRangeIndex;
},activeCell:function(g){return this._selectionState().activeCell(g);
},originalActiveCell:function(){return this._selectionState().originalActiveCell;
},singleCellSelection:function(){return this._selectionState().singleCellSelection();
},unionWithMerged:function(h){var g=this._mergedCells;
return h.map(function(i){return i.toRangeRef().union(g);
});
},trim:function(h){var i=[];
var g=this._grid;
this._properties.forEachProperty(function(j){i.push(g.trim(h,j.list));
});
return this.unionWithMerged(h.topLeft.toRangeRef().union(i));
},focus:function(h){if(h){this._focus=h.toRangeRef();
}else{var g=this._focus;
this._focus=null;
return g;
}},activeCellSelection:function(){return new c(this._grid.normalize(this.activeCell()),this);
},selection:function(){return new c(this._grid.normalize(this._selectionState().selection),this);
},selectedHeaders:function(){var k=this.select();
var j={};
var i={};
var g=false;
var h=false;
k.forEach(function(p){var o;
var r="partial";
var n="partial";
p=p.toRangeRef();
var l=p.bottomRight;
var q=l.col===Infinity;
var m=l.row===Infinity;
if(m){h=true;
n="full";
}if(q){g=true;
r="full";
}if(!m){for(o=p.topLeft.row;
o<=l.row;
o++){if(j[o]!=="full"){j[o]=r;
}}}if(!q){for(o=p.topLeft.col;
o<=l.col;
o++){if(i[o]!=="full"){i[o]=n;
}}}});
return{rows:j,cols:i,allRows:h,allCols:g,all:h&&g};
},isInEditMode:function(g){if(g===undefined){return this._inEdit;
}this._inEdit=g;
if(g){this._editSelection.selection=this._viewSelection.selection.clone();
this._editSelection.originalSelection=this._viewSelection.originalSelection.clone();
this._editSelection._activeCell=this._viewSelection._activeCell.clone();
this._editSelection.originalActiveCell=this._viewSelection.originalActiveCell.clone();
}},_setFormulaSelections:function(g){this._formulaSelections=(g||[]).slice();
this.triggerChange({selection:true});
},_viewActiveCell:function(){return this._viewSelection._activeCell.toRangeRef();
},toJSON:function(){var j={};
var k=this._rows.toJSON("height",j);
var g=this._columns.toJSON("width",{});
var l=this._viewSelection;
var h=[];
this.forEach(b.spreadsheet.SHEETREF,function(p,n,m){if(Object.keys(m).length===0){return;
}if(m.link){h.push({ref:b.spreadsheet.Ref.display(null,p,n),target:m.link});
}var o=j[p];
if(o===undefined){o=k.length;
k.push({index:p});
j[p]=o;
}p=k[o];
m.index=n;
if(p.cells===undefined){p.cells=[];
}if(m.formula){m.formula=m.formula.toString();
}if(m.validation){m.validation=m.validation.toJSON();
}if(m.color){m.color=b.parseColor(m.color).toCss();
}if(m.background){m.background=b.parseColor(m.background).toCss();
}if(m.borderTop&&m.borderTop.color){m.borderTop.color=b.parseColor(m.borderTop.color).toCss();
}if(m.borderBottom&&m.borderBottom.color){m.borderBottom.color=b.parseColor(m.borderBottom.color).toCss();
}if(m.borderRight&&m.borderRight.color){m.borderRight.color=b.parseColor(m.borderRight.color).toCss();
}if(m.borderLeft&&m.borderLeft.color){m.borderLeft.color=b.parseColor(m.borderLeft.color).toCss();
}p.cells.push(m);
});
var i={name:this._name(),rows:k,columns:g,selection:l.selection.toString(),activeCell:l.activeCell().toString(),frozenRows:this.frozenRows(),frozenColumns:this.frozenColumns(),showGridLines:this.showGridLines(),gridLinesColor:this.gridLinesColor(),mergedCells:this._mergedCells.map(function(m){return m.toString();
}),hyperlinks:h};
if(this._sort){i.sort={ref:this._sort.ref.toString(),columns:this._sort.columns.map(function(m){return{index:m.index,ascending:m.ascending};
})};
}if(this._filter){i.filter={ref:this._filter.ref.toString(),columns:this._filter.columns.map(function(m){var n=m.filter.toJSON();
n.index=m.index;
return n;
})};
}return i;
},fromJSON:function(g){this.batch(function(){if(g.name!==undefined){this._name(g.name);
}if(g.frozenColumns!==undefined){this.frozenColumns(g.frozenColumns);
}if(g.frozenRows!==undefined){this.frozenRows(g.frozenRows);
}if(g.columns!==undefined){this._columns.fromJSON("width",g.columns);
}if(g.rows!==undefined){this._rows.fromJSON("height",g.rows);
for(var n=0;
n<g.rows.length;
n++){var o=g.rows[n];
var p=o.index;
if(p===undefined){p=n;
}if(o.cells){for(var j=0;
j<o.cells.length;
j++){var i=o.cells[j];
var k=i.index;
if(k===undefined){k=j;
}if(i.formula){i.formula=this._compileFormula(p,k,i.formula);
}if(i.validation){i.validation=this._compileValidation(p,k,i.validation);
}this._properties.fromJSON(this._grid.index(p,k),i);
}}}}if(g.selection){this._viewSelection.selection=this._viewSelection.originalSelection=this._ref(g.selection);
}if(g.activeCell){var h=this._ref(g.activeCell);
this._viewSelection._activeCell=h.toRangeRef();
this._viewSelection.originalActiveCell=h;
}if(g.mergedCells){g.mergedCells.forEach(function(q){this.range(q).merge();
},this);
}if(g.sort){this._sort={ref:this._ref(g.sort.ref),columns:g.sort.columns.slice(0)};
}if(g.filter){var m=g.filter.ref;
var l=g.filter.columns===undefined?[]:g.filter.columns;
if(!m){b.logToConsole("Dropping filter for sheet '"+g.name+"' due to missing ref");
}else{this._filter={ref:this._ref(m),columns:l.map(function(q){return{index:q.index,filter:b.spreadsheet.Filter.create(q)};
})};
this._refreshFilter();
}}if(g.showGridLines!==undefined){this._showGridLines=g.showGridLines;
}this._gridLinesColor=g.gridLinesColor;
});
this._rows._refresh();
this._columns._refresh();
},formula:function(g){return this._properties.get("formula",this._grid.cellRefIndex(g));
},validation:function(g){return this._properties.get("validation",this._grid.cellRefIndex(g));
},resetFormulas:function(){this._forFormulas(function(g){g.reset();
});
},resetValidations:function(){this._forValidations(function(g){g.reset();
});
},recalc:function(h,g){var k=this._properties.get("formula").values();
var j=k.length,n=0,l=0;
if(!j&&g){return g();
}function m(){n--;
if(l==j&&!n){g();
}}while(l<j){n++;
k[l++].value.exec(h,g?m:null);
}},revalidate:function(g){var h=this;
this._forValidations(function(k){var i=new a(k.row,k.col);
var j=new d(i,i);
k.exec(g,h._get(j,"value"),h._get(j,"format"));
});
},_value:function(i,g,j){var h=this._grid.index(i,g);
if(j!==undefined){this._properties.set("value",h,h,j);
}else{return this._properties.get("value",h);
}},_validation:function(i,g){var h=this._grid.index(i,g);
return this._properties.get("validation",h);
},_compileValidation:function(h,g,i){if(i.from!=null){i.from=(i.from+"").replace(/^=/,"");
}if(i.to!=null){i.to=(i.to+"").replace(/^=/,"");
}return b.spreadsheet.validation.compile(this._name(),h,g,i);
},_compileFormula:function(i,g,h){h=h.replace(/^=/,"");
h=b.spreadsheet.calc.parseFormula(this._name(),i,g,h);
return b.spreadsheet.calc.compile(h);
},_copyValuesInRange:function(n,g,o,k){var h,m,i;
for(h=n.col;
h<=g.col;
h++){m=this._grid.index(n.row,h);
i=this._grid.index(g.row,h);
for(var j=m,l=n.row;
j<=i;
++j,++l){o=o.clone(this._name(),l,h);
this._properties.set(k,j,j,o);
}}return o;
},_set:function(k,j,n){var m=this._grid.normalize(k.topLeft);
var g=this._grid.normalize(k.bottomRight);
var h,l,i;
if(n&&j=="formula"){if(typeof n=="string"){n=this._compileFormula(m.row,m.col,n);
}n=this._copyValuesInRange(m,g,n,"formula");
}else{if(n&&j=="validation"){n=this._compileValidation(m.row,m.col,n);
n=this._copyValuesInRange(m,g,n,"validation");
}else{for(h=m.col;
h<=g.col;
h++){l=this._grid.index(m.row,h);
i=this._grid.index(g.row,h);
this._properties.set(j,l,i,n);
if(j=="formula"){this._properties.set("value",l,i,null);
}}}}},_get:function(i,h){var j=this._grid.normalize(i.topLeft);
var g=this._grid.index(j.row,j.col);
return this._properties.get(h,g);
},batch:function(g,h){var i=this.suspendChanges();
this.suspendChanges(true);
g.call(this);
return this.suspendChanges(i).triggerChange(h);
},_sortBy:function(i,g){var h=null;
g.forEach(function(j){h=this._sorter.sortBy(i,j.index,this._properties.get("value"),j.ascending,h);
},this);
this._sort={ref:i,columns:g};
this._refreshFilter();
this.triggerChange({recalc:true});
},_refreshFilter:function(){if(this._filter){this._filterBy(this._filter.ref,this._filter.columns);
}},_filterBy:function(h,g){this.batch(function(){for(var i=h.topLeft.row;
i<=h.bottomRight.row;
i++){if(this._rows.hidden(i)){this._rows.unhide(i);
}}g.forEach(function(m){var n=h.resize({top:1}).toColumn(m.index);
var k=[];
if(n===b.spreadsheet.NULLREF){return;
}this.forEach(n,function(r,q,p){p.row=r;
k.push(p);
});
m.filter.prepare(k);
for(var l=0;
l<k.length;
l++){var j=k[l];
var o=m.filter.value(j);
if(m.filter.matches(o)===false){this.hideRow(j.row);
}}},this);
this._filter={ref:h,columns:g};
},{layout:true,filter:true});
},filterColumn:function(h){var g=this.filter().ref;
return h.toRangeRef().topLeft.col-g.topLeft.col;
},filter:function(){return this._filter;
},clearFilter:function(g){this._clearFilter(g instanceof Array?g:[g]);
},_clearFilter:function(g){if(this._filter){this.batch(function(){this._filter.columns=this._filter.columns.filter(function(h){return g.indexOf(h.index)<0;
});
this._refreshFilter();
},{layout:true,filter:true});
}},getAxisState:function(){return{rows:this._rows.getState(),columns:this._columns.getState()};
},setAxisState:function(g){this._rows.setState(g.rows);
this._columns.setState(g.columns);
this.triggerChange({layout:true});
},getState:function(){return{rows:this._rows.getState(),columns:this._columns.getState(),mergedCells:this._mergedCells.map(function(g){return g.clone();
}),properties:this._properties.getState()};
},setState:function(g){this._rows.setState(g.rows);
this._columns.setState(g.columns);
this._mergedCells=g.mergedCells;
this._properties.setState(g.properties);
this.triggerChange(b.spreadsheet.ALL_REASONS);
},_merge:function(i){var g=this._mergedCells;
var j=this;
var h;
this.batch(function(){h=i.map(function(q){if(q instanceof b.spreadsheet.CellRef){return q;
}var m=q.toRangeRef().union(g,function(t){g.splice(g.indexOf(t),1);
});
var p=new c(m,j);
var o=p._get("formula");
var s=p.value();
var n=p.format();
var l=p.background();
p.value(null);
p.format(null);
p.background(null);
var r=new c(m.collapse(),j);
if(o){r._set("formula",o);
}else{r.value(s);
}r.format(n);
r.background(l);
g.push(m);
return m;
});
var k=j._viewSelection;
k.selection=j.unionWithMerged(k.originalSelection);
k._activeCell=j.unionWithMerged(k.originalActiveCell);
},{activeCell:true,selection:true});
return h;
}});
b.spreadsheet.Sheet=f;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sheetsbar",["kendo.core","kendo.sortable"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var b=".";
var c=" ";
var f={sheetsBarWrapper:"k-widget k-header",sheetsBarSheetsWrapper:"k-tabstrip k-floatwrap k-tabstrip-bottom",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",sheetsBarAdd:"k-spreadsheet-sheets-bar-add",sheetsBarRemove:"k-spreadsheet-sheets-remove",sheetsBarItems:"k-spreadsheet-sheets-items",sheetsBarEditor:"k-spreadsheet-sheets-editor",sheetsBarScrollable:"k-tabstrip-scrollable",sheetsBarNext:"k-tabstrip-next",sheetsBarPrev:"k-tabstrip-prev",sheetsBarKItem:"k-item k-state-default",sheetsBarKActive:"k-state-active k-state-tab-on-top",sheetsBarKTextbox:"k-textbox",sheetsBarKLink:"k-link",sheetsBarKIcon:"k-icon",sheetsBarKFontIcon:"k-font-icon",sheetsBarKButton:"k-button k-button-icon",sheetsBarKButtonBare:"k-button-bare",sheetsBarKArrowW:"k-i-arrow-w",sheetsBarKArrowE:"k-i-arrow-e",sheetsBarKReset:"k-reset k-tabstrip-items",sheetsBarKIconX:"k-i-x",sheetsBarKSprite:"k-sprite",sheetsBarKIconPlus:"k-i-plus",sheetsBarHintWrapper:"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint",sheetsBarKResetItems:"k-reset k-tabstrip-items"};
var e=d.ui.Widget.extend({init:function(h,i){var g=e.classNames;
d.ui.Widget.call(this,h,i);
h=this.element;
h.addClass(g.sheetsBarWrapper);
this._tree=new d.dom.Tree(h[0]);
this._tree.render([this._addButton(),this._createSheetsWrapper([])]);
this._toggleScrollEvents(true);
this._createSortable();
this._sortable.bind("start",this._onSheetReorderStart.bind(this));
this._sortable.bind("end",this._onSheetReorderEnd.bind(this));
h.on("click",b+g.sheetsBarRemove,this._onSheetRemove.bind(this));
h.on("click","li",this._onSheetSelect.bind(this));
h.on("dblclick","li"+b+g.sheetsBarActive,this._createEditor.bind(this));
h.on("click",b+g.sheetsBarAdd,this._onAddSelect.bind(this));
},options:{name:"SheetsBar",scrollable:{distance:200}},events:["select","reorder","rename"],_createEditor:function(){if(this._editor){return;
}this._renderSheets(this._sheets,this._selectedIndex,true);
this._editor=this.element.find(d.format("input{0}{1}",b,e.classNames.sheetsBarEditor)).focus().on("keydown",this._onEditorKeydown.bind(this)).on("blur",this._onEditorBlur.bind(this));
},_destroyEditor:function(g){var h=g?null:this._editor.val();
this._editor.off();
this._editor=null;
this._renderSheets(this._sheets,this._selectedIndex,false);
this._onSheetRename(h);
},renderSheets:function(h,g){if(!h||g<0){return;
}this._renderSheets(h,g,false);
},_renderSheets:function(q,p,k){var u=this;
var v;
var s;
var i=e.classNames;
u._isRtl=d.support.isRtl(u.element);
u._sheets=q;
u._selectedIndex=p;
u._renderHtml(k,true);
if(!u._scrollableAllowed()){return;
}var t=u._sheetsWrapper();
var n=t.children(b+i.sheetsBarPrev);
var l=t.children(b+i.sheetsBarNext);
var j=2;
var g=u.element.find(b+i.sheetsBarAdd);
var h=g.outerWidth()+g.position().left+j;
var o=n.outerWidth()+j;
var r=u._sheetsGroup();
n.css({left:h});
t.addClass(i.sheetsBarScrollable+c+i.sheetsBarSheetsWrapper);
r.css({marginLeft:h});
v=t[0].offsetWidth;
s=r[0].scrollWidth;
if(s+h>v){var m=Math.ceil(d.parseFloat(l.css("right")));
if(!u._scrollableModeActive){u._nowScrollingSheets=false;
u._scrollableModeActive=true;
}r.css({marginLeft:o+h,marginRight:l.outerWidth()+m+j});
}else{if(u._scrollableModeActive&&s<=v){u._scrollableModeActive=false;
r.css({marginLeft:h,marginRight:""});
}else{r.css({marginLeft:h});
}}u._toggleScrollButtons();
},_toggleScrollButtons:function(k){var j=this;
var l=j._sheetsGroup();
var m=j._sheetsWrapper();
var i=l.scrollLeft();
var h=m.find(b+e.classNames.sheetsBarPrev);
var g=m.find(b+e.classNames.sheetsBarNext);
if(k===false){h.toggle(false);
g.toggle(false);
}else{h.toggle(j._isRtl?i<l[0].scrollWidth-l[0].offsetWidth-1:i!==0);
g.toggle(j._isRtl?i!==0:i<l[0].scrollWidth-l[0].offsetWidth-1);
}},_toggleScrollEvents:function(m){var l=this;
var g=e.classNames;
var h=l.options;
var j;
var i;
var k=l._sheetsWrapper();
j=k.children(b+g.sheetsBarPrev);
i=k.children(b+g.sheetsBarNext);
if(m){j.on("mousedown",function(){l._nowScrollingSheets=true;
l._scrollSheetsByDelta(h.scrollable.distance*(l._isRtl?1:-1));
});
i.on("mousedown",function(){l._nowScrollingSheets=true;
l._scrollSheetsByDelta(h.scrollable.distance*(l._isRtl?-1:1));
});
j.add(i).on("mouseup",function(){l._nowScrollingSheets=false;
});
}else{j.off();
i.off();
}},_renderHtml:function(n,p){var m;
var s=[];
var j=d.dom;
var k=j.element;
var t=this._sheets;
var q=this._selectedIndex;
var h=e.classNames;
for(m=0;
m<t.length;
m++){var r=t[m];
var o=m===q;
var g={className:h.sheetsBarKItem+c};
var l=[];
if(o){g.className+=h.sheetsBarKActive+c+h.sheetsBarActive;
}else{g.className+=h.sheetsBarInactive;
}if(o&&n){l.push(k("input",{type:"text",value:r.name(),className:h.sheetsBarKTextbox+c+h.sheetsBarEditor,maxlength:50},[]));
}else{l.push(k("span",{className:h.sheetsBarKLink,title:r.name()},[j.text(r.name())]));
var i=k("span",{className:h.sheetsBarKIcon+c+h.sheetsBarKFontIcon+c+h.sheetsBarKIconX},[]);
l.push(k("span",{className:h.sheetsBarKLink+c+h.sheetsBarRemove},[i]));
}s.push(k("li",g,l));
}this._tree.render([this._addButton(),this._createSheetsWrapper(s,p)]);
},_createSheetsWrapper:function(l,k){var j=d.dom.element;
var i=e.classNames;
var h=[j("ul",{className:i.sheetsBarKReset},l)];
k=true;
if(k){var g=i.sheetsBarKButton+c+i.sheetsBarKButtonBare+c;
h.push(j("span",{className:g+i.sheetsBarPrev},[j("span",{className:i.sheetsBarKIcon+c+i.sheetsBarKArrowW},[])]));
h.push(j("span",{className:g+i.sheetsBarNext},[j("span",{className:i.sheetsBarKIcon+c+i.sheetsBarKArrowE},[])]));
}return j("div",{className:i.sheetsBarItems},h);
},_createSortable:function(){var g=e.classNames;
this._sortable=new d.ui.Sortable(this.element,{filter:d.format("ul li.{0},ul li.{1}",g.sheetsBarActive,g.sheetsBarInactive),container:b+g.sheetsBarItems,axis:"x",animation:false,ignore:"input",end:function(){if(this.draggable.hint){this.draggable.hint.remove();
}},hint:function(h){var i=a(h).clone();
return i.wrap("<div class='"+g.sheetsBarHintWrapper+"'><ul class='"+g.sheetsBarKResetItems+"'></ul></div>").closest("div");
}});
},_onEditorKeydown:function(g){if(this._editor){if(g.which===13){this._destroyEditor();
}if(g.which===27){this._destroyEditor(true);
}}},_onEditorBlur:function(){if(this._editor){this._destroyEditor();
}},_onSheetReorderEnd:function(g){g.preventDefault();
this.trigger("reorder",{oldIndex:g.oldIndex,newIndex:g.newIndex});
},_onSheetReorderStart:function(g){if(this._editor){g.preventDefault();
}},_onSheetRemove:function(g){var h=a(g.target).closest("li").text();
if(this._editor){this._destroyEditor();
}this.trigger("remove",{name:h});
},_onSheetSelect:function(g){var h=a(g.target).text();
if(a(g.target).is(b+e.classNames.sheetsBarEditor)||!h){g.preventDefault();
return;
}if(this._editor){this._destroyEditor();
}this._scrollSheetsToItem(a(g.target).closest("li"));
this.trigger("select",{name:h,isAddButton:false});
},_onSheetRename:function(g){this.trigger("rename",{name:g,sheetIndex:this._selectedIndex});
},_onAddSelect:function(){this.trigger("select",{isAddButton:true});
},_addButton:function(){var h=d.dom.element;
var g=e.classNames;
return h("a",{className:g.sheetsBarAdd+c+g.sheetsBarKButton},[h("span",{className:g.sheetsBarKSprite+c+g.sheetsBarKIcon+c+g.sheetsBarKFontIcon+c+g.sheetsBarKIconPlus},[])]);
},destroy:function(){this._sortable.destroy();
},_scrollableAllowed:function(){var g=this.options;
return g.scrollable&&!isNaN(g.scrollable.distance);
},_scrollSheetsToItem:function(h){var o=this;
if(!o._scrollableModeActive){return;
}var l=o._sheetsGroup();
var g=l.scrollLeft();
var k=h.outerWidth();
var i=o._isRtl?h.position().left:h.position().left-l.children().first().position().left;
var n=l[0].offsetWidth;
var m=Math.ceil(parseFloat(l.css("padding-left")));
var j;
if(o._isRtl){if(i<0){j=g+i-(n-g)-m;
}else{if(i+k>n){j=g+i-k+m*2;
}}}else{if(g+n<i+k){j=i+k-n+m*2;
}else{if(g>i){j=i-m;
}}}l.finish().animate({scrollLeft:j},"fast","linear",function(){o._toggleScrollButtons();
});
},_sheetsGroup:function(){return this._sheetsWrapper().children("ul");
},_sheetsWrapper:function(){return this.element.find(b+e.classNames.sheetsBarItems);
},_scrollSheetsByDelta:function(g){var j=this;
var i=j._sheetsGroup();
var h=i.scrollLeft();
i.finish().animate({scrollLeft:h+g},"fast","linear",function(){if(j._nowScrollingSheets){j._scrollSheetsByDelta(g);
}else{j._toggleScrollButtons();
}});
}});
d.spreadsheet.SheetsBar=e;
a.extend(true,e,{classNames:f});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/calc",["spreadsheet/runtime"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var C=kendo.spreadsheet;
var y=C.Ref;
var w=C.RangeRef;
var a=C.CellRef;
var p=C.NameRef;
var c=C.calc;
var B=c.runtime;
var r=Object.create(null);
var s=kendo.Class.extend({init:function s(H,I){this.message=H;
this.pos=I;
},toString:function(){return this.message;
}});
(function(H){H.forEach(function(I,J){I.forEach(function(K){r[K]=H.length-J;
});
});
}([[":"],[" "],[","],["%"],["^"],["*","/"],["+","-"],["&"],["=","<",">","<=",">=","<>"]]));
var G={type:"bool",value:true};
var d={type:"bool",value:false};
function g(J){J=J.toUpperCase();
for(var H=0,I=0;
I<J.length;
++I){H=H*26+J.charCodeAt(I)-64;
}return H-1;
}function i(H){return parseInt(H,10)-1;
}function v(K,L){if(K.toLowerCase()=="#sheet"){return C.SHEETREF;
}OUT:{var J;
if(J=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(K)){var N=i(J[4]),I=g(J[2]);
if(N<1048576&&I<16384){return new a(i(J[4]),g(J[2]));
}break OUT;
}var O=F(K,{});
var H=[];
while(true){var M=O.next();
if(M instanceof a){M.rel=0;
}else{if(M instanceof w){M.topLeft.rel=0;
M.bottomRight.rel=0;
}else{break OUT;
}}H.push(M);
if(O.eof()){break;
}if(!O.is("op",",")){break OUT;
}O.next();
}return H.length==1?H[0]:new C.UnionRef(H);
}if(!L){throw new Error("Cannot parse reference: "+K);
}}function t(W,V,I,K){var U=[];
K=F(K,{row:V,col:I});
var L=K.is;
return{type:"exp",ast:R(true),refs:U,sheet:W,row:V,col:I};
function H(Y){Y.index=U.length;
U.push(Y);
return Y;
}function X(aa,ab,Y){if(L(aa,ab)){return K.next();
}else{var Z=K.peek();
if(Z){K.croak("Expected "+aa+" \xAB"+ab+"\xBB but found "+Z.type+" \xAB"+Z.value+"\xBB");
}else{if(!Y){K.croak("Expected "+aa+" \xAB"+ab+"\xBB");
}}}}function R(Y){return M(N(Q(Y)),0,Y);
}function T(Y){if(Y.upper=="TRUE"||Y.upper=="FALSE"){return Y.upper=="TRUE"?G:d;
}return H(new p(Y.value));
}function S(){var Z=K.next();
Z=Z.value;
X("punc","(");
var Y=[];
if(!L("punc",")")){while(1){if(L("op",",")){Y.push({type:"null"});
K.next();
continue;
}Y.push(R(false));
if(K.eof()||L("punc",")")){break;
}X("op",",");
}}X("punc",")",true);
return{type:"func",func:Z,args:Y};
}function J(Y){if(!Y.hasSheet()){Y.setSheet(W);
}return H(Y);
}function Q(Y){var Z;
if(L("ref")){Z=J(K.next());
}else{if(L("func")){Z=S();
}else{if(L("punc","(")){K.next();
Z=R(true);
X("punc",")",true);
}else{if(L("punc","{")){K.next();
Z=P();
X("punc","}",true);
}else{if(L("num")||L("str")||L("error")){Z=K.next();
}else{if(L("sym")){Z=T(K.next());
}else{if(L("op","+")||L("op","-")){Z={type:"prefix",op:K.next().value,exp:R(Y)};
}else{if(!K.peek()){K.croak("Incomplete expression");
}else{K.croak("Parse error");
}}}}}}}}return O(Z);
}function P(){var Z=[],aa=[Z],Y=true;
while(!K.eof()&&!L("punc","}")){if(Y){Y=false;
}else{if(L("punc",";")){aa.push(Z=[]);
K.next();
}else{X("op",",");
}}Z.push(R(false));
}return{type:"matrix",value:aa};
}function N(Y){if(L("punc","(")||L("ref")||L("num")||L("func")){return{type:"binary",op:" ",left:Y,right:R(false)};
}else{return Y;
}}function O(Y){if(L("op","%")){K.next();
return O({type:"postfix",op:"%",exp:Y});
}else{return Y;
}}function M(aa,ab,Y){var ad=L("op");
if(ad&&(Y||ad.value!=",")){var Z=r[ad.value];
if(Z>ab){K.next();
var ac=M(Q(Y),Z,Y);
return M({type:"binary",op:ad.value,left:aa,right:ac},ab,Y);
}}return aa;
}}function u(J,H){var K=t(null,0,0,J);
if(!(K.ast instanceof p)){throw new s("Invalid name: "+J);
}K=K.ast;
if(!(H instanceof y)){var I=t(K.sheet,0,0,H);
if(I.ast instanceof y){H=I.ast;
}else{if(/^(?:str|num|bool|error)$/.test(I.ast.type)){H=I.ast.value;
}else{H=n(I);
}}}return{name:K,value:H};
}function o(H){return m("function(row, col, mod){return("+J(H.ast,H,0)+")}");
function J(K,L,M){switch(K.type){case"num":case"bool":return JSON.stringify(K.value);
case"error":return JSON.stringify("#"+K.value);
case"str":return JSON.stringify(JSON.stringify(K.value));
case"ref":return"this.refs["+K.index+"].print(row, col, mod)";
case"prefix":return N(function(){return JSON.stringify(K.op)+" + "+J(K.exp,K,r[K.op]);
});
case"postfix":return N(function(){return J(K.exp,K,r[K.op])+" + "+JSON.stringify(K.op);
});
case"binary":return N(function(){var O=I(J(K.left,K,r[K.op]),K.left instanceof p&&K.op==":");
var P=I(J(K.right,K,r[K.op]),K.right instanceof p&&K.op==":");
return O+" + "+JSON.stringify(K.op)+" + "+P;
});
case"func":return JSON.stringify(K.func+"(")+" + "+(K.args.length>0?K.args.map(function(O){return J(O,K,0);
}).join(" + ', ' + "):"''")+" + ')'";
case"matrix":return"'{ ' + "+K.value.map(function(O){return O.map(function(P){return J(P,K,0);
}).join(" + ', ' + ");
}).join(" + '; ' + ")+"+ ' }'";
case"null":return"''";
}throw new Error("Cannot make printer for node "+K.type);
function N(O){var Q=K.op;
var P=r[Q]<M||!M&&Q==","||L.type=="binary"&&M==r[Q]&&K===L.right;
return I(O(),P);
}}function I(K,L){return L?"'(' + "+K+" + ')'":K;
}}function D(H,W){var V=0;
return I(H,W);
function I(Z,Y){switch(Z.type){case"ref":return S(Z,Y);
case"num":case"str":case"null":case"error":case"bool":return K(Z,Y);
case"prefix":case"postfix":return T(Z,Y);
case"binary":return L(Z,Y);
case"func":return M(Z,Y);
case"lambda":return O(Z,Y);
case"matrix":return P(Z.value,Y,true);
}throw new Error("Cannot CPS "+Z.type);
}function S(Z,Y){return Z.ref=="name"?Q(Z,Y):K(Z,Y);
}function K(Z,Y){return Y(Z);
}function Q(Z,Y){return{type:"func",func:",getname",args:[X(Y),Z]};
}function T(Z,Y){return I({type:"func",func:"unary"+Z.op,args:[Z.exp]},Y);
}function L(Z,Y){return I({type:"func",func:"binary"+Z.op,args:[Z.left,Z.right]},Y);
}function N(Y,ab,Z,aa){return I(Y,function(ac){var ae=X(aa);
var af=U("T");
var ad=U("E");
return{type:"func",func:"if",args:[ae,ac,{type:"lambda",vars:[af],body:I(ab||G,function(ag){return{type:"call",func:{type:"var",name:af},args:[ag]};
})},{type:"lambda",vars:[ad],body:I(Z||d,function(ag){return{type:"call",func:{type:"var",name:ad},args:[ag]};
})}]};
});
}function J(Y,Z){if(Y.length===0){return K(G,Z);
}return I({type:"func",func:"IF",args:[Y[0],{type:"func",func:"AND",args:Y.slice(1)},d]},Z);
}function R(Y,Z){if(Y.length===0){return K(d,Z);
}return I({type:"func",func:"IF",args:[Y[0],G,{type:"func",func:"OR",args:Y.slice(1)}]},Z);
}function M(aa,Y){switch(aa.func.toLowerCase()){case"if":return N(aa.args[0],aa.args[1],aa.args[2],Y);
case"and":return J(aa.args,Y);
case"or":return R(aa.args,Y);
case"true":return Y(G);
case"false":return Y(d);
}return function Z(ab,ac){if(ac==aa.args.length){return{type:"func",func:aa.func,args:ab};
}else{return I(aa.args[ac],function(ad){return Z(ab.concat([ad]),ac+1);
});
}}([X(Y)],0);
}function O(ab,aa){var Z=U("K");
var Y=I(ab.body,function(ac){return{type:"call",func:{type:"var",value:Z},args:[ac]};
});
return aa({type:"lambda",vars:[Z].concat(ab.vars),body:Y});
}function P(Z,ab,aa){var Y=[];
return function ac(ad){if(ad==Z.length){return ab({type:"matrix",value:Y});
}else{return(aa?P:I)(Z[ad],function(ae){Y[ad]=ae;
return ac(ad+1);
});
}}(0);
}function X(Z){var Y=U("R");
return{type:"lambda",vars:[Y],body:Z({type:"var",name:Y})};
}function U(Y){if(!Y){Y="";
}Y="_"+Y;
return Y+ ++V;
}}var m=function(H){return function(I){var J=H[I];
if(!J){J=H[I]=new Function("'use strict';return("+I+")")();
}return J;
};
}(Object.create(null));
var f=Object.create(null);
function n(I){var N=o(I);
var K=N.call(I);
var J=f[K];
if(J){return J.clone(I.sheet,I.row,I.col);
}var H=L(D(I.ast,function(O){return{type:"return",value:O};
}));
H=["function(){","var context = this, refs = context.formula.absrefs",H,"}"].join(";\n");
J=new B.Formula(I.refs,m(H),N,I.sheet,I.row,I.col);
f[K]=J;
return J;
function L(O){var P=O.type;
if(P=="num"){return O.value+"";
}else{if(P=="str"){return JSON.stringify(O.value);
}else{if(P=="error"){return"context.error("+JSON.stringify(O.value)+")";
}else{if(P=="return"){return"context.resolve("+L(O.value)+")";
}else{if(P=="func"){return"context.func("+JSON.stringify(O.func)+", "+L(O.args[0])+", "+M(O.args.slice(1))+")";
}else{if(P=="call"){return L(O.func)+"("+O.args.map(L).join(", ")+")";
}else{if(P=="ref"){return"refs["+O.index+"]";
}else{if(P=="bool"){return""+O.value;
}else{if(P=="if"){return"(context.bool("+L(O.co)+") ? "+L(O.th)+" : "+L(O.el)+")";
}else{if(P=="lambda"){return"(function("+O.vars.join(", ")+"){ return("+L(O.body)+") })";
}else{if(P=="var"){return O.name;
}else{if(P=="matrix"){return M(O.value);
}else{if(P=="null"){return"null";
}else{throw new Error("Cannot compile expression "+P);
}}}}}}}}}}}}}}function M(O){return"[ "+O.map(L).join(", ")+" ]";
}}function j(H){return H;
}function F(L,O){L=x(k(L),O);
var I=L.ahead;
var X=L.skip;
var Z=null;
var J=O.row!=null&&O.col!=null?function(aa){if(aa.rel&1){aa.col-=O.col;
}if(aa.rel&2){aa.row-=O.row;
}return aa;
}:j;
var H=O.forEditor?function(ac,ab,aa){ac.begin=ab.begin;
ac.end=aa.end;
return ac;
}:j;
return{peek:P,next:N,croak:L.croak,eof:L.eof,is:M};
function M(ab,ac){var aa=P();
return aa!=null&&(ab==null||aa.type===ab)&&(ac==null||aa.value===ac)?aa:null;
}function P(){if(Z==null){Z=Q();
}return Z;
}function N(){if(Z!=null){var aa=Z;
Z=null;
return aa;
}return Q();
}function Q(){var aa;
var ab=L.peek();
if(ab){if(ab.type=="sym"||ab.type=="rc"||ab.type=="num"){aa=I(8,U)||I(6,S)||I(6,W)||I(4,V)||I(4,T)||I(2,R)||I(2,K);
}if(!aa){aa=L.next();
}}return aa;
}function Y(ag,ac){if(ag.type=="rc"){if(ag.rel&&!O.forEditor&&(O.row==null||O.col==null)){L.croak("Cannot read relative cell in RC notation");
}return new a(ag.row,ag.col,ag.rel);
}if(ag.type=="num"){if(ag.value<=1048577){return J(new a(i(ag.value),ac?-Infinity:+Infinity,2));
}else{return null;
}}var ae=ag.value;
var ad=/^(\$)?([a-z]+)(\$)?(\d+)$/i.exec(ae);
if(ad){var af=i(ad[4]),ab=g(ad[2]);
if(af<=1048576&&ab<=16383){return J(new a(i(ad[4]),g(ad[2]),(ad[1]?0:1)|(ad[3]?0:2)));
}else{return null;
}}var aa=ae.charAt(0)=="$";
if(aa){ae=ae.substr(1);
}if(/^\d+$/.test(ae)){var af=i(ae);
if(af<=1048576){return J(new a(i(ae),ac?-Infinity:+Infinity,aa?0:2));
}}else{var ab=g(ae);
if(ab<=16383){return J(new a(ac?-Infinity:+Infinity,g(ae),aa?0:1));
}}}function U(aa,ab,ad,ae,af,ag,ah,ai){if(aa.type=="sym"&&ab.type=="op"&&ab.value==":"&&ad.type=="sym"&&ae.type=="punc"&&ae.value=="!"&&(af.type=="sym"||af.type=="rc"||af.type=="num"&&af.value==af.value|0)&&ag.type=="op"&&ag.value==":"&&(ah.type=="sym"||ah.type=="rc"||ah.type=="num"&&ah.value==ah.value|0)&&ah.type==af.type&&!(ai.type=="punc"&&ai.value=="("&&!ah.space)){var aj=Y(af,true),ac=Y(ah,false);
if(aj&&ac){X(7);
return H(new w(aj.setSheet(aa.value,true),ac.setSheet(ad.value,true)).setSheet(aa.value,true),aa,ah);
}}}function S(aa,ab,ad,ae,af,ag){if(aa.type=="sym"&&ab.type=="op"&&ab.value==":"&&ad.type=="sym"&&ae.type=="punc"&&ae.value=="!"&&(af.type=="sym"||af.type=="rc"||af.type=="num"&&af.value==af.value|0)&&!(ag.type=="punc"&&ag.value=="("&&!af.space)){var ah=Y(af);
if(ah){X(5);
var ac=ah.clone();
return H(new w(ah.setSheet(aa.value,true),ac.setSheet(ad.value,true)).setSheet(aa.value,true),aa,af);
}}}function W(aa,ab,ad,ae,af,ag){if(aa.type=="sym"&&ab.type=="punc"&&ab.value=="!"&&(ad.type=="sym"||ad.type=="rc"||ad.type=="num"&&ad.value==ad.value|0)&&ae.type=="op"&&ae.value==":"&&(af.type=="sym"||af.type=="rc"||af.type=="num"&&af.value==af.value|0)&&!(ag.type=="punc"&&ag.value=="("&&!af.space)){var ah=Y(ad,true),ac=Y(af,false);
if(ah&&ac){X(5);
return H(new w(ah,ac).setSheet(aa.value,true),aa,af);
}}}function V(aa,ab,ac,ad){if(aa.type=="sym"&&ab.type=="punc"&&ab.value=="!"&&(ac.type=="sym"||ac.type=="rc"||ac.type=="num"&&ac.value==ac.value|0)&&!(ad.type=="punc"&&ad.value=="("&&!ac.space)){X(3);
var ae=Y(ac);
if(!ae||!isFinite(ae.row)){ae=new p(ac.value);
}return H(ae.setSheet(aa.value,true),aa,ac);
}}function T(aa,ab,ad,ae){if((aa.type=="sym"||aa.type=="rc"||aa.type=="num"&&aa.value==aa.value|0)&&(ab.type=="op"&&ab.value==":")&&(ad.type=="sym"||ad.type=="rc"||ad.type=="num"&&ad.value==ad.value|0)&&!(ae.type=="punc"&&ae.value=="("&&!ad.space)){var af=Y(aa,true),ac=Y(ad,false);
if(af&&ac){X(3);
return H(new w(af,ac),aa,ad);
}}}function R(aa,ab){if((aa.type=="sym"||aa.type=="rc")&&!(ab.type=="punc"&&ab.value=="("&&!aa.space)){var ac=Y(aa);
if(ac&&isFinite(ac.row)&&isFinite(ac.col)){X(1);
return H(ac,aa,aa);
}}}function K(aa,ab){if(aa.type=="sym"&&ab.type=="punc"&&ab.value=="("&&!aa.space){aa.type="func";
X(1);
return aa;
}}}function l(H){return" \t\n\xA0\u200B".indexOf(H)>=0;
}function x(L,S){var ae=[],K=0;
var ab=L.readWhile;
return{next:R,peek:T,eof:I,croak:L.croak,ahead:H,skip:ac};
function M(af){return/[0-9]/i.test(af);
}function O(af){return/[a-z$_]/i.test(af)||af.toLowerCase()!=af.toUpperCase();
}function N(af){return O(af)||M(af)||af==".";
}function P(af){return af in r;
}function Q(af){return"!;(){}[]".indexOf(af)>=0;
}function V(){var af=false;
var ag=ab(function(ah){if(ah=="."){if(af){return false;
}af=true;
return true;
}return M(ah);
});
return{type:"num",value:parseFloat(ag)};
}function ad(af,ag){return{type:"sym",value:af,upper:af.toUpperCase(),space:l(L.peek()),quote:ag};
}function J(af,ag,ah){if(!af&&!ag&&!ah){return 0;
}if(!af&&!ah||af&&ah){var ai=af&&/-$/.test(af);
var aj=parseInt(ag,10);
if(ai){aj=-aj;
}if(!af){aj--;
}return aj;
}}function aa(){var ag=L.lookingAt(/^R(\[-?)?([0-9]+)?(\])?C(\[-?)?([0-9]+)?(\])?/i);
if(ag){var ah=J(ag[1],ag[2],ag[3]);
var af=J(ag[4],ag[5],ag[6]);
if(ah!=null&&af!=null){L.skip(ag);
return{type:"rc",row:ah,col:af,rel:(ag[4]||!(ag[4]||ag[5]||ag[6])?1:0)|(ag[1]||!(ag[1]||ag[2]||ag[3])?2:0)};
}}return ad(ab(N));
}function Z(){L.next();
return{type:"str",value:L.readEscaped('"')};
}function Y(){L.next();
return ad(L.readEscaped("'"),true);
}function W(){return{type:"op",value:ab(function(af,ag){return ag+af in r;
})};
}function X(){return{type:"punc",value:L.next()};
}function U(){if(L.eof()){return null;
}var af=L.peek(),ag;
if(af=='"'){return Z();
}if(af=="'"){return Y();
}if(M(af)){return V();
}if(O(af)){return aa();
}if(P(af)){return W();
}if(Q(af)){return X();
}if(ag=L.lookingAt(/^#([a-z\/]+)[?!]?/i)){L.skip(ag);
return{type:"error",value:ag[1]};
}if(!S.forEditor){L.croak("Can't handle character: "+af);
}return{type:"error",value:L.next()};
}function T(){while(ae.length<=K){ab(l);
var af=L.pos();
var ag=U();
if(S.forEditor&&ag){ag.begin=af;
ag.end=L.pos();
}ae.push(ag);
}return ae[K];
}function R(){var af=T();
if(af){K++;
}return af;
}function H(ah,ag){var ai=K,af=[];
while(ah-->0){af.push(R()||b);
}K=ai;
return ag.apply(af,af);
}function ac(af){K+=af;
}function I(){return T()==null;
}}var b={type:"eof"};
function k(L){var R=0,M=1,H=0;
return{next:P,peek:Q,eof:J,croak:I,readWhile:T,readEscaped:S,lookingAt:O,skip:U,forward:K,pos:N};
function N(){return R;
}function P(){var V=L.charAt(R++);
if(V=="\n"){M++;
H=0;
}else{H++;
}return V;
}function Q(){return L.charAt(R);
}function J(){return Q()==="";
}function I(V){throw new s(V+" (input: "+L+")",R);
}function U(V){if(typeof V=="string"){if(L.substr(R,V.length)!=V){I("Expected "+V);
}K(V.length);
}else{if(V instanceof RegExp){var W=V.exec(L.substr(R));
if(W){K(W[0].length);
return W;
}}else{K(V[0].length);
}}}function K(V){while(V-->0){P();
}}function S(W){var X=false,Y="";
while(!J()){var V=P();
if(X){Y+=V;
X=false;
}else{if(V=="\\"){X=true;
}else{if(V==W){break;
}else{Y+=V;
}}}}return Y;
}function T(V){var W="";
while(!J()&&V(Q(),W)){W+=P();
}return W;
}function O(V){return V.exec(L.substr(R));
}}var e=[];
var z=c.registerFormatParser=function(H){e.push(H);
};
c.parse=function(O,N,H,K){if(K instanceof Date){return{type:"date",value:B.dateToSerial(K)};
}if(typeof K=="number"){return{type:"number",value:K};
}if(typeof K=="boolean"){return{type:"boolean",value:K};
}K+="";
if(/^'/.test(K)){return{type:"string",value:K.substr(1)};
}if(/^[0-9.]+%$/.test(K)){var P=K.substr(0,K.length-1);
var L=parseFloat(P);
if(!isNaN(L)&&L==P){return{type:"percent",value:L/100};
}}if(/^=/.test(K)){K=K.substr(1);
if(/\S/.test(K)){return t(O,N,H,K);
}else{return{type:"string",value:"="+K};
}}for(var J=0;
J<e.length;
++J){var M=e[J](K);
if(M){return M;
}}if(K.toLowerCase()=="true"){return{type:"boolean",value:true};
}if(K.toLowerCase()=="false"){return{type:"boolean",value:false};
}var I=B.parseDate(K);
if(I){return{type:"date",value:B.dateToSerial(I)};
}var L=parseFloat(K);
if(!isNaN(L)&&K.length>0&&L==K){return{type:"number",value:L};
}return{type:"string",value:K};
};
function E(I,K,H){var M=[];
I=F(I,{forEditor:true,row:K,col:H});
while(!I.eof()){M.push(J());
}var L=M[0];
if(L.type=="op"&&L.value=="="){L.type="startexp";
}return M;
function J(){var N=I.next();
if(N.type=="sym"){if(N.upper=="TRUE"){N.type="bool";
N.value=true;
}else{if(N.upper=="FALSE"){N.type="bool";
N.value=false;
}}}else{if(N.type=="ref"){N={type:"ref",ref:K!=null&&H!=null?N.absolute(K,H):N,begin:N.begin,end:N.end};
}}return N;
}}c.parseNameDefinition=u;
c.parseFormula=t;
c.parseReference=v;
c.compile=n;
c.InputStream=k;
c.ParseError=s;
c.tokenize=E;
z(function(I){var J;
if(J=/^(\d+):(\d+)$/.exec(I)){var H=parseInt(J[1],10);
var K=parseInt(J[2],10);
return{type:"date",format:"hh:mm",value:B.packTime(H,K,0,0)};
}if(J=/^(\d+):(\d+)(\.\d+)$/.exec(I)){var K=parseInt(J[1],10);
var M=parseInt(J[2],10);
var L=parseFloat(J[3])*1000;
return{type:"date",format:"mm:ss.00",value:B.packTime(0,K,M,L)};
}if(J=/^(\d+):(\d+):(\d+)$/.exec(I)){var H=parseInt(J[1],10);
var K=parseInt(J[2],10);
var M=parseInt(J[3],10);
return{type:"date",format:"hh:mm:ss",value:B.packTime(H,K,M,0)};
}if(J=/^(\d+):(\d+):(\d+)(\.\d+)$/.exec(I)){var H=parseInt(J[1],10);
var K=parseInt(J[2],10);
var M=parseInt(J[3],10);
var L=parseFloat(J[4])*1000;
return{type:"date",format:"hh:mm:ss.00",value:B.packTime(H,K,M,L)};
}});
z(function(N){var O,P;
var I=kendo.culture();
var H=I.numberFormat[","];
var K=I.numberFormat["."];
var J=I.numberFormat.currency.symbol;
var R=h(H,K);
var Q=new RegExp("^\\s*\\"+J+"\\s*");
var S=1;
var L="";
var T="";
var M=false;
N=k(N.replace(/^\s+|\s+$/g,""));
if(N.skip(/^-\s*/)){S=-1;
}if(O=N.skip(Q)){M=true;
L+='"'+O[0]+'"';
}if(N.skip(/^-\s*/)){if(S<0){return null;
}S=-1;
}if(!(P=N.skip(R))){return null;
}L+="#";
if(O=N.skip(Q)){if(M){return null;
}M=true;
T='"'+O[0]+'"';
}if(!N.eof()){return null;
}if(P[2]||M){L+=",#";
}if(P[3]){L+="."+A("0",P[3].length-1);
}var U=P[0].replace(new RegExp("\\"+H,"g"),"").replace(new RegExp("\\"+K,"g"),".");
return{type:"number",format:L+T,value:S*parseFloat(U)};
});
var q={};
function h(H,I){var J=H+I;
var K=q[J];
if(!K){K="^(\\d+(COM\\d{3})*(DOT\\d+)?)";
K=K.replace(/DOT/g,"\\"+I).replace(/COM/g,"\\"+H);
K=new RegExp(K);
q[J]=K;
}return K;
}function A(J,H){var I="";
while(H-->0){I+=J;
}return I;
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/excel-reader",["kendo.core","kendo.color","util/parse-xml","spreadsheet/calc"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var a=kendo.jQuery;
var k=kendo.util.parseXML;
var j=kendo.spreadsheet.calc.parseReference;
function m(Y,aa,X){var Z=new FileReader();
Z.onload=function(ab){var ac=new JSZip(ab.target.result);
s(ac,aa,X);
};
Z.readAsArrayBuffer(Y);
}var v=["sheetData","row","c"];
var w=["cols","col"];
var x=["definedNames","definedName"];
var A=["sheetData","row","c","f"];
var D=["mergeCells","mergeCell"];
var G=["sheetViews","sheetView","pane"];
var H=["sheetData","row"];
var K=["sheetViews","sheetView","selection"];
var M=["sheets","sheet"];
var O=["sheetData","row","c","is"];
var P=["t"];
var L=["si"];
var Q=["sheetData","row","c","v"];
var R=["bookViews","workbookView"];
var N=["sheetViews","sheetView"];
var B=["hyperlinks","hyperlink"];
function W(X){if(!/^\//.test(X)){X="xl/"+X;
}else{X=X.substr(1);
}return X;
}function s(ag,af,aa){var ac=p(ag);
var ab=n(ag,"_rels/workbook.xml");
var ae=r(ag,ab.byType.theme[0]);
var ad=q(ag,ae);
var Y=[];
var X=0;
i(ag,"xl/workbook.xml",{enter:function(am,ah){if(this.is(M)){var al=ah["r:id"];
var aj=ab.byId[al];
var ak=ah.name;
var ai=S(ag,aj);
Y.push({workbook:af,zip:ag,strings:ac,styles:ad,file:aj,options:{name:ak,rows:Math.max(af.options.rows||0,ai.rows),columns:Math.max(af.options.columns||0,ai.cols),columnWidth:ai.columnWidth,rowHeight:ai.rowHeight}});
}else{if(this.is(R)){if(ah.activeTab){X=g(ah.activeTab);
}}}},text:function(al){var ah=this.is(x);
if(ah&&!(c(ah["function"])||c(ah.vbProcedure))){var ai=ah.localSheetId;
var ak=null;
if(ai!=null){ak=Y[ai].options.name;
}var aj=ah.name;
if(ak){aj="'"+ak.replace(/\'/g,"\\'")+"'!"+aj;
}af.defineName(aj,al,c(ah.hidden));
}}});
var Z=new a.Deferred();
Z.progress(function(ah){if(aa){aa.notify(ah);
}}).then(function(){var ah=af.sheets();
t(ah);
af.activeSheet(ah[X]);
if(aa){aa.resolve();
}});
h(Y,af,Z);
}function h(Y,ab,Z){var aa=new a.Deferred().resolve();
for(var X=0;
X<Y.length;
X++){(function(ac,ad){aa=aa.then(function(){var ag=ab.insertSheet(ac.options);
ag.suspendChanges(true);
var af=l(ag,ac);
var ae={sheet:ag,progress:ad/(Y.length-1)};
af.then(function(){Z.notify(ae);
});
return af;
});
}(Y[X],X));
}aa.then(function(){Z.resolve();
});
}function l(Z,X){var Y=new a.Deferred();
setTimeout(function(){o(X.zip,X.file,Z,X.strings,X.styles);
Y.resolve();
},0);
return Y;
}function t(Y){for(var X=0;
X<Y.length;
X++){Y[X].suspendChanges(false).triggerChange({recalc:true});
}}function S(Z,Y){var X={rows:0,cols:0};
i(Z,W(Y),{enter:function(ac,aa){if(ac=="dimension"){var ab=j(aa.ref);
if(ab.bottomRight){X.cols=ab.bottomRight.col+1;
X.rows=ab.bottomRight.row+1;
}}else{if(ac==="sheetFormatPr"){if(aa.defaultColWidth){X.columnWidth=T(parseFloat(aa.defaultColWidth));
}if(aa.defaultRowHeight){X.rowHeight=V(parseFloat(aa.defaultRowHeight));
}}else{if(this.is(H)){this.exit();
}}}}});
return X;
}function T(Z){var Y=7;
var X=(256*Z+Math.floor(128/Y))/256;
return Math.floor(X)*Y;
}function V(X){return X*1.5625;
}function o(ak,X,af,ag,ah){var ac,ai,aj,Y,Z;
var aa=af._columns._count;
var ab=null;
var ae=X.replace(/worksheets\//,"worksheets/_rels/");
var ad=n(ak,ae);
i(ak,W(X),{enter:function(av,am){if(this.is(v)){aj=null;
Y=null;
Z=null;
ac=am.r;
if(ac==null){ac=j(ab);
ac.col++;
ac=ac.toString();
}ab=ac;
ai=am.t;
var au=am.s;
if(au!=null){b(af,ac,ah,au);
}}else{if(this.is(D)){af.range(am.ref).merge();
}else{if(this.is(w)){var ar=g(am.min)-1;
var at=Math.min(aa,g(am.max))-1;
var ax;
if(am.width){ax=T(parseFloat(am.width));
if(ax!==0){af._columns.values.value(ar,at,ax);
}}if(am.hidden==="1"||ax===0){for(var an=ar;
an<=at;
an++){af.hideColumn(an);
}}}else{if(this.is(H)){var aq=g(am.r)-1;
var ao;
if(am.ht){ao=V(parseFloat(am.ht));
if(ao!==0){af._rows.values.value(aq,aq,ao);
}}if(am.hidden==="1"||ao===0){af.hideRow(aq);
}}else{if(this.is(K)){if(am.activeCell){var al=j(am.activeCell);
af.select(al,true);
}}else{if(this.is(G)){if(am.state=="frozen"){if(am.xSplit){af.frozenColumns(g(am.xSplit));
}if(am.ySplit){af.frozenRows(g(am.ySplit));
}}}else{if(this.is(N)){af.showGridLines(c(am.showGridLines,true));
}else{if(this.is(B)){var ap=am["r:id"];
var aw=ad.byId[ap];
if(aw){af.range(am.ref).link(aw);
}}}}}}}}}},leave:function(an){if(this.is(v)){if(Y!=null){try{af.range(Z||ac).formula(Y);
}catch(al){af.range(Z||ac).value(Y).background("#ffaaaa");
}}else{if(aj!=null){var am=af.range(ac);
if(!am._get("formula")){if(!ai||ai=="n"){aj=parseFloat(aj);
}else{if(ai=="s"){aj=ag[g(aj)];
}else{if(ai=="b"){aj=aj==="1";
}else{if(ai=="d"){aj=kendo.parseDate(aj);
}}}}if(aj!=null){am.value(aj);
}}}}}else{if(an=="cols"){af._columns._refresh();
}else{if(an=="sheetData"){af._rows._refresh();
}}}},text:function(am){var al;
if(this.is(Q)||this.is(O)){aj=am;
}else{if(al=this.is(A)){Y=am;
if(al.t=="shared"){Z=al.ref;
}}}}});
}var d={none:0,thin:1,medium:2,dashed:1,dotted:1,thick:3,"double":3,hair:1,mediumDashed:2,dashDot:1,mediumDashDot:2,dashDotDot:1,mediumDashDotDot:2,slantDashDot:1};
var e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"};
function b(ae,Z,ah,ag){var Y=ae.range(Z);
var aj=ah.inlineStyles[ag],X,ai;
if(aj.xfId){X=ah.namedStyles[aj.xfId];
}if(af("applyBorder","borderId")){aa(ah.borders[ai]);
}if(af("applyFont","fontId")){ac(ah.fonts[ai]);
}if(af("applyAlignment","textAlign")){Y.textAlign(ai);
}if(af("applyAlignment","verticalAlign")){Y.verticalAlign(ai);
}if(af("applyAlignment","wrapText")){Y._property("wrap",ai);
}if(af("applyFill","fillId")){ab(ah.fills[ai]);
}if(af("applyNumberFormat","numFmtId")){ad(ah.numFmts[ai]||e[ai]);
}function ad(ak){var al=typeof ak=="string"?ak:ak.formatCode;
if(al!=null&&!/^general$/i.test(al)){al=al.replace(/^\[\$-[0-9]+\]/,"");
Y.format(al);
}}function ab(ak){if(ak.type=="solid"){Y.background(ak.color);
}}function ac(ak){Y.fontFamily(ak.name);
Y._property("fontSize",ak.size);
if(ak.bold){Y.bold(true);
}if(ak.italic){Y.italic(true);
}}function aa(ak){function al(ap,ao){var am=ak[ap];
if(!am){return;
}var aq=d[am.style];
if(aq===0){return;
}var an=am.color;
if(an==null){an="#000";
}Y._property(ao,{size:aq,color:an});
}al("left","borderLeft");
al("top","borderTop");
al("right","borderRight");
al("bottom","borderBottom");
}function af(ak,al){var am=aj[ak];
if(am!=null&&!am){return false;
}ai=aj[al];
if(X&&ai==null){am=X[ak];
if(am!=null&&!am){return false;
}ai=X[al];
}return ai!=null;
}}function i(aa,Y,X){var Z=aa.files[Y];
if(Z){k(Z.asUint8Array(),X);
}}function p(Z){var Y=[];
var X=null;
i(Z,"xl/sharedStrings.xml",{leave:function(){if(this.is(L)){Y.push(X);
X=null;
}},text:function(aa){if(this.is(P)){if(X==null){X="";
}X+=aa;
}}});
return Y;
}function n(Z,X){var Y={byId:{},byType:{theme:[]}};
i(Z,W(X)+".rels",{enter:function(ac,aa){if(ac=="Relationship"){Y.byId[aa.Id]=aa.Target;
var ad=aa.Type.match(/\w+$/)[0];
var ab=Y.byType[ad]||[];
ab.push(aa.Target);
Y.byType[ad]=ab;
}}});
return Y;
}var u=["borders","border"];
var y=["fills","fill"];
var z=["fonts","font"];
var C=["cellXfs","xf"];
var E=["cellStyleXfs","xf"];
var F=["numFmts","numFmt"];
var f=[U("FF000000"),U("FFFFFFFF"),U("FFFF0000"),U("FF00FF00"),U("FF0000FF"),U("FFFFFF00"),U("FFFF00FF"),U("FF00FFFF"),U("FF000000"),U("FFFFFFFF"),U("FFFF0000"),U("FF00FF00"),U("FF0000FF"),U("FFFFFF00"),U("FFFF00FF"),U("FF00FFFF"),U("FF800000"),U("FF008000"),U("FF000080"),U("FF808000"),U("FF800080"),U("FF008080"),U("FFC0C0C0"),U("FF808080"),U("FF9999FF"),U("FF993366"),U("FFFFFFCC"),U("FFCCFFFF"),U("FF660066"),U("FFFF8080"),U("FF0066CC"),U("FFCCCCFF"),U("FF000080"),U("FFFF00FF"),U("FFFFFF00"),U("FF00FFFF"),U("FF800080"),U("FF800000"),U("FF008080"),U("FF0000FF"),U("FF00CCFF"),U("FFCCFFFF"),U("FFCCFFCC"),U("FFFFFF99"),U("FF99CCFF"),U("FFFF99CC"),U("FFCC99FF"),U("FFFFCC99"),U("FF3366FF"),U("FF33CCCC"),U("FF99CC00"),U("FFFFCC00"),U("FFFF9900"),U("FFFF6600"),U("FF666699"),U("FF969696"),U("FF003366"),U("FF339966"),U("FF003300"),U("FF333300"),U("FF993300"),U("FF993366"),U("FF333399"),U("FF333333"),U("FF000000"),U("FFFFFFFF")];
function q(af,ad){var ac={fonts:[],numFmts:{},fills:[],borders:[],namedStyles:[],inlineStyles:[]};
var Z=null;
var Y=null;
var X=null;
var ae=null;
i(af,"xl/styles.xml",{enter:function(aj,ag,ah){if(this.is(F)){ac.numFmts[ag.numFmtId]=ag;
}else{if(this.is(z)){ac.fonts.push(Z={});
}else{if(Z){if(aj=="sz"){Z.size=parseFloat(ag.val);
}else{if(aj=="name"){Z.name=ag.val;
}else{if(aj=="b"){Z.bold=c(ag.val,true);
}else{if(aj=="i"){Z.italic=c(ag.val,true);
}}}}}else{if(this.is(y)){ac.fills.push(Y={});
}else{if(Y){if(aj=="patternFill"){Y.type=ag.patternType;
}else{if(aj=="fgColor"&&Y.type==="solid"){Y.color=aa(ag);
}else{if(aj=="bgColor"&&Y.type!=="solid"){Y.color=aa(ag);
}}}}else{if(this.is(u)){ac.borders.push(X={});
}else{if(X){if(/^(?:left|top|right|bottom)$/.test(aj)&&ag.style){X[aj]={style:ag.style};
}if(aj=="color"){var ai=this.stack[this.stack.length-2].$tag;
X[ai].color=aa(ag);
}}else{if(this.is(E)){ae=ab(ag);
ac.namedStyles.push(ae);
if(ah){ae=null;
}}else{if(this.is(C)){ae=ab(ag);
ac.inlineStyles.push(ae);
if(ah){ae=null;
}}else{if(ae){if(aj=="alignment"){if(/^(?:left|center|right|justify)$/.test(ag.horizontal)){ae.textAlign=ag.horizontal;
}if(/^(?:top|center|bottom)$/.test(ag.vertical)){ae.verticalAlign=ag.vertical;
}if(ag.wrapText!=null){ae.wrapText=c(ag.wrapText);
}}}}}}}}}}}}},leave:function(ag){if(this.is(z)){Z=null;
}else{if(this.is(y)){Y=null;
}else{if(this.is(u)){X=null;
}else{if(ag=="xf"){ae=null;
}}}}}});
function ab(ah){var ai={borderId:g(ah.borderId),fillId:g(ah.fillId),fontId:g(ah.fontId),numFmtId:g(ah.numFmtId),pivotButton:c(ah.pivotButton),quotePrefix:c(ah.quotePrefix),xfId:g(ah.xfId)};
ag("applyAlignment");
ag("applyBorder");
ag("applyFill");
ag("applyFont");
ag("applyNumberFormat");
ag("applyProtection");
function ag(aj){if(ah[aj]!=null){ai[aj]=c(ah[aj]);
}}return ai;
}function aa(ag){if(ag.rgb){return U(ag.rgb);
}else{if(ag.indexed){return f[g(ag.indexed)];
}else{if(ag.theme){var ai=ad.colorScheme[g(ag.theme)];
if(!ai){return f[0];
}var ah=kendo.parseColor(ai);
if(ag.tint){ah=ah.toHSL();
var aj=parseFloat(ag.tint);
if(aj<0){ah.l=ah.l*(1+aj);
}else{ah.l=ah.l*(1-aj)+(100-100*(1-aj));
}}return ah.toCssRgba();
}}}}return ac;
}var I=["a:clrScheme","*","a:srgbClr"];
var J=["a:clrScheme","*","a:sysClr"];
function r(ac,Y){var Z=[];
var ab={colorScheme:Z};
var X=W(Y);
if(ac.files[X]){i(ac,X,{enter:function(ae,ad){if(this.is(J)){Z.push(U(ad.val=="window"?"FFFFFFFF":"FF000000"));
}else{if(this.is(I)){Z.push(U("FF"+ad.val));
}}}});
if(Z.length>3){aa(Z,0,1);
aa(Z,2,3);
}}function aa(ae,ad,af){var ag=ae[ad];
ae[ad]=ae[af];
ae[af]=ag;
}return ab;
}function g(X){return X==null?null:parseInt(X,10);
}function c(Y,X){if(Y==null){return X;
}return Y=="true"||Y===true||Y==1;
}function U(Y){var X=/^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(Y);
return"rgba("+parseInt(X[2],16)+", "+parseInt(X[3],16)+", "+parseInt(X[4],16)+", "+parseInt(X[1],16)/255+")";
}kendo.spreadsheet.readExcel=m;
kendo.spreadsheet._readSheet=o;
kendo.spreadsheet._readStrings=p;
kendo.spreadsheet._readStyles=q;
kendo.spreadsheet._readTheme=r;
kendo.spreadsheet._readWorkbook=s;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/workbook",["kendo.core","spreadsheet/runtime","spreadsheet/references","spreadsheet/excel-reader"],b);
}(function(){(function(d){if(d.support.browser.msie&&d.support.browser.version<9){return;
}var a=d.jQuery;
var c=d.spreadsheet.calc.runtime.Formula;
var e=d.spreadsheet.Ref;
var b=d.spreadsheet.CalcError;
var g=d.Observable.extend({init:function(h,i){d.Observable.fn.init.call(this);
this.options=h;
this._view=i;
this._sheets=[];
this._sheetsSearchCache={};
this._sheet=this.insertSheet({rows:this.options.rows,columns:this.options.columns,rowHeight:this.options.rowHeight,columnWidth:this.options.columnWidth,headerHeight:this.options.headerHeight,headerWidth:this.options.headerWidth,dataSource:this.options.dataSource});
this.undoRedoStack=new d.util.UndoRedoStack();
this.undoRedoStack.bind(["undo","redo"],this._onUndoRedo.bind(this));
this._context=new d.spreadsheet.FormulaContext(this);
this._validationContext=new d.spreadsheet.ValidationFormulaContext(this);
this._names=Object.create(null);
this.fromJSON(this.options);
},clipboard:function(){if(!this._clipboard){this._clipboard=new d.spreadsheet.Clipboard(this);
}return this._clipboard;
},destroy:function(){this.unbind();
if(this._clipboard){this._clipboard.destroy();
}},events:["change","excelImport","excelExport"],_sheetChange:function(h){this.trigger("change",h);
},_sheetCommandRequest:function(h){this.trigger("commandRequest",h);
},_inputForRef:function(h){return new d.spreadsheet.Range(h,this._sheet).input();
},_onUndoRedo:function(h){h.command.range().select();
},execute:function(j){var i=a.extend({workbook:this},j.options);
var h=new d.spreadsheet[j.command](i);
var l=this.activeSheet();
if(i.origin){h.origin(i.origin);
}if(i.operatingRange){h.range(i.operatingRange);
}else{if(i.editActiveCell){h.range(l.activeCellSelection());
}else{h.range(l.selection());
}}var k=h.exec();
if(!k||k.reason!=="error"){if(h.cannotUndo){this.undoRedoStack.clear();
}else{this.undoRedoStack.push(h);
}}return k;
},resetFormulas:function(){this._sheets.forEach(function(h){h.resetFormulas();
});
},resetValidations:function(){this._sheets.forEach(function(h){h.resetValidations();
});
},refresh:function(h){if(h.recalc){this.resetFormulas();
this.resetValidations();
this._sheet.recalc(this._context);
this._sheet.revalidate(this._validationContext);
}},activeSheet:function(h){if(h===undefined){return this._sheet;
}if(!this.sheetByName(h.name())){return;
}this._sheet=h;
h.triggerChange(d.spreadsheet.ALL_REASONS);
},moveSheetToIndex:function(i,k){var h=this.sheetIndex(i);
var j=this._sheets;
if(h===-1){return;
}this._sheetsSearchCache={};
j.splice(k,0,j.splice(h,1)[0]);
this.trigger("change",{sheetSelection:true});
},insertSheet:function(j){j=j||{};
var n=this;
var i=typeof j.index==="number"?j.index:n._sheets.length;
var l;
var m=n._sheets;
var h=function(p){p=p?p:1;
var o="Sheet"+p;
if(!n.sheetByName(o)){return o;
}return h(p+1);
};
if(j.name&&n.sheetByName(j.name)){return;
}this._sheetsSearchCache={};
l=j.name||h();
var k=new d.spreadsheet.Sheet(j.rows||this.options.rows,j.columns||this.options.columns,j.rowHeight||this.options.rowHeight,j.columnWidth||this.options.columnWidth,j.headerHeight||this.options.headerHeight,j.headerWidth||this.options.headerWidth);
k._workbook=this;
k._name(l);
k.bind("change",this._sheetChange.bind(this));
k.bind("commandRequest",this._sheetCommandRequest.bind(this));
m.splice(i,0,k);
if(j.data){k.fromJSON(j.data);
}if(j.dataSource){k.setDataSource(j.dataSource);
}this.trigger("change",{sheetSelection:true});
return k;
},sheets:function(){return this._sheets.slice();
},sheetByName:function(h){return this._sheets[this.sheetIndex(h)];
},sheetByIndex:function(h){return this._sheets[h];
},sheetIndex:function(j){var l=this._sheets;
var k=(typeof j=="string"?j:j.name()).toLowerCase();
var h=this._sheetsSearchCache[k];
if(h>=0){return h;
}for(h=0;
h<l.length;
h++){var i=l[h].name().toLowerCase();
this._sheetsSearchCache[i]=h;
if(i===k){return h;
}}return -1;
},renameSheet:function(j,h){var i=j.name().toLowerCase();
if(!h||i===h.toLowerCase()){return;
}j=this.sheetByName(i);
if(!j){return;
}this._sheetsSearchCache={};
this._sheets.forEach(function(k){k._forFormulas(function(l){l.renameSheet(i,h);
});
});
this.forEachName(function(k,l){if(k.nameref.renameSheet(i,h)){this.undefineName(l);
k.name=k.nameref.print();
this.nameDefinition(k.name,k);
}if(k.value instanceof e||k.value instanceof c){k.value.renameSheet(i,h);
}}.bind(this));
j._name(h);
this.trigger("change",{sheetSelection:true});
return j;
},removeSheet:function(k){var m=this;
var l=m._sheets;
var i=k.name();
var h=m.sheetIndex(k);
if(l.length===1){return;
}this._sheetsSearchCache={};
if(h>-1){k.unbind();
l.splice(h,1);
if(m.activeSheet().name()===i){var j=l[h===l.length?h-1:h];
m.activeSheet(j);
}else{this.trigger("change",{recalc:true,sheetSelection:true});
}}},_clearSheets:function(){for(var h=0;
h<this._sheets.length;
h++){this._sheets[h].unbind();
}this._sheets=[];
this._sheetsSearchCache={};
this._names={};
},fromJSON:function(k){if(k.sheets){this._clearSheets();
for(var j=0;
j<k.sheets.length;
j++){var i=k.sheets[j];
var h=f(i,this.options);
var l=this.insertSheet({rows:h.rowCount,columns:h.columnCount,rowHeight:h.rowHeight,columnWidth:h.columnWidth,headerHeight:h.headerHeight,headerWidth:h.headerWidth,data:i});
if(i.dataSource){l.setDataSource(i.dataSource);
}}}if(k.activeSheet){this.activeSheet(this.sheetByName(k.activeSheet));
}else{this.activeSheet(this._sheets[0]);
}if(k.names){k.names.forEach(function(m){this.defineName(m.name,m.value,m.hidden);
},this);
}},toJSON:function(){this.resetFormulas();
this.resetValidations();
var h=Object.keys(this._names).map(function(j){var i=this._names[j];
var k=i.value;
if(k instanceof e||k instanceof c){k=k.print(0,0,true);
}else{if(k instanceof b){k=k+"";
}else{k=JSON.stringify(k);
}}return{value:k,hidden:i.hidden,name:i.name,sheet:i.nameref.sheet,localName:i.nameref.name};
},this);
return{activeSheet:this.activeSheet().name(),sheets:this._sheets.map(function(i){i.recalc(this._context);
i.revalidate(this._validationContext);
return i.toJSON();
},this),names:h};
},fromFile:function(j){var i=new a.Deferred();
var k=i.promise();
var h={file:j,promise:k};
if(j&&!this.trigger("excelImport",h)){this._clearSheets();
d.spreadsheet.readExcel(j,this,i);
}else{i.reject();
}return k;
},saveAsExcel:function(i){i=a.extend({},this.options.excel,i);
var h=this.toJSON();
if(!this.trigger("excelExport",{workbook:h})){var j=new d.ooxml.Workbook(h);
d.saveAs({dataURI:j.toDataURL(),fileName:h.fileName||i.fileName,proxyURL:i.proxyURL,forceProxy:i.forceProxy});
}},draw:function(j,h){if(typeof j=="function"&&!h){h=j;
j={};
}var k=[],l=this._sheets;
(function i(n){if(n<l.length){l[n].draw(d.spreadsheet.SHEETREF,j,function(o){k.push(o);
i(n+1);
});
}else{var m=k[0];
for(n=1;
n<k.length;
++n){m.children=m.children.concat(k[n].children);
}h(m);
}}(0));
},nameForRef:function(j,k){if(k===undefined){k=j.sheet;
}k=k.toLowerCase();
var l=j+"";
for(var i in this._names){var h=this._names[i];
var m=h.value;
if(m instanceof e){if(!m.sheet||m.sheet&&k==m.sheet.toLowerCase()){if(m+""==l){return h;
}}}}return{name:l};
},defineName:function(i,j,h){var k=d.spreadsheet.calc.parseNameDefinition(i,j);
i=k.name.print();
this._names[i.toLowerCase()]={value:k.value,hidden:h,name:i,nameref:k.name};
},undefineName:function(h){delete this._names[h.toLowerCase()];
},nameValue:function(h){h=h.toLowerCase();
if(h in this._names){return this._names[h].value;
}return null;
},nameDefinition:function(i,h){i=i.toLowerCase();
if(arguments.length>1){if(h===undefined){delete this._names[i];
}else{this._names[i]=h;
}}return this._names[i];
},forEachName:function(h){Object.keys(this._names).forEach(function(i){h(this._names[i],i);
},this);
},adjustNames:function(h,j,k,i){h=h.toLowerCase();
Object.keys(this._names).forEach(function(m){var l=this._names[m];
var n=l.value;
if(n instanceof e&&n.sheet.toLowerCase()==h){l.value=n.adjust(null,null,null,null,j,k,i);
}else{if(n instanceof c){n.adjust(h,j?"row":"col",k,i);
}}},this);
},options:{}});
function f(n,s){function t(i,j,y){return i!==undefined?i:j!==undefined?j:y;
}var w=t(n.rowCount,s.rows,200),l=t(n.columnCount,s.columns,50),x=t(n.rowHeight,s.rowHeight,20),m=t(n.columnWidth,s.columnWidth,64),o=t(n.headerHeight,s.headerHeight,20),p=t(n.headerWidth,s.headerWidth,32);
if(n.rows!==undefined){for(var q=0;
q<n.rows.length;
++q){var v=n.rows[q];
var u=t(v.index,q);
if(u>=w){w=u+1;
}if(v.cells){for(var r=0;
r<v.cells.length;
++r){var h=v.cells[r];
var k=t(h.index,r);
if(k>=l){l=k+1;
}}}}}return{rowCount:w,columnCount:l,rowHeight:x,columnWidth:m,headerHeight:o,headerWidth:p};
}d.spreadsheet.Workbook=g;
if(d.PDFMixin){d.PDFMixin.extend(g.prototype);
g.prototype.saveAsPDF=function(i){var j=new a.Deferred();
var k=j.promise();
var h={promise:k};
if(this.trigger("pdfExport",h)){return;
}this._drawPDF(i,j).then(function(l){return d.drawing.exportPDF(l);
}).done(function(l){d.saveAs({dataURI:l,fileName:i.fileName,proxyURL:i.proxyURL,forceProxy:i.forceProxy,proxyTarget:i.proxyTarget});
j.resolve();
}).fail(function(l){j.reject(l);
});
return k;
};
g.prototype._drawPDF=function(i){var j=new a.Deferred();
var h=function(k){j.resolve(k);
};
switch(i.area){case"workbook":i.workbook.draw(i,h);
break;
case"sheet":i.workbook.activeSheet().draw(i,h);
break;
case"selection":i.workbook.activeSheet().selection().draw(i,h);
break;
}return j.promise();
};
}}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/formulacontext",["kendo.core"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var f=kendo.spreadsheet;
var a=f.CellRef;
var d=f.RangeRef;
var g=f.UnionRef;
var c=f.NameRef;
var e=f.Ref;
var b=kendo.Class.extend({init:function(i){this.workbook=i;
},getRefCells:function(w,s,r,q,o){var y,p,E,t;
if(w instanceof a){y=this.workbook.sheetByName(w.sheet);
if(!y||!w.valid()){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];
}p=y.formula(w);
E=y.range(w.row,w.col).value();
if(p!=null||E!=null){return[{formula:p,value:E,row:w.row,col:w.col,sheet:w.sheet,hidden:s?y.columnWidth(w.col)===0||y.rowHeight(w.row)===0:false}];
}else{return[];
}}if(w instanceof d){t=this.workbook.sheetIndex(w.sheet);
var A=[],v=t;
if(w.endSheet){v=this.workbook.sheetIndex(w.endSheet);
if(t>v){var C=t;
t=v;
v=C;
}}if(t<0||v<0||!w.valid()){return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];
}while(t<=v){y=this.workbook.sheetByIndex(t++);
var B=y._grid.normalize(w.topLeft);
var k=y._grid.normalize(w.bottomRight);
var z=y._grid.cellRefIndex(B);
var m=y._grid.cellRefIndex(k);
var F=y._properties.iterator("value",z,m);
for(var l=B.col;
l<=k.col;
++l){for(var x=B.row;
x<=k.row;
++x){var u=y._grid.index(x,l);
p=y._properties.get("formula",u);
E=F.at(u);
if(p!=null||E!=null){A.push({formula:p,value:E,row:x,col:l,sheet:y.name(),hidden:s?y.columnWidth(l)===0||y.rowHeight(x)===0:false});
}}}}return A;
}if(w instanceof g){var j=[];
for(t=0;
t<w.refs.length;
++t){j=j.concat(this.getRefCells(w.refs[t],s,r,q,o));
}return j;
}if(w instanceof c){var D=this.nameValue(w,r,q,o);
if(D instanceof e){return this.getRefCells(D,s,r,q,o);
}return[{value:D==null?new kendo.spreadsheet.calc.runtime.CalcError("NAME"):D}];
}return[];
},nameValue:function(l,k,j,i){var m;
if(l.hasSheet()){m=this.workbook.nameValue(l.print());
}else{l=l.clone().setSheet(k,true);
m=this.workbook.nameValue(l.print());
if(m==null){m=this.workbook.nameValue(l.name);
}}if(m instanceof e){m=m.absolute(j,i);
}return m;
},getData:function(m,l,k,j){var n=m instanceof a;
if(m instanceof c){n=this.workbook.nameValue(m.name) instanceof a;
}var i=this.getRefCells(m,false,l,k,j).map(function(o){var p=o.value;
if(p instanceof kendo.spreadsheet.calc.runtime.Formula){p=p.value;
}return p;
});
return n?i[0]:i;
},onFormula:function(k){var m=this.workbook.sheetByName(k.sheet);
var l=k.row,i=k.col,n=k.value;
var j=m.formula({row:l,col:i});
if(j!==k){return false;
}if(n instanceof e){n=this.getData(n,k.sheet,l,i);
if(Array.isArray(n)){n=n[0];
}}if(n instanceof kendo.spreadsheet.calc.runtime.Matrix){n.each(function(q,p,o){m._value(l+p,i+o,q);
});
}else{m._value(l,i,n);
}clearTimeout(m._formulaContextRefresh);
m._formulaContextRefresh=setTimeout(function(){m.batch(function(){},{layout:true});
},50);
return true;
}});
var h=b.extend({onFormula:function(){return true;
}});
f.FormulaContext=b;
f.ValidationFormulaContext=h;
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/controller",["kendo.core"],b);
}(function(){(function(n){if(n.support.browser.msie&&n.support.browser.version<9){return;
}var a=n.jQuery;
var d=/:alphanum$/;
var c={up:"up",down:"down",left:"left",right:"right",home:"first-col","ctrl+left":"first-col",end:"last-col","ctrl+right":"last-col","ctrl+up":"first-row","ctrl+down":"last-row","ctrl+home":"first","ctrl+end":"last",pageup:"prev-page",pagedown:"next-page"};
var k={tab:"next","shift+tab":"previous",enter:"lower","shift+enter":"upper","delete":"clearContents",backspace:"clearContents","shift+:alphanum":"edit",":alphanum":"edit","ctrl+:alphanum":"ctrl","alt+ctrl+:alphanum":"edit",":edit":"edit"};
var g={wheel:"onWheel","*+mousedown":"onMouseDown",contextmenu:"onContextMenu","*+mousedrag":"onMouseDrag","*+mouseup":"onMouseUp","*+dblclick":"onDblClick",mousemove:"onMouseMove"};
var e={"*+pageup":"onPageUp","*+pagedown":"onPageDown",mouseup:"onMouseUp","*+cut":"onCut","*+paste":"onPaste","*+copy":"onCopy"};
var i={esc:"onEditorEsc",enter:"onEditorBlur","alt+enter":"insertNewline","shift+enter":"onEditorBlur",tab:"onEditorBlur","shift+tab":"onEditorBlur"};
var l=a.extend({focus:"onEditorBarFocus"},i);
var m=a.extend({focus:"onEditorCellFocus"},i);
var p={cell:"range",rowheader:"row",columnheader:"column",topcorner:"sheet",autofill:"autofill"};
function r(t){return t.map(function(u){return'[data-action="'+u+'"]';
}).join(",");
}var f=r(["cut","copy","paste","insert-left","insert-right","insert-above","insert-below"]);
var s=r(["unhide-row","unhide-column"]);
var b=[];
var q=[];
var j=[];
for(var o in c){b.push(o);
q.push("shift+"+o);
}for(o in k){j.push(o);
}e[b]="onAction";
e[q]="onShiftAction";
e[j]="onEntryAction";
m[b]="onEditorAction";
m[q]="onEditorShiftAction";
var h=n.Class.extend({init:function(t,u){this.view=t;
this.workbook(u);
this.container=a(t.container);
this.clipboardElement=a(t.clipboard);
this.cellContextMenu=t.cellContextMenu;
this.rowHeaderContextMenu=t.rowHeaderContextMenu;
this.colHeaderContextMenu=t.colHeaderContextMenu;
this.scroller=t.scroller;
this.tabstrip=t.tabstrip;
this.sheetsbar=t.sheetsbar;
t.nameEditor.bind("enter",this.onNameEditorEnter.bind(this));
t.nameEditor.bind("cancel",this.onNameEditorCancel.bind(this));
t.nameEditor.bind("select",this.onNameEditorSelect.bind(this));
t.nameEditor.bind("delete",this.onNameEditorDelete.bind(this));
this.editor=t.editor;
this.editor.bind("change",this.onEditorChange.bind(this));
this.editor.bind("activate",this.onEditorActivate.bind(this));
this.editor.bind("deactivate",this.onEditorDeactivate.bind(this));
this.editor.bind("update",this.onEditorUpdate.bind(this));
a(t.scroller).on("scroll",this.onScroll.bind(this));
this.listener=new n.spreadsheet.EventListener(this.container,this,g);
this._enableEditorEvents();
if(this.sheetsbar){this.sheetsbar.bind("select",this.onSheetBarSelect.bind(this));
this.sheetsbar.bind("reorder",this.onSheetBarReorder.bind(this));
this.sheetsbar.bind("rename",this.onSheetBarRename.bind(this));
this.sheetsbar.bind("remove",this.onSheetBarRemove.bind(this));
}this.cellContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.rowHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.colHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this));
this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on("contextmenu",false);
if(this.tabstrip){this.tabstrip.bind("action",this.onCommandRequest.bind(this));
this.tabstrip.bind("dialog",this.onDialogRequest.bind(this));
}},_enableEditorEvents:function(t){if(t===undefined||t){this.keyListener=new n.spreadsheet.EventListener(this.clipboardElement,this,e);
this.barKeyListener=new n.spreadsheet.EventListener(this.editor.barElement(),this,l);
this.inputKeyListener=new n.spreadsheet.EventListener(this.editor.cellElement(),this,m);
}else{this.keyListener.destroy();
this.barKeyListener.destroy();
this.inputKeyListener.destroy();
}},_execute:function(u){var v=this._workbook.execute(u);
if(u.command==="EditCommand"&&!v){this._workbook.trigger("change",{editorClose:true});
}if(v){var t;
if(this.view.editor.isActive()){this.enableEditor(false);
t=this.enableEditor.bind(this,true,true);
}if(v.reason==="error"){this._lastCommandRequest=null;
this.view.showError(v,t);
}else{this.view.openDialog(v.reason,{close:t});
}}return v;
},_activeTooltip:function(){return this._workbook.activeSheet().activeCell().simplify().toString();
},onContextMenuSelect:function(v){var t=a(v.item).data("action");
var u;
switch(t){case"cut":u={command:"ToolbarCutCommand",options:{workbook:this._workbook}};
break;
case"copy":u={command:"ToolbarCopyCommand",options:{workbook:this._workbook}};
break;
case"paste":u={command:"ToolbarPasteCommand",options:{workbook:this._workbook}};
break;
case"unmerge":u={command:"MergeCellCommand",options:{value:"unmerge"}};
break;
case"merge":this.view.openDialog("merge");
break;
case"hide-row":u={command:"HideLineCommand",options:{axis:"row"}};
break;
case"hide-column":u={command:"HideLineCommand",options:{axis:"column"}};
break;
case"unhide-row":u={command:"UnHideLineCommand",options:{axis:"row"}};
break;
case"unhide-column":u={command:"UnHideLineCommand",options:{axis:"column"}};
break;
case"delete-row":u={command:"DeleteRowCommand"};
break;
case"delete-column":u={command:"DeleteColumnCommand"};
break;
}if(u){this._execute(u);
}},onSheetBarRemove:function(t){var u=this._workbook.sheetByName(t.name);
if(!u){return;
}this._workbook.removeSheet(u);
},destroy:function(){this.listener.destroy();
this._enableEditorEvents(false);
this.keyListener.destroy();
this.inputKeyListener.destroy();
},onSheetBarSelect:function(t){var u;
var v=this._workbook;
if(t.isAddButton){u=v.insertSheet();
}else{u=v.sheetByName(t.name);
}if(v.activeSheet().name()!==u.name()){v.activeSheet(u);
}},onSheetBarReorder:function(t){var u=this._workbook.sheetByIndex(t.oldIndex);
this._workbook.moveSheetToIndex(u,t.newIndex);
this._workbook.activeSheet(u);
},onSheetBarRename:function(t){var u=this._workbook.sheetByIndex(t.sheetIndex);
this._workbook.renameSheet(u,t.name);
this.clipboardElement.focus();
},sheet:function(t){this.navigator=t.navigator();
this.axisManager=t.axisManager();
},workbook:function(t){this._workbook=t;
this.clipboard=t.clipboard();
t.bind("commandRequest",this.onCommandRequest.bind(this));
},refresh:function(){var u=this.editor;
var x=this._workbook;
var w=x.activeSheet();
this._viewPortHeight=this.view.scroller.clientHeight;
this.navigator.height(this._viewPortHeight);
if(!u.isActive()&&!this.isEditorDisabled){u.enable(w.selection().enable()!==false);
u.value(x._inputForRef(w.activeCell()));
}var v=w.selection()._ref.simplify();
var t=this._workbook.nameForRef(v,w.name());
this.view.nameEditor.value(t.name);
},onScroll:function(){this.view.render();
},onWheel:function(v){var t=v.originalEvent.deltaX;
var u=v.originalEvent.deltaY;
if(v.originalEvent.deltaMode===1){t*=10;
u*=10;
}this.scrollWith(t,u);
v.preventDefault();
},onAction:function(u,t){this.navigator.moveActiveCell(c[t]);
u.preventDefault();
},onPageUp:function(){this.scrollDown(-this._viewPortHeight);
},onPageDown:function(){this.scrollDown(this._viewPortHeight);
},onEntryAction:function(v,t){if(v.mod){var x=true;
var w=String.fromCharCode(v.keyCode);
switch(w){case"A":this.navigator.selectAll();
break;
case"Y":this._workbook.undoRedoStack.redo();
break;
case"Z":this._workbook.undoRedoStack.undo();
break;
default:x=false;
break;
}if(x){v.preventDefault();
}}else{var u=this._workbook.activeSheet().selection().enable()===false;
if(t=="delete"||t=="backspace"){if(!u){this._execute({command:"ClearContentCommand"});
}v.preventDefault();
}else{if(d.test(t)||t===":edit"){if(u){v.preventDefault();
return;
}if(t!==":edit"){this.editor.value("");
}this.editor.activate({range:this._workbook.activeSheet()._viewActiveCell(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()}).focus();
}else{this.navigator.navigateInSelection(k[t]);
v.preventDefault();
}}}},onShiftAction:function(u,t){this.navigator.modifySelection(c[t.replace("shift+","")],this.appendSelection);
u.preventDefault();
},onMouseMove:function(t){var v=this._workbook.activeSheet();
if(v.resizingInProgress()||v.selectionInProgress()){return;
}var u=this.objectAt(t);
if(u.type==="columnresizehandle"||u.type==="rowresizehandle"){v.positionResizeHandle(u.ref);
}else{v.removeResizeHandle();
}},onMouseDown:function(t){var u=this.objectAt(t);
if(u.pane){this.originFrame=u.pane;
}if(u.type==="editor"){this.onEditorEsc();
this.openCustomEditor();
t.preventDefault();
return;
}if(this.editor.canInsertRef(false)&&u.ref){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
this.navigator.startSelection(u.ref,this._selectionMode,this.appendSelection,t.shiftKey);
t.preventDefault();
return;
}else{this.editor.deactivate();
if(this.editor.isActive()){t.preventDefault();
return;
}}var v=this._workbook.activeSheet();
if(u.type==="columnresizehandle"||u.type==="rowresizehandle"){v.startResizing({x:u.x,y:u.y});
t.preventDefault();
return;
}if(u.type==="filtericon"){this.openFilterMenu(t);
t.preventDefault();
return;
}this._selectionMode=p[u.type];
this.appendSelection=t.mod;
this.navigator.startSelection(u.ref,this._selectionMode,this.appendSelection,t.shiftKey);
},onContextMenu:function(t){var y=this._workbook.activeSheet();
if(y.resizingInProgress()){return;
}t.preventDefault();
this.cellContextMenu.close();
this.colHeaderContextMenu.close();
this.rowHeaderContextMenu.close();
var w;
var v={pageX:t.pageX,pageY:t.pageY};
var x=this.objectAt(v);
if(x.type==="columnresizehandle"||x.type==="rowresizehandle"){return;
}this.navigator.selectForContextMenu(x.ref,p[x.type]);
var u=this.navigator._sheet.select() instanceof n.spreadsheet.UnionRef;
var z=false;
var A=false;
if(x.type=="columnheader"){w=this.colHeaderContextMenu;
z=!u&&this.axisManager.selectionIncludesHiddenColumns();
}else{if(x.type=="rowheader"){w=this.rowHeaderContextMenu;
z=!u&&this.axisManager.selectionIncludesHiddenRows();
}else{w=this.cellContextMenu;
A=this.navigator.selectionIncludesMergedCells();
}}w.element.find(f).toggle(!u);
w.element.find(s).toggle(z);
w.element.find("[data-action=unmerge]").toggle(A);
setTimeout(function(){w.open(t.pageX,t.pageY);
});
},prevent:function(t){t.preventDefault();
},constrainResize:function(w,t){var v=this._workbook.activeSheet();
var u=v.resizeHandlePosition();
return !u||w==="outside"||w==="topcorner"||t.col<u.col||t.row<u.row;
},onMouseDrag:function(t){if(this._selectionMode==="sheet"){return;
}var v={pageX:t.pageX,pageY:t.pageY};
var w=this.objectAt(v);
var x=this._workbook.activeSheet();
if(x.resizingInProgress()){if(!this.constrainResize(w.type,w.ref)){x.resizeHintPosition({x:w.x,y:w.y});
}return;
}if(w.type==="outside"){this.startAutoScroll(w);
return;
}if(this.originFrame===w.pane){this.selectToLocation(v);
}else{var u=this.originFrame._grid;
if(w.x>u.right){this.scrollLeft();
}if(w.y>u.bottom){this.scrollTop();
}if(w.y<u.top||w.x<u.left){this.startAutoScroll(w,v);
}else{this.selectToLocation(v);
}}t.preventDefault();
},onMouseUp:function(v){var x=this._workbook.activeSheet();
x.completeResizing();
this.navigator.completeSelection();
this.stopAutoScroll();
var t=this.editor.activeEditor();
if(!t){return;
}var u=v.target;
while(u){if(u===t.element[0]){return;
}u=u.parentNode;
}var w=this.objectAt(v);
if(w&&w.ref&&t.canInsertRef(false)){t.refAtPoint(x.selection()._ref);
x._setFormulaSelections(t.highlightedRefs());
}},onDblClick:function(u){var v=this.objectAt(u);
var t=this._workbook.activeSheet().selection().enable()===false;
if(v.type!=="cell"||t){return;
}this.editor.activate({range:this._workbook.activeSheet()._viewActiveCell(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()}).focus();
this.onEditorUpdate();
},onCut:function(t){if(t){var u=this.clipboardElement.find("table.kendo-clipboard-"+this.clipboard._uid).detach();
this.clipboardElement.append(u.clone(false));
setTimeout(function(){this.clipboardElement.empty().append(u);
}.bind(this));
}this._execute({command:"CutCommand",options:{workbook:this.view._workbook}});
},clipBoardValue:function(){return this.clipboardElement.html();
},onPaste:function(t){var w="";
var x="";
this.clipboard.menuInvoked=t===undefined;
if(t){if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.getData){t.preventDefault();
var u=false;
var v=false;
if(window.DOMStringList&&t.originalEvent.clipboardData.types instanceof window.DOMStringList){u=t.originalEvent.clipboardData.types.contains("text/html");
v=t.originalEvent.clipboardData.types.contains("text/plain");
}else{u=/text\/html/.test(t.originalEvent.clipboardData.types);
v=/text\/plain/.test(t.originalEvent.clipboardData.types);
}if(u){w=t.originalEvent.clipboardData.getData("text/html");
}if(v){x=t.originalEvent.clipboardData.getData("text/plain").trim();
}}else{var y=this.clipboardElement.find("table.kendo-clipboard-"+this.clipboard._uid).detach();
this.clipboardElement.empty();
setTimeout(function(){var z=this.clipboardElement.html();
var A=window.clipboardData.getData("Text").trim();
if(!z&&!A){return;
}this.clipboard.external({html:z,plain:A});
this.clipboardElement.empty().append(y);
this._execute({command:"PasteCommand",options:{workbook:this.view._workbook}});
this.clipboard.menuInvoked=true;
}.bind(this));
return;
}}else{if(n.support.browser.msie){this.clipboardElement.focus().select();
document.execCommand("paste");
return;
}else{this.clipboard.menuInvoked=true;
}}if(!w&&!x){return;
}this.clipboard.external({html:w,plain:x});
this._execute({command:"PasteCommand",options:{workbook:this.view._workbook}});
},onCopy:function(t){this.clipboard.menuInvoked=t===undefined;
this._execute({command:"CopyCommand",options:{workbook:this.view._workbook}});
},scrollTop:function(){this.scroller.scrollTop=0;
},scrollLeft:function(){this.scroller.scrollLeft=0;
},scrollDown:function(t){this.scroller.scrollTop+=t;
},scrollRight:function(t){this.scroller.scrollLeft+=t;
},scrollWith:function(u,t){this.scroller.scrollTop+=t;
this.scroller.scrollLeft+=u;
},objectAt:function(u){var v=this.container.offset();
var t={left:u.pageX-v.left,top:u.pageY-v.top};
return this.view.objectAt(t.left,t.top);
},selectToLocation:function(t){var u=this.objectAt(t);
if(u.pane){this.extendSelection(u);
this.lastKnownCellLocation=t;
this.originFrame=u.pane;
}this.stopAutoScroll();
},extendSelection:function(t){this.navigator.extendSelection(t.ref,this._selectionMode,this.appendSelection);
},autoScroll:function(){var A=this._autoScrollTarget.x;
var B=this._autoScrollTarget.y;
var t=this.originFrame._grid;
var u=this.view.scroller;
var w=8;
var v=u.scrollLeft;
var z=u.scrollTop;
if(A<t.left){this.scrollRight(-w);
}if(A>t.right){this.scrollRight(w);
}if(B<t.top){this.scrollDown(-w);
}if(B>t.bottom){this.scrollDown(w);
}if(z===u.scrollTop&&v===u.scrollLeft){this.selectToLocation(this.finalLocation);
}else{this.extendSelection(this.objectAt(this.lastKnownCellLocation));
}},startAutoScroll:function(u,t){if(!this._scrollInterval){this._scrollInterval=setInterval(this.autoScroll.bind(this),50);
}this.finalLocation=t||this.lastKnownCellLocation;
this._autoScrollTarget=u;
},stopAutoScroll:function(){clearInterval(this._scrollInterval);
this._scrollInterval=null;
},openCustomEditor:function(){this.view.openCustomEditor();
},openFilterMenu:function(u){var w=this.objectAt(u);
var x=this._workbook.activeSheet();
var t=x.filterColumn(w.ref);
var v=this.view.createFilterMenu(t);
v.bind("action",this.onCommandRequest.bind(this));
v.bind("action",v.close.bind(v));
v.openFor(u.target);
},onEditorChange:function(t){this._workbook.activeSheet().isInEditMode(false);
var u=this._execute({command:"EditCommand",options:{editActiveCell:true,value:t.value}});
if(u&&u.reason==="error"){t.preventDefault();
}},onEditorActivate:function(){var u=this._workbook;
var t=u.activeSheet();
t._setFormulaSelections(this.editor.highlightedRefs());
t.isInEditMode(true);
},onEditorDeactivate:function(){var t=this._workbook.activeSheet();
t.isInEditMode(false);
t._setFormulaSelections([]);
},onEditorUpdate:function(){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());
},onEditorBarFocus:function(){var t=this._workbook.activeSheet().selection().enable()===false;
if(t){return;
}this.editor.activate({range:this._workbook.activeSheet()._viewActiveCell(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()});
},onEditorCellFocus:function(){this.editor.scale();
},onEditorEsc:function(){this.resetEditorValue();
this.editor.deactivate();
this.clipboardElement.focus();
},insertNewline:function(t){t.preventDefault();
this.editor.insertNewline();
},onEditorBlur:function(t,u){if(this.editor.isFiltered()){return;
}this.editor.deactivate();
if(!this.editor.isActive()){this.clipboardElement.focus();
this.navigator.navigateInSelection(k[u]);
}},onEditorAction:function(v,t){var u=this.editor;
var w=this._workbook.activeSheet();
if(u.canInsertRef(true)){this.navigator.moveActiveCell(c[t]);
u.activeEditor().refAtPoint(w.selection()._ref);
w._setFormulaSelections(u.highlightedRefs());
v.preventDefault();
}},onEditorShiftAction:function(v,t){var u=this.editor;
var w=this._workbook.activeSheet();
if(u.canInsertRef(true)){this.navigator.modifySelection(c[t.replace("shift+","")],this.appendSelection);
u.activeEditor().refAtPoint(w.selection()._ref);
w._setFormulaSelections(u.highlightedRefs());
v.preventDefault();
}},resetEditorValue:function(){this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));
},deactivateEditor:function(t,u){var v=this.view.editor;
this._lastCommandRequest={callback:t,options:u};
if(!this.isEditorDeactivateBound){this.isEditorDeactivateBound=true;
v.one("deactivate",function(){this.isEditorDeactivateBound=false;
if(this._lastCommandRequest){this._lastCommandRequest.callback(this._lastCommandRequest.options);
this._lastCommandRequest=null;
}}.bind(this));
}v.deactivate();
this.enableEditor(false);
},enableEditor:function(t,v,u){if(u&&u.action==="revert"){this.resetEditorValue();
}t=t===undefined||t;
this._enableEditorEvents(t);
this.editor.enableEditing(t);
this.isEditorDisabled=!t;
this.view.enableClipboard(t);
if(v){this.editor.focusLastActive();
}},executeRequest:function(t,u){if(this.view.editor.isActive()){this.deactivateEditor(t,u);
}else{t(u);
}},onCommandRequest:function(t){var u=function(v){if(v.command){this._execute(v);
}else{this._workbook.undoRedoStack[v.action]();
}}.bind(this);
this.executeRequest(u,t);
},onDialogRequest:function(t){var u=function(w){this.enableEditor(false);
var v={pdfExport:this._workbook.options.pdf,excelExport:this._workbook.options.excel,close:this.enableEditor.bind(this,true,false)};
if(w.options){a.extend(true,w.options,v);
}else{w.options=v;
}this.view.openDialog(w.name,w.options);
}.bind(this);
this.executeRequest(u,t);
},onNameEditorEnter:function(){var u;
var x=this._workbook;
var v=x.activeSheet();
var t=this.view.nameEditor.value();
u=n.spreadsheet.calc.parseReference(t,true)||x.nameValue(t);
if(u instanceof n.spreadsheet.Ref){if(u.sheet&&u.sheet.toLowerCase()!=v.name().toLowerCase()){var w=x.sheetByName(u.sheet);
if(w){x.activeSheet(w);
v=w;
}}v.range(u).select();
return;
}u=v.selection()._ref.clone().simplify().setSheet(v.name(),true);
this._execute({command:"DefineNameCommand",options:{name:t,value:u}});
this.clipboardElement.focus();
},onNameEditorCancel:function(){this.clipboardElement.focus();
},onNameEditorSelect:function(t){var u=t.name;
var y=this._workbook;
var w=y.activeSheet();
var v=y.nameValue(u);
if(v instanceof n.spreadsheet.Ref){if(v.sheet&&v.sheet.toLowerCase()!=w.name().toLowerCase()){var x=y.sheetByName(v.sheet);
if(x){y.activeSheet(x);
w=x;
}}w.range(v).select();
return;
}this.clipboardElement.focus();
},onNameEditorDelete:function(t){this._execute({command:"DeleteNameCommand",options:{name:t.name}});
this.clipboardElement.focus();
}});
n.spreadsheet.Controller=h;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/view",["kendo.core","kendo.menu","spreadsheet/sheetsbar"],b);
}(function(){(function(m){if(m.support.browser.msie&&m.support.browser.version<9){return;
}var a=m.jQuery;
var h=m.spreadsheet.CellRef;
var j=".";
var p=7;
var u={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",editContainer:"k-spreadsheet-edit-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-wrapper",filterRange:"k-filter-range",filterButton:"k-spreadsheet-filter",filterButtonActive:"k-state-active",horizontalResize:"k-horizontal-resize",verticalResize:"k-vertical-resize",icon:"k-icon k-font-icon",iconFilterDefault:"k-i-arrow-s",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu"};
m.spreadsheet.messages.view={errors:{openUnsupported:"Unsupported format. Please select an .xlsx file.",shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.",filterRangeContainingMerges:"Cannot create a filter within a range containing merges",sortRangeContainingMerges:"Cannot sort a range containing merges",validationError:"The value that you entered violates the validation rules set on the cell."},tabs:{home:"Home",insert:"Insert",data:"Data"}};
function r(w){var y=window.getSelection();
y.removeAllRanges();
var x=document.createRange();
x.selectNodeContents(w);
y.addRange(x);
}function f(y,x){var w=y.trs[x].children;
return w[w.length-2];
}function e(z,y){var x=z.trs[y-1];
var w=z.trs[y].children.length-1;
if(x&&w>=0){return x.children[w];
}}function g(w){return["solid",(w.size||1)+"px",w.color||"#000"].join(" ");
}function c(w){if(!/:\/\//.test(w)){w="http://"+w;
}return w;
}function k(B,x,A,F,P,K){function I(S){var T=x.link;
if(!T){if(typeof x.value=="object"){T=x.value.link;
}}if(T){var U={textDecoration:"none"};
if(x.color){U.color=x.color;
}if(x.underline){U.textDecoration="underline";
}return m.dom.element("a",{href:c(T),style:U,target:"_blank"},S?[S]:[]);
}return S;
}if(!A&&!m.spreadsheet.draw.shouldDrawCell(x)){return;
}var H=x.left;
var M=x.top;
var R=x.width+1;
var G=x.height+1;
var L={};
var w=x.background;
var D=null;
if(w){D=w;
if(K){D=m.parseColor(D).toHSV();
D.v*=0.9;
D=D.toCssRgba();
}D=g({color:D});
}if(w){L.backgroundColor=w;
}if(x.color){L.color=x.color;
}if(x.fontFamily){L.fontFamily=x.fontFamily;
}if(x.underline){L.textDecoration="underline";
}if(x.italic){L.fontStyle="italic";
}if(x.textAlign){L.textAlign=x.textAlign;
}if(x.bold){L.fontWeight="bold";
}if(x.fontSize){L.fontSize=x.fontSize+"px";
}if(x.wrap===true){L.whiteSpace="pre-wrap";
L.wordBreak="break-all";
}if(x.borderLeft){L.borderLeft=g(x.borderLeft);
if(P){P[x.left]=true;
}}else{if(D&&P&&!P[x.left]){L.borderLeft=D;
}else{H++;
R--;
}}if(x.borderTop){L.borderTop=g(x.borderTop);
if(F){F[x.top]=true;
}}else{if(D&&F&&!F[x.top]){L.borderTop=D;
}else{M++;
G--;
}}if(x.borderRight){L.borderRight=g(x.borderRight);
if(P){P[x.right]=true;
}}else{if(D&&P&&!P[x.right]){L.borderRight=D;
}else{R--;
}}if(x.borderBottom){L.borderBottom=g(x.borderBottom);
if(F){F[x.bottom]=true;
}}else{if(D&&F&&!F[x.bottom]){L.borderBottom=D;
}else{G--;
}}L.left=H+"px";
L.top=M+"px";
L.width=R+"px";
L.height=G+"px";
var C=x.value,N=typeof C;
if(x.format&&C!=null){C=m.spreadsheet.formatting.format(C,x.format);
if(C.__dataType){N=C.__dataType;
}}else{if(C!==null&&C!==undefined){C=m.dom.text(C);
}}if(!L.textAlign){switch(N){case"number":case"date":case"percent":L.textAlign="right";
break;
case"boolean":L.textAlign="center";
break;
}}var z=[o.cell];
if(A){z.push(A);
}if(x.enable===false){z.push("k-state-disabled");
}if(x.merged){z.push("k-spreadsheet-merged-cell");
}var Q=x.verticalAlign||"bottom";
if(Q&&C){C=m.dom.element("div",{className:"k-vertical-align-"+Q},[I(C)]);
}else{C=I(C);
}var y=C?[C]:[];
var J={style:L};
var O=x.validation;
if(O&&!O.value){y.push(m.dom.element("span",{className:"k-dirty"}));
z.push("k-dirty-cell");
J.title=O._getOptions().messageTemplate;
}J.className=z.join(" ");
var E=m.dom.element("div",J,y);
B.push(E);
return E;
}function b(D,A,x){var C={};
if(x.background){C.backgroundColor=x.background;
}if(x.color){C.color=x.color;
}if(x.fontFamily){C.fontFamily=x.fontFamily;
}if(x.underline){C.textDecoration="underline";
}if(x.italic){C.fontStyle="italic";
}if(x.textAlign){C.textAlign=x.textAlign;
}if(x.verticalAlign){C.verticalAlign=x.verticalAlign==="center"?"middle":x.verticalAlign;
}if(x.bold){C.fontWeight="bold";
}if(x.fontSize){C.fontSize=x.fontSize+"px";
}if(x.wrap===true){C.whiteSpace="pre-wrap";
C.wordBreak="break-all";
}if(x.borderRight){C.borderRight=g(x.borderRight);
}else{if(x.background){C.borderRightColor=x.background;
}}if(x.borderBottom){C.borderBottom=g(x.borderBottom);
}else{if(x.background){C.borderBottomColor=x.background;
}}var z=x.value,F=typeof z;
if(x.format&&z!=null){z=m.spreadsheet.formatting.format(z,x.format);
if(z.__dataType){F=z.__dataType;
}}if(!C.textAlign){switch(F){case"number":case"date":case"percent":C.textAlign="right";
break;
case"boolean":C.textAlign="center";
break;
}}var y=null;
if(x.enable===false){y="k-state-disabled";
}var E=D.addCell(A,z,C,y,x.validation);
var w,B;
if(x.borderLeft){B=f(D,A);
w=g(x.borderLeft);
if(B&&w){B.attr.style.borderRight=w;
}}else{if(x.background){C.borderLeftColor=x.background;
}}if(x.borderTop){B=e(D,A);
w=g(x.borderTop);
if(B&&w){B.attr.style.borderBottom=w;
}}else{if(x.background){C.borderTopColor=x.background;
}}return E;
}var l=m.Class.extend({init:function(){this.cols=[];
this.trs=[];
this._height=0;
this._width=0;
},addColumn:function(x){this._width+=x;
var w=m.dom.element("col",{style:{width:x+"px"}});
w.visible=x>0;
this.cols.push(w);
},addRow:function(x){var w=null;
w={style:{height:x+"px"}};
this._height+=x;
var y=m.dom.element("tr",w);
y.visible=x>0;
this.trs.push(y);
},addCell:function(z,C,A,x,D){if(C===null||C===undefined){C="";
}if(!(C instanceof m.dom.Node)){C=m.dom.text(C);
}var w=[C];
var y={style:A};
if(D&&!D.value){w.push(m.dom.element("span",{className:"k-dirty"}));
x=(x||"")+(x?" ":"")+"k-dirty-cell";
y.title=D._getOptions().messageTemplate;
}if(x){y.className=x;
}var B=m.dom.element("td",y,w);
this.trs[z].children.push(B);
return B;
},toDomTree:function(A,B,w){this.trs=this.trs.filter(function(x){return x.visible;
});
var z=0;
this.cols=this.cols.filter(function(y,x){if(!y.visible){this.trs.forEach(function(C){C.children.splice(x-z,1);
});
z++;
}return y.visible;
},this);
return m.dom.element("table",{style:{left:A+"px",top:B+"px",height:this._height+"px",width:this._width+"px"},className:w},[m.dom.element("colgroup",null,this.cols),m.dom.element("tbody",null,this.trs)]);
}});
var d='<ul class="#=classNames.cellContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action=merge>Merge</li><li data-action=unmerge>Unmerge</li></ul>';
var q='<ul class="#=classNames.rowHeaderContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action="delete-row">Delete</li><li data-action="hide-row">Hide</li><li data-action="unhide-row">Unhide</li></ul>';
var i='<ul class="#=classNames.colHeaderContextMenu#"><li data-action=cut>Cut</li><li data-action=copy>Copy</li><li data-action=paste>Paste</li><li class="k-separator"></li><li data-action="delete-column">Delete</li><li data-action="hide-column">Hide</li><li data-action="unhide-column">Unhide</li></ul>';
m.spreadsheet.ContextMenu=m.ui.ContextMenu;
var t=m.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div><div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div>'+d+q+i);
function v(y,x,w){return y>=x&&y<=w;
}var s=m.Class.extend({init:function(y,z){var w=s.classNames;
this.element=y;
this.options=a.extend(true,{messages:m.spreadsheet.messages.view},this.options,z);
this._chrome();
this._dialogs=[];
y.append(t({classNames:w}));
this._formulaInput();
this.wrapper=y.find(j+w.view);
this.container=y.find(j+w.fixedContainer)[0];
this.scroller=y.find(j+w.scroller)[0];
this.clipboard=y.find(j+w.clipboard);
this.viewSize=a(this.scroller.firstChild);
this.tree=new m.dom.Tree(this.container);
this.clipboardContents=new m.dom.Tree(this.clipboard[0]);
this.editor=new m.spreadsheet.SheetEditor(this);
this._sheetsbar();
var x={target:y,animation:false,showOn:"never"};
this.cellContextMenu=new m.spreadsheet.ContextMenu(y.find(j+w.cellContextMenu),x);
this.colHeaderContextMenu=new m.spreadsheet.ContextMenu(y.find(j+w.colHeaderContextMenu),x);
this.rowHeaderContextMenu=new m.spreadsheet.ContextMenu(y.find(j+w.rowHeaderContextMenu),x);
var A=m.support.scrollbar();
a(this.container).css({width:this.wrapper[0].clientWidth-A,height:this.wrapper[0].clientHeight-A});
},enableClipboard:function(w){this.isClipboardDeactivated=!w;
if(w){this.clipboard.attr("contenteditable",w);
}else{this.clipboard.removeAttr("contenteditable");
}},_resize:function(){var y=this.tabstrip?this.tabstrip.element.outerHeight():0;
var w=this.formulaBar?this.formulaBar.element.outerHeight():0;
var x=this.sheetsbar?this.sheetsbar.element.outerHeight():0;
this.wrapper.height(this.element.height()-(y+w+x));
if(this.tabstrip){this.tabstrip.quickAccessAdjust();
}},_chrome:function(){var y=a("<div class='k-spreadsheet-action-bar' />").prependTo(this.element);
var x=a("<div class='k-spreadsheet-name-editor' />").appendTo(y);
this.nameEditor=new m.spreadsheet.NameEditor(x);
var w=a("<div />").appendTo(y);
this.formulaBar=new m.spreadsheet.FormulaBar(w);
if(this.options.toolbar){this._tabstrip();
}},_formulaInput:function(){var w=this.element.find(j+s.classNames.cellEditor);
this.formulaInput=new m.spreadsheet.FormulaInput(w,{autoScale:true});
},_sheetsbar:function(){if(this.options.sheetsbar){this.sheetsbar=new m.spreadsheet.SheetsBar(this.element.find(j+s.classNames.sheetsBar),a.extend(true,{},this.options.sheetsbar));
}},_tabstrip:function(){var w=this.options.messages.tabs;
var y=a.extend(true,{home:true,insert:true,data:true},this.options.toolbar);
var z=[];
if(this.tabstrip){this.tabstrip.destroy();
this.element.children(".k-tabstrip").remove();
}for(var x in y){if(y[x]===true||y[x] instanceof Array){z.push({id:x,text:w[x],content:""});
}}this.tabstrip=new m.spreadsheet.TabStrip(a("<div />").prependTo(this.element),{animation:false,dataTextField:"text",dataContentField:"content",dataSource:z,toolbarOptions:y,view:this});
this.tabstrip.select(0);
},_executeCommand:function(w){this._workbook.execute(w);
},workbook:function(w){this._workbook=w;
this.nameEditor._workbook=w;
},sheet:function(w){this._sheet=w;
},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell());
},_rectangle:function(w,x){return w._grid.boundingRectangle(x.toRangeRef());
},isColumnResizer:function(C,y,A){var z=this._rectangle(y,A);
C-=this._sheet._grid._headerWidth;
var w=p/2;
var B=z.right-this.scroller.scrollLeft;
return B-w<=C&&C<=B+w;
},isRowResizer:function(C,z,B){var A=this._rectangle(z,B);
C-=this._sheet._grid._headerHeight;
var x=p/2;
var w=A.bottom-this.scroller.scrollTop;
return w-x<=C&&C<=w+x;
},isFilterIcon:function(B,C,w,z){var A=false;
B-=this._sheet._grid._headerWidth-this.scroller.scrollLeft;
C-=this._sheet._grid._headerHeight-this.scroller.scrollTop;
this._sheet.forEachFilterHeader(z,function(y){var x=this._rectangle(w,y);
A=A||w.filterIconRect(x).intersects(B,C);
}.bind(this));
return A;
},isAutoFill:function(B,C,w){var A=this._sheet.select();
if(A.size>1){return false;
}B-=this._sheet._grid._headerWidth;
C-=this._sheet._grid._headerHeight;
if(!w._grid.columns.frozen){B+=this.scroller.scrollLeft;
}if(!w._grid.rows.frozen){C+=this.scroller.scrollTop;
}var z=this._rectangle(w,A);
return Math.abs(z.right-B)<8&&Math.abs(z.bottom-C)<8;
},isEditButton:function(A,B){var w=this._sheet.activeCellCustomEditor();
if(w){var z=this.activeCellRectangle();
if(A>z.right&&A<=z.right+20&&B>=z.top&&B<=z.bottom){return true;
}}},objectAt:function(G,H){var z=this._sheet._grid;
var A,B;
if(G<0||H<0||G>this.scroller.clientWidth||H>this.scroller.clientHeight){A={type:"outside"};
}else{if(G<z._headerWidth&&H<z._headerHeight){A={type:"topcorner"};
}else{B=this.paneAt(G,H);
if(!B){A={type:"outside"};
}else{var D=B._grid.rows.index(H,this.scroller.scrollTop);
var w=B._grid.columns.index(G,this.scroller.scrollLeft);
var F="cell";
var C=new h(D,w);
var E=this._sheet.selectionInProgress();
if(this.isAutoFill(G,H,B)){F="autofill";
}else{if(this.isFilterIcon(G,H,B,C)){F="filtericon";
}else{if(!E&&G<z._headerWidth){C=new h(D,-Infinity);
F=this.isRowResizer(H,B,C)?"rowresizehandle":"rowheader";
}else{if(!E&&H<z._headerHeight){C=new h(-Infinity,w);
F=this.isColumnResizer(G,B,C)?"columnresizehandle":"columnheader";
}else{if(this.isEditButton(G,H)){F="editor";
}}}}}A={type:F,ref:C};
}}}A.pane=B;
A.x=G;
A.y=H;
return A;
},paneAt:function(z,A){return this.panes.filter(function w(y){var x=y._grid;
return v(A,x.top,x.bottom)&&v(z,x.left,x.right);
})[0];
},containingPane:function(w){return this.panes.filter(function(x){if(x._grid.contains(w)){return true;
}return false;
})[0];
},cellRectangle:function(w){var y=this.containingPane(w)._grid;
var x=this._sheet._grid.rectangle(w);
return x.offset(y.headerWidth-(y.columns.frozen?0:this.scroller.scrollLeft),y.headerHeight-(y.rows.frozen?0:this.scroller.scrollTop));
},refresh:function(y){var z=this._sheet;
if(this.tabstrip){this.tabstrip.refreshTools(z.range(z.activeCell()));
}if(y.sheetSelection&&this.sheetsbar){this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet));
}this._resize();
this.viewSize[0].style.height=z._grid.totalHeight()+"px";
this.viewSize[0].style.width=z._grid.totalWidth()+"px";
if(y.layout){var w=z.frozenColumns();
var x=z.frozenRows();
this.panes=[this._pane(x,w)];
if(w>0){this.panes.push(this._pane(x,0,null,w));
}if(x>0){this.panes.push(this._pane(0,w,x,null));
}if(x>0&&w>0){this.panes.push(this._pane(0,0,x,w));
}}if(y.filter){this._destroyFilterMenu();
}if(y.activeCell){this._focus=z.activeCell().toRangeRef();
}},createFilterMenu:function(w){if(this._filterMenu&&this._filterMenu.options.column==w){return this._filterMenu;
}this._destroyFilterMenu();
var C=this._sheet;
var B=C.filter().ref;
var A=new m.spreadsheet.Range(B,C);
var x=a("<div />").appendTo(this.element);
var z={column:w,range:A};
var y=new m.spreadsheet.FilterMenu(x,z);
this._filterMenu=y;
return y;
},selectClipBoardContents:function(){if(!this.isClipboardDeactivated){this.clipboard.focus();
r(this.clipboard[0]);
}},scrollIntoView:function(x){var C=false;
var B=this.containingPane(x)._grid;
var w=B.scrollBoundaries(x);
var y=this.scroller;
var A=B.rows.frozen?0:y.scrollTop;
var z=B.columns.frozen?0:y.scrollLeft;
if(w.top<A){C=true;
y.scrollTop=w.scrollTop;
}if(w.bottom>A){C=true;
y.scrollTop=w.scrollBottom;
}if(w.left<z){C=true;
y.scrollLeft=w.scrollLeft;
}if(w.right>z){C=true;
y.scrollLeft=w.scrollRight;
}return C;
},_destroyDialog:function(){this._dialogs.pop();
},openCustomEditor:function(){var z=this;
var w=z._sheet.activeCell().first();
var x=z._sheet.activeCellCustomEditor();
var y=z._sheet.range(w);
x.edit({range:y,rect:z.activeCellRectangle(),view:this,validation:this._sheet.validation(w),callback:function(B,A){z._executeCommand({command:"EditCommand",options:{property:A?"input":"value",value:B}});
}});
},openDialog:function(x,y){var B=this._sheet;
var A=B.activeCell();
var z=new m.spreadsheet.Range(A,B);
var w=m.spreadsheet.dialogs.create(x,y);
if(w){w.bind("action",this._executeCommand.bind(this));
w.bind("deactivate",this._destroyDialog.bind(this));
this._dialogs.push(w);
w.open(z);
return w;
}},showError:function(z,w){var y=this.options.messages.errors;
if(m.spreadsheet.dialogs.registered(z.type)){var x={close:w};
if(z.type==="validationError"){x=a.extend(x,{title:z.title||"Error",text:z.body?z.body:y[z.type]});
}this.openDialog(z.type,x);
}else{this.openDialog("message",{title:z.title||"Error",text:z.body?z.body:y[z.type],activate:function(A){A.sender.dialog().element.find(".k-button").focus();
}.bind(this),close:w});
}},destroy:function(){this._dialogs.forEach(function(w){w.destroy();
});
this.cellContextMenu.destroy();
this.rowHeaderContextMenu.destroy();
this.colHeaderContextMenu.destroy();
if(this.tabstrip){this.tabstrip.destroy();
}this._destroyFilterMenu();
},_destroyFilterMenu:function(){if(this._filterMenu){this._filterMenu.destroy();
this._filterMenu=undefined;
this._filterMenuColumn=undefined;
}},render:function(){if(!this.element.is(":visible")){return;
}var D=this._sheet;
var w=D.focus();
if(w&&this.scrollIntoView(w)){return;
}var z=!D.resizingInProgress()?"none":D.resizeHandlePosition().col===-Infinity?"column":"row";
this.wrapper.toggleClass(u.editContainer,this.editor.isActive()).toggleClass(u.horizontalResize,z=="row").toggleClass(u.verticalResize,z=="column");
var x=D._grid;
var C=this.scroller.scrollTop;
var B=this.scroller.scrollLeft;
if(C<0){C=0;
}if(B<0){B=0;
}var A=this.panes.map(function(F){return F.render(B,C);
},this);
var y=[];
y=Array.prototype.concat.apply(y,A);
var E=m.dom.element("div",{style:{width:x._headerWidth+"px",height:x._headerHeight+"px"},className:s.classNames.topCorner});
y.push(E);
if(D.resizeHandlePosition()&&D.resizeHintPosition()){y.push(this.renderResizeHint());
}this.tree.render(y);
if(this.editor.isActive()){this.editor.toggleTooltip(this.activeCellRectangle());
}else{if(!D.selectionInProgress()&&!D.resizingInProgress()&&!D.isInEditMode()){this.renderClipboardContents();
}}},renderResizeHint:function(){var z=this._sheet;
var y=z.resizeHandlePosition();
var x=y.col!==-Infinity;
var A;
if(x){A={height:this.scroller.clientHeight+"px",width:p+"px",left:z.resizeHintPosition().x+"px",top:"0px"};
}else{A={height:p+"px",width:this.scroller.clientWidth+"px",top:z.resizeHintPosition().y+"px",left:"0px"};
}var w=n.classNames;
return m.dom.element("div",{className:w.resizeHint+(!x?" "+w.resizeHintVertical:""),style:A},[m.dom.element("div",{className:w.resizeHintHandle}),m.dom.element("div",{className:w.resizeHintMarker})]);
},renderClipboardContents:function(){var B=this._sheet;
var w=B._grid;
var z=B.select().toRangeRef();
var C=this._workbook.clipboard().canCopy();
if(C.canCopy===false&&C.multiSelection){this.clipboardContents.render([]);
this.selectClipBoardContents();
return;
}z=B.trim(z);
var D=new l();
var A=w.rangeDimensions(z);
A.rows.forEach(function(E){D.addRow(E);
});
A.columns.forEach(function(E){D.addColumn(E);
});
var x={};
var y={};
B.forEachMergedCell(z,function(E){var F=E.topLeft;
w.forEach(E,function(G){if(F.eq(G)){x[G.print()]=E;
}else{y[G.print()]=true;
}});
});
B.forEach(z,function(I,F,E){var G=new h(I,F).print();
if(!y[G]){var J=b(D,I-z.topLeft.row,E);
var H=x[G];
if(H){J.attr.colspan=H.width();
J.attr.rowspan=H.height();
}}});
this.clipboardContents.render([D.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]);
this.selectClipBoardContents();
},_pane:function(z,w,A,x){var y=new n(this._sheet,this._sheet._grid.pane({row:z,column:w,rowCount:A,columnCount:x}));
y.refresh(this.scroller.clientWidth,this.scroller.clientHeight);
return y;
}});
var o={cell:"k-spreadsheet-cell",vaxis:"k-spreadsheet-vaxis",haxis:"k-spreadsheet-haxis",rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",autoFillWrapper:"k-auto-fill-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",columnResizeHandle:"k-column-resize-handle",rowResizeHandle:"k-row-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]};
var n=m.Class.extend({init:function(x,w){this._sheet=x;
this._grid=w;
},refresh:function(x,w){this._grid.refresh(x,w);
},isVisible:function(x,y,w){return this._grid.view(x,y).ref.intersects(w);
},render:function(E,F){var x=n.classNames;
var G=this._sheet;
var z=this._grid;
var H=z.view(E,F);
this._currentView=H;
this._currentRect=this._rectangle(H.ref);
this._selectedHeaders=G.selectedHeaders();
var w=[];
w.push(this.renderData());
w.push(this.renderSelection());
w.push(this.renderAutoFill());
w.push(this.renderEditorSelection());
w.push(this.renderFilterHeaders());
if(z.hasRowHeader){var D=m.dom.element("div",{className:x.rowHeader,style:{width:z.headerWidth+"px",top:H.rowOffset+"px"}});
w.push(D);
G.forEach(H.ref.leftColumn(),function(J){if(!G.isHiddenRow(J)){var K=J+1,I=G.rowHeight(J);
D.children.push(m.dom.element("div",{className:this.headerClassName(J,"row"),style:{width:z.headerWidth+"px",height:I+"px"}},[m.dom.element("div",{className:"k-vertical-align-center"},[m.dom.text(K+"")])]));
}}.bind(this));
}if(z.hasColumnHeader){var y=m.dom.element("div",{className:x.columnHeader,style:{top:"0px",left:H.columnOffset+"px",width:this._currentRect.width+"px",height:z.headerHeight+"px"}});
w.push(y);
var A=0;
G.forEach(H.ref.topRow(),function(J,I){if(!G.isHiddenColumn(I)){var K=m.spreadsheet.Ref.display(null,Infinity,I),L=G.columnWidth(I);
y.children.push(m.dom.element("div",{className:this.headerClassName(I,"col"),style:{position:"absolute",left:A+"px",width:L+"px",height:z.headerHeight+"px"}},[m.dom.element("div",{className:"k-vertical-align-center"},[m.dom.text(K+"")])]));
A+=L;
}}.bind(this));
}if(G.resizeHandlePosition()&&(z.hasColumnHeader||z.hasRowHeader)){var C=G._grid.normalize(G.resizeHandlePosition());
if(H.ref.intersects(C)){if(!G.resizeHintPosition()){w.push(this.renderResizeHandle());
}}}var B=[x.pane];
if(z.hasColumnHeader){B.push(x.top);
}if(z.hasRowHeader){B.push(x.left);
}return m.dom.element("div",{style:z.style,className:B.join(" ")},w);
},headerClassName:function(y,B){var A=this._selectedHeaders;
var z;
var w;
if(B==="row"){z=A.rows[y];
w=A.allRows;
}else{z=A.cols[y];
w=A.allCols;
}var x=z||(A.all?"full":w?"partial":"none");
if(x){x="k-selection-"+x;
}return x;
},renderData:function(){var B=this._sheet;
var E=this._currentView;
var w=m.dom.element("div",{className:n.classNames.data,style:{position:"relative",left:E.columnOffset+"px",top:E.rowOffset+"px"}});
var A=this._currentRect;
var y=m.spreadsheet.draw.doLayout(B,E.ref,{forScreen:true}),z;
var C=B._showGridLines;
if(C){z=null;
y.xCoords.forEach(function(F){if(F!==z){z=F;
w.children.push(m.dom.element("div",{className:o.vaxis,style:{left:F+"px",height:A.height+"px",borderColor:B.gridLinesColor()}}));
}});
z=null;
y.yCoords.forEach(function(F){if(F!==z){z=F;
w.children.push(m.dom.element("div",{className:o.haxis,style:{top:F+"px",width:A.width+"px",borderColor:B.gridLinesColor()}}));
}});
}var D={},x={};
y.cells.forEach(function(F){var G=x[F.col]||(x[F.col]={});
var H=D[F.row]||(D[F.row]={});
k(w.children,F,null,G,H,C);
});
return w;
},renderResizeHandle:function(){var z=this._sheet;
var y=z.resizeHandlePosition();
var x=this._rectangle(y);
var w=[n.classNames.resizeHandle];
var A;
if(y.col!==-Infinity){A={height:this._grid.headerHeight+"px",width:p+"px",left:x.right-p/2+"px",top:"0px"};
w.push(u.horizontalResize);
}else{A={height:p+"px",width:this._grid.headerWidth+"px",top:x.bottom-p/2+"px",left:"0px"};
w.push(u.verticalResize);
}return m.dom.element("div",{className:w.join(" "),style:A});
},filterIconRect:function(y){var x=16;
var w=3;
return new m.spreadsheet.Rectangle(y.right-x-w,y.top+w,x,x);
},renderFilterHeaders:function(){var B=this._sheet;
var w=[];
var x=s.classNames;
var y=B.filter();
function A(C){return m.dom.element("span",{className:x.icon+" "+C});
}function z(E,H,G){var I={left:H.left+"px",top:H.top+"px"};
var F=y&&y.columns.some(function(J){return J.index===G;
});
var D=E.filterButton;
if(F){D+=" "+E.filterButtonActive;
}var C=m.dom.element("span",{className:D,style:I},[A(E.iconFilterDefault)]);
return C;
}if(y){this._addDiv(w,y.ref,x.filterRange);
}B.forEachFilterHeader(this._currentView.ref,function(G){var F=this._rectangle(G);
var E=this.filterIconRect(F);
var D=this._sheet.filterColumn(G);
var C=z(x,E,D);
w.push(C);
}.bind(this));
return m.dom.element("div",{className:x.filterHeadersWrapper},w);
},renderEditorSelection:function(){var w=n.classNames;
var y=this._sheet;
var x=[];
y._formulaSelections.forEach(function(z){var A=z.ref;
if(A===m.spreadsheet.NULLREF){return;
}this._addDiv(x,A,w.selectionHighlight+" "+z.colorClass);
}.bind(this));
return m.dom.element("div",{className:w.selectionWrapper},x);
},renderSelection:function(){var z=n.classNames;
var C=[];
var x=[z.activeCell];
var B=[z.selection];
var D=this._sheet;
var w=D.activeCell().toRangeRef();
var y=this._activeFormulaColor();
var A=D.select();
x=x.concat(y,this._directionClasses(w));
B=B.concat(y);
if(D.singleCellSelection()){x.push(z.single);
}if(A.size()===1){B.push("k-single-selection");
}if(this._sheet.autoFillPunch()){B.push("k-dim-auto-fill-handle");
}A.forEach(function(E){if(E!==m.spreadsheet.NULLREF){this._addDiv(C,E,B.join(" "));
}}.bind(this));
this._addTable(C,w,x.join(" "));
return m.dom.element("div",{className:z.selectionWrapper},C);
},renderAutoFill:function(){var w=[];
if(this._sheet.autoFillInProgress()){var x=this._sheet.autoFillRef();
var B=this._sheet.autoFillPunch();
var z=this._sheet._autoFillDirection;
this._addDiv(w,x,"k-auto-fill");
if(B){this._addDiv(w,B,"k-auto-fill-punch");
}else{if(z!==undefined){var D,y;
switch(z){case 0:D=x.bottomRight;
y="k-auto-fill-br-hint";
break;
case 1:D=x.bottomRight;
y="k-auto-fill-br-hint";
break;
case 2:D=new h(x.topLeft.row,x.bottomRight.col);
y="k-auto-fill-tr-hint";
break;
case 3:D=new h(x.bottomRight.row,x.topLeft.col);
y="k-auto-fill-bl-hint";
break;
}var A=m.dom.element("span",{className:"k-tooltip"},[m.dom.text(this._sheet._autoFillHint)]);
var C=this._addDiv(w,D,y);
if(C){C.children.push(A);
}}}}return m.dom.element("div",{className:n.classNames.autoFillWrapper},w);
},_addDiv:function(x,z,w){var A=this._currentView,y;
if(A.ref.intersects(z)){y=this._rectangle(z).resize(1,1).toDiv(w);
x.push(y);
}return y;
},_addTable:function(x,A,w){var B=this;
var C=B._sheet;
var D=B._currentView;
if(D.ref.intersects(A)){var z=B._rectangle(A);
var y=B._sheet.activeCellCustomEditor();
C.forEach(A.collapse(),function(H,G,F){F.left=z.left;
F.top=z.top;
F.width=z.width;
F.height=z.height;
k(x,F,w,null,null,true);
if(y){var E=m.dom.element("div",{className:"k-button k-spreadsheet-editor-button",style:{left:F.left+F.width+"px",top:F.top+"px",height:F.height+"px"}});
if(y.icon){E.children.push(m.dom.element("span",{className:"k-icon "+y.icon}));
}x.push(E);
}});
}},_activeFormulaColor:function(){var w;
var x=[];
if(this._sheet.isInEditMode()){w=this._sheet._formulaSelections.filter(function(y){return y.active&&y.type=="ref";
})[0];
if(w){x.push(w.colorClass);
}}return x;
},_directionClasses:function(w){var x=[];
var y=n.classNames;
var z=this._currentView.ref;
if(!w.move(0,-1).intersects(z)){x.push(y.left);
}if(!w.move(-1,0).intersects(z)){x.push(y.top);
}if(!w.move(0,1).intersects(z)){x.push(y.right);
}if(!w.move(1,0).intersects(z)){x.push(y.bottom);
}return x;
},_rectangle:function(w){return this._grid.boundingRectangle(w.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop);
}});
m.spreadsheet.View=s;
m.spreadsheet.Pane=n;
m.spreadsheet.drawCell=k;
a.extend(true,s,{classNames:u});
a.extend(true,n,{classNames:o});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/customeditors",["kendo.core","kendo.popup","kendo.calendar","kendo.listview","spreadsheet/sheet"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a={};
var c=b.spreadsheet.registerEditor=function(e,d){a[e]=d;
};
b.spreadsheet.Sheet.prototype.activeCellCustomEditor=function(){var d=this.activeCell().first();
var g=this.validation(d);
var f=this._properties.get("editor",this._grid.cellRefIndex(d));
var e;
if(f!=null){e=a[f];
}else{if(g&&g.showButton){f="_validation_"+g.dataType;
e=a[f];
}}if(typeof e=="function"){e=a[f]=e();
}return e;
};
c("_validation_date",function(){var e,d,h;
function f(){if(!d){d=$("<div>").kendoCalendar();
h=$("<div>").kendoPopup();
d.appendTo(h);
d=d.getKendoCalendar();
h=h.getKendoPopup();
d.bind("change",function(){h.close();
var i=d.value();
e.callback(b.spreadsheet.dateToNumber(i));
});
}h.setOptions({anchor:e.view.element.find(".k-spreadsheet-editor-button")});
}function g(){f();
var i=e.range.value();
if(i!=null){d.value(b.spreadsheet.numberToDate(i));
}var l=e.validation;
if(l){var k=null,j=null;
if(/^(?:greaterThan|between)/.test(l.comparerType)){k=b.spreadsheet.numberToDate(l.from.value);
}if(l.comparerType=="between"){j=b.spreadsheet.numberToDate(l.to.value);
}if(l.comparerType=="greaterThan"){j=b.spreadsheet.numberToDate(l.from.value);
}d.setOptions({disableDates:function(m){var n=l.from.value|0;
var o=l.to.value|0;
m=b.spreadsheet.dateToNumber(m)|0;
return !b.spreadsheet.validation.validationComparers[l.comparerType](m,n,o);
},min:k,max:j});
}else{d.setOptions({disableDates:null,min:null,max:null});
}h.open();
}return{edit:function(i){e=i;
g();
},icon:"k-i-calendar"};
});
c("_validation_list",function(){var d,f,h;
function e(){if(!f){f=$("<div/>").kendoStaticList({template:"<div>#:value#</div>",selectable:true,autoBind:false});
h=$("<div>").kendoPopup();
f.appendTo(h);
h=h.getKendoPopup();
f=f.getKendoStaticList();
f.bind("change",function(){h.close();
var i=f.value()[0];
if(i){d.callback(i.value);
}});
}h.setOptions({anchor:d.view.element.find(".k-spreadsheet-editor-button")});
}function g(){e();
var k=d.validation.from.value;
var i=[];
if(k){k.each(function(l){i.push({value:l});
});
}var j=new b.data.DataSource({data:i});
f.setDataSource(j);
j.read();
h.open();
}return{edit:function(i){d=i;
g();
},icon:"k-i-arrow-s"};
});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/grid",["kendo.core","spreadsheet/references"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var a=c.spreadsheet.CellRef;
var e=c.spreadsheet.RangeRef;
var g=c.spreadsheet.UnionRef;
var f=c.Class.extend({init:function(i,j,k,h){this.left=i;
this.width=k;
this.right=i+k;
this.top=j;
this.height=h;
this.bottom=j+h;
},offset:function(h,i){return new f(this.left+h,this.top+i,this.width,this.height);
},resize:function(i,h){return new f(this.left,this.top,this.width+i,this.height+h);
},intersects:function(h,i){return this.left<h&&h<this.left+this.width&&this.top<i&&i<this.top+this.height;
},toDiv:function(h){return c.dom.element("div",{className:h,style:{width:this.width+"px",height:this.height+"px",top:this.top+"px",left:this.left+"px"}});
}});
var b=c.Class.extend({init:function(m,i,l,h,j,k){this.rowCount=l;
this.columnCount=h;
this._columns=i;
this._rows=m;
this._headerHeight=j;
this._headerWidth=k;
},isAxis:function(i){i=i.toRangeRef();
var j=i.topLeft;
var h=i.bottomRight;
return j.row===0&&h.row===this.rowCount-1||j.col===0&&h.col===this.columnCount-1;
},width:function(i,h){return this._columns.sum(i,h);
},height:function(i,h){return this._rows.sum(i,h);
},totalHeight:function(){return this._rows.total+this._headerHeight;
},totalWidth:function(){return this._columns.total+this._headerWidth;
},index:function(i,h){return h*this.rowCount+i;
},cellRef:function(h){return new a(h%this.rowCount,h/this.rowCount>>0);
},rowRef:function(h){return new e(new a(h,0),new a(h,this.columnCount-1));
},colRef:function(h){return new e(new a(0,h),new a(this.rowCount-1,h));
},cellRefIndex:function(h){return this.index(h.row,h.col);
},normalize:function(i){if(i instanceof e){return new e(this.normalize(i.topLeft),this.normalize(i.bottomRight)).setSheet(i.sheet,i.hasSheet());
}if(i instanceof g){return i.map(function(j){return this.normalize(j);
},this);
}var h=i.clone();
h.col=Math.max(0,Math.min(this.columnCount-1,i.col));
h.row=Math.max(0,Math.min(this.rowCount-1,i.row));
return h;
},rectangle:function(i){var j=this.normalize(i.topLeft);
var h=this.normalize(i.bottomRight);
return new f(this.width(0,j.col-1),this.height(0,j.row-1),this.width(j.col,h.col),this.height(j.row,h.row));
},pane:function(h){return new d(new c.spreadsheet.PaneAxis(this._rows,h.row,h.rowCount,this._headerHeight),new c.spreadsheet.PaneAxis(this._columns,h.column,h.columnCount,this._headerWidth),this);
},rangeDimensions:function(h){return{rows:this._rows.values.iterator(h.topLeft.row,h.bottomRight.row),columns:this._columns.values.iterator(h.topLeft.col,h.bottomRight.col)};
},forEach:function(k,i){var m=this.normalize(k.topLeft);
var h=this.normalize(k.bottomRight);
for(var j=m.col;
j<=h.col;
j++){for(var l=m.row;
l<=h.row;
l++){i(new a(l,j));
}}},trim:function(o,n){var q=o.topLeft;
var h=o.bottomRight;
var j=q.row;
var i=q.col;
for(var l=q.col;
l<=h.col;
l++){var p=this.index(q.row,l);
var m=this.index(h.row,l);
var r=n.tree.intersecting(p,m);
if(r.length){var k=this.cellRef(r[r.length-1].end);
j=Math.max(j,k.row);
i=l;
}}return new e(o.topLeft,new a(Math.min(j,o.bottomRight.row),i));
}});
var d=c.Class.extend({init:function(j,h,i){this.rows=j;
this.columns=h;
this._grid=i;
this.headerHeight=j.headerSize;
this.headerWidth=h.headerSize;
this.hasRowHeader=h.hasHeader;
this.hasColumnHeader=j.hasHeader;
},refresh:function(i,h){this.columns.viewSize(i);
this.rows.viewSize(h);
var j=this.columns.paneSegment();
var k=this.rows.paneSegment();
this.left=j.offset;
this.top=k.offset;
this.right=j.offset+j.length;
this.bottom=k.offset+k.length;
this.style={top:k.offset+"px",left:j.offset+"px",height:k.length+"px",width:j.length+"px"};
},view:function(i,k){var j=this.rows.visible(k);
var h=this.columns.visible(i);
return{rows:j,columns:h,rowOffset:j.offset,columnOffset:h.offset,mergedCellLeft:h.start,mergedCellTop:j.start,ref:new e(new a(j.values.start,h.values.start),new a(j.values.end,h.values.end))};
},contains:function(h){return this.rows.contains(h.topLeft.row,h.bottomRight.row)&&this.columns.contains(h.topLeft.col,h.bottomRight.col);
},index:function(i,h){return this._grid.index(i,h);
},boundingRectangle:function(h){return this._grid.rectangle(h);
},cellRefIndex:function(h){return this._grid.cellRefIndex(h);
},scrollBoundaries:function(i){var k=this.boundingRectangle(i);
var h={top:Math.max(0,k.top-this.top+(this.hasColumnHeader?0:this.headerHeight)),left:Math.max(0,k.left-this.left+(this.hasRowHeader?0:this.headerWidth)),right:k.right-this.columns._viewSize+this.headerWidth,bottom:k.bottom-this.rows._viewSize+this.headerHeight};
var l=this.columns.defaultValue/2;
var j=this.rows.defaultValue/2;
h.scrollTop=h.top-j;
h.scrollBottom=h.bottom+j;
h.scrollLeft=h.left-l;
h.scrollRight=h.right+l;
return h;
}});
c.spreadsheet.Grid=b;
c.spreadsheet.PaneGrid=d;
c.spreadsheet.Rectangle=f;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/axis",["kendo.core"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a=b.Class.extend({init:function(d,e){this._value=e;
this._count=d;
this.values=new b.spreadsheet.RangeList(0,d-1,e);
this._hidden=new b.spreadsheet.RangeList(0,d-1,0);
this.scrollBarSize=b.support.scrollbar();
this._refresh();
},adjust:function(e,d){if(d<0){this.values.copy(e-d,this._count-1,e);
this._hidden.copy(e-d,this._count-1,e);
}else{this.values.copy(e,this._count,e+d);
this._hidden.copy(e,this._count,e+d);
this.values.value(e,e+d-1,this._value);
this._hidden.value(e,e+d-1,0);
}},toJSON:function(d,i){var k=[];
var g=this.values.iterator(0,this._count-1);
for(var e=0;
e<this._count;
e++){var j=g.at(e);
if(j===this._value){continue;
}var h=i[e];
if(h===undefined){h=k.length;
var f={index:e};
f[d]=j;
k.push(f);
i[e]=h;
}}return k;
},fromJSON:function(d,h){for(var e=0;
e<h.length;
e++){var g=h[e][d];
var f=h[e].index;
if(f===undefined){f=e;
}this.value(f,f,g);
}},hide:function(d){if(!this.hidden(d)){var e=this.value(d,d);
this._hidden.value(d,d,e);
this.value(d,d,0);
}},hidden:function(d){return this._hidden.value(d,d)!==0;
},includesHidden:function(e,d){return this._hidden.intersecting(e,d).length>1;
},nextVisible:function(e,f){var d=this._count-1;
if(e===d){return f?e+1:e;
}e+=1;
var g=this._hidden.intersecting(e,e)[0];
if(g.value!==0){if(g.end===d){return e-1;
}else{return g.end+1;
}}else{return e;
}},nextPage:function(d,e){return this.index(this.sum(0,d-1)+e);
},prevPage:function(d,e){return this.index(this.sum(0,d)-e);
},firstVisible:function(){var d=this._hidden.first();
if(d.value===0){return 0;
}else{return d.end+1;
}},lastVisible:function(){var d=this._hidden.last();
if(d.value===0){return this._count-1;
}else{return d.start-1;
}},prevVisible:function(d,e){if(d===0){return e?-1:0;
}d-=1;
var f=this._hidden.intersecting(d,d)[0];
if(f.value!==0){if(f.start===0){return d+1;
}else{return f.start-1;
}}else{return d;
}},unhide:function(d){if(this.hidden(d)){var e=this._hidden.value(d,d);
this._hidden.value(d,d,0);
this.value(d,d,e);
}},value:function(e,d,f){if(f!==undefined){this.values.value(e,d,f);
this._refresh();
}else{return this.values.iterator(e,d).at(0);
}},sum:function(f,d){var h=this.values.iterator(f,d);
var g=0;
for(var e=f;
e<=d;
e++){g+=h.at(e);
}return g;
},visible:function(k,d){var n=null;
var g=null;
var h=false;
if(d>=this.total+this.scrollBarSize){h=true;
}var j=this._pixelValues.intersecting(k,d);
n=j[0];
g=j[j.length-1];
if(!n){return{values:this.values.iterator(0,0),offset:0};
}var m=k-n.start;
var l=(m/n.value.value>>0)+n.value.start;
var i=m-(l-n.value.start)*n.value.value;
var f=d-g.start;
var e=(f/g.value.value>>0)+g.value.start;
if(e>g.value.end){e=g.value.end;
}if(h){i+=g.value.value-(f-(e-g.value.start)*g.value.value);
}i=Math.min(-i,0);
return{values:this.values.iterator(l,e),offset:i};
},index:function(g){var e=0;
var f=this.values.iterator(0,this._count-1);
var d=f.at(0);
while(d<g&&e<this._count-1){d+=f.at(++e);
}return e;
},_refresh:function(){var d=0;
this._pixelValues=this.values.map(function(f){var g=d;
d+=(f.end-f.start+1)*f.value;
var e=d-1;
return new b.spreadsheet.ValueRange(g,e,f);
});
this.total=d;
},getState:function(){return{values:this.values.getState(),hidden:this._hidden.getState()};
},setState:function(d){this.values.setState(d.values);
this._hidden.setState(d.hidden);
this._refresh();
}});
var c=b.Class.extend({init:function(d,g,e,f){this._axis=d;
this._start=g;
this._count=e;
this.hasHeader=g===0;
this.headerSize=f;
this.defaultValue=d._value;
this.frozen=e>0;
},viewSize:function(d){this._viewSize=d;
},sum:function(e,d){return this._axis.sum(e,d-1);
},start:function(){return this.sum(0,this._start);
},size:function(){return this.sum(this._start,this._start+this._count);
},index:function(e,d){return this._axis.index(e+(this.frozen?0:d)-this.headerSize);
},paneSegment:function(){var e=this.start();
var d;
if(!this.hasHeader){e+=this.headerSize;
}if(this.frozen){d=this.size();
if(this.hasHeader){d+=this.headerSize;
}else{d-=this.headerSize;
}}else{d=this._viewSize-e;
}return{offset:e,length:d};
},visible:function(d){var g=this.start();
var f;
if(this.frozen){f=this.size();
if(!this.hasHeader){f-=this.headerSize;
}}else{f=this._viewSize-g-this.headerSize;
g+=d;
}var e=this._axis.visible(g,g+f-1);
if(this.frozen){e.offset=0;
}e.start=g;
if(this.hasHeader){e.offset+=this.headerSize;
e.start-=this.headerSize;
}return e;
},contains:function(e,d){if(this.frozen){if(e>this._start+this._count){return false;
}if(d<this._start){return false;
}return true;
}else{return d>=this._start;
}}});
b.spreadsheet.Axis=a;
b.spreadsheet.PaneAxis=c;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/filter",["kendo.core","kendo.data"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a=b.spreadsheet.Filter=b.Class.extend({prepare:function(){},value:function(g){return g.value;
},matches:function(){throw new Error("The 'matches' method is not implemented.");
},toJSON:function(){throw new Error("The 'toJSON' method is not implemented.");
}});
a.create=function(i){var h=i.filter;
if(!h){throw new Error("Filter type not specified.");
}var g=b.spreadsheet[h.charAt(0).toUpperCase()+h.substring(1)+"Filter"];
if(!g){throw new Error("Filter type not recognized.");
}return new g(i);
};
b.spreadsheet.ValueFilter=a.extend({_values:[],_dates:[],_blanks:false,init:function(g){if(g.values!==undefined){this._values=g.values;
}if(g.blanks!==undefined){this._blanks=g.blanks;
}if(g.dates!==undefined){this._dates=g.dates;
}},value:function(g){var i=g.value;
if(this._dates.length>0&&g.format&&typeof i==="number"){var h=b.spreadsheet.formatting.type(i,g.format);
if(h==="date"){i=b.spreadsheet.numberToDate(i);
}}return i;
},matches:function(g){if(g===null||g===undefined){return this._blanks;
}if(g instanceof Date){return this._dates.some(function(h){return h.year===g.getFullYear()&&(h.month===undefined||h.month===g.getMonth())&&(h.day===undefined||h.day===g.getDate())&&(h.hours===undefined||h.hours===g.getHours())&&(h.minutes===undefined||h.minutes===g.getMinutes())&&(h.seconds===undefined||h.seconds===g.getSeconds());
});
}return this._values.indexOf(g)>=0;
},toJSON:function(){return{filter:"value",values:this._values.slice(0)};
}});
b.spreadsheet.CustomFilter=a.extend({_logic:"and",init:function(h){if(h.logic!==undefined){this._logic=h.logic;
}if(h.criteria===undefined){throw new Error("Must specify criteria.");
}this._criteria=h.criteria;
var g=b.data.Query.filterExpr({logic:this._logic,filters:this._criteria}).expression;
this._matches=new Function("d","return "+g);
},matches:function(g){if(g===null){return false;
}return this._matches(g);
},value:function(g){var j=g.value;
var i=this._criteria[0].value;
var h=i instanceof Date?"date":typeof i;
var k=typeof j;
if(g.format){k=b.spreadsheet.formatting.type(j,g.format);
}if(k!=h){if(h=="string"){if(g.format){j=b.spreadsheet.formatting.text(j,g.format);
}j=j+"";
}}else{if(k=="date"){j=b.spreadsheet.numberToDate(j);
}}return j;
},toJSON:function(){return{filter:"custom",logic:this._logic,criteria:this._criteria};
}});
b.spreadsheet.TopFilter=a.extend({init:function(g){this._type=g.type;
this._value=g.value;
this._values=[];
},prepare:function(g){var i=g.map(this.value).sort().filter(function(l,k,j){return k===0||l!==j[k-1];
});
if(this._type==="topNumber"||this._type=="topPercent"){i.sort(function(j,k){return k-j;
});
}else{i.sort(function(j,k){return j-k;
});
}var h=this._value;
if(this._type==="topPercent"||this._type==="bottomPercent"){h=i.length*h/100>>0;
}this._values=i.slice(0,h);
},matches:function(g){return this._values.indexOf(g)>=0;
},toJSON:function(){return{filter:"top",type:this._type,value:this._value};
}});
b.spreadsheet.DynamicFilter=a.extend({init:function(g){this._type=g.type;
this._predicate=this[g.type];
if(typeof this._predicate!=="function"){throw new Error("DynamicFilter type '"+g.type+"' not recognized.");
}},value:function(g){var i=g.value;
if(g.format){var h=b.spreadsheet.formatting.type(i,g.format);
if(h==="date"){i=b.spreadsheet.numberToDate(i);
}}return i;
},prepare:function(g){var j=0;
var i=0;
for(var h=0;
h<g.length;
h++){var k=this.value(g[h]);
if(typeof k==="number"){j+=k;
i++;
}}if(i>0){this._average=j/i;
}else{this._average=0;
}},matches:function(g){return this._predicate(g);
},aboveAverage:function(g){if(g instanceof Date){g=b.spreadsheet.dateToNumber(g);
}if(typeof g!=="number"){return false;
}return g>this._average;
},belowAverage:function(g){if(g instanceof Date){g=b.spreadsheet.dateToNumber(g);
}if(typeof g!=="number"){return false;
}return g<this._average;
},tomorrow:function(h){if(h instanceof Date){var g=b.date.addDays(b.date.today(),1);
return b.date.getDate(h).getTime()===g.getTime();
}return false;
},today:function(g){if(g instanceof Date){return b.date.isToday(g);
}return false;
},yesterday:function(g){if(g instanceof Date){var h=b.date.addDays(b.date.today(),-1);
return b.date.getDate(g).getTime()===h.getTime();
}return false;
},nextWeek:function(g){return e(b.date.addDays(b.date.today(),7),g);
},thisWeek:function(g){return e(b.date.today(),g);
},lastWeek:function(g){return e(b.date.addDays(b.date.today(),-7),g);
},nextMonth:function(g){return d(g,1);
},thisMonth:function(g){return d(g,0);
},lastMonth:function(g){return d(g,-1);
},nextQuarter:function(i){if(i instanceof Date){var h=b.date.today();
var g=c(i)-c(h);
return g===1&&h.getFullYear()===i.getFullYear()||g==-3&&h.getFullYear()+1===i.getFullYear();
}return false;
},thisQuarter:function(i){if(i instanceof Date){var h=b.date.today();
var g=c(i)-c(h);
return g===0&&h.getFullYear()===i.getFullYear();
}return false;
},lastQuarter:function(i){if(i instanceof Date){var h=b.date.today();
var g=c(h)-c(i);
return g===1&&h.getFullYear()===i.getFullYear()||g==-3&&h.getFullYear()-1===i.getFullYear();
}return false;
},nextYear:function(g){return f(g,1);
},thisYear:function(g){return f(g,0);
},lastYear:function(g){return f(g,-1);
},yearToDate:function(h){if(h instanceof Date){var g=b.date.today();
return h.getFullYear()===g.getFullYear()&&h<=g;
}return false;
},toJSON:function(){return{filter:"dynamic",type:this._type};
}});
[1,2,3,4].forEach(function(g){b.spreadsheet.DynamicFilter.prototype["quarter"+g]=function(h){if(h instanceof Date){return c(h)===g;
}return false;
};
});
b.cultures["en-US"].calendar.months.names.forEach(function(h,g){b.spreadsheet.DynamicFilter.prototype[h.toLowerCase()]=function(i){if(i instanceof Date){return i.getMonth()===g;
}return false;
};
});
function c(h){var g=h.getMonth()+1;
if(g>=1&&g<=3){return 1;
}else{if(g>=4&&g<=6){return 2;
}else{if(g>=7&&g<=9){return 3;
}else{return 4;
}}}}function f(i,g){if(i instanceof Date){var h=b.date.today();
h.setFullYear(h.getFullYear()+g);
return h.getFullYear()===i.getFullYear();
}return false;
}function d(i,g){if(i instanceof Date){var h=b.date.firstDayOfMonth(b.date.today());
h.setMonth(h.getMonth()+g,1);
return h.getTime()===b.date.firstDayOfMonth(i).getTime();
}return false;
}function e(g,h){if(h instanceof Date){var i=b.date.dayOfWeek(b.date.getDate(g),1);
var j=b.date.dayOfWeek(b.date.getDate(h),1);
return i.getTime()===j.getTime();
}return false;
}}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sorter",["kendo.core"],b);
}(function(){(function(a){if(a.support.browser.msie&&a.support.browser.version<9){return;
}var b=a.Class.extend({init:function(c,d){this._grid=c;
this._lists=d;
},indices:function(g,f,c,e){var d=b.ascendingComparer;
if(c===false){d=b.descendingComparer;
}return f.sortedIndices(this._grid.cellRefIndex(g.topLeft),this._grid.cellRefIndex(g.bottomRight),d,e);
},sortBy:function(j,e,i,c,g){var k=this.indices(j.toColumn(e),i,c,g);
for(var d=j.topLeft.col;
d<=j.bottomRight.col;
d++){var l=this._grid.index(j.topLeft.row,d);
var f=this._grid.index(j.bottomRight.row,d);
for(var h=0;
h<this._lists.length;
h++){if(l<this._lists[h].lastRangeStart()){this._lists[h].sort(l,f,k);
}}}return k;
}});
b.ascendingComparer=function(c,d){if(c===null&&d===null){return 0;
}if(c===null){return 1;
}if(d===null){return -1;
}var e=typeof c;
var f=typeof d;
if(e==="number"){if(f==="number"){return c-d;
}else{return -1;
}}if(e==="string"){switch(f){case"number":return 1;
case"string":return c.localeCompare(d);
default:return -1;
}}if(e==="boolean"){switch(f){case"number":return 1;
case"string":return 1;
case"boolean":return c-d;
default:return -1;
}}if(c instanceof a.spreadsheet.calc.runtime.CalcError){if(d instanceof a.spreadsheet.calc.runtime.CalcError){return 0;
}else{return 1;
}}throw new Error("Cannot compare "+c+" and "+d);
};
b.descendingComparer=function(c,d){if(c===null&&d===null){return 0;
}if(c===null){return 1;
}if(d===null){return -1;
}return b.ascendingComparer(d,c);
};
a.spreadsheet.Sorter=b;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/numformat",["spreadsheet/calc","kendo.dom"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var c=kendo.spreadsheet.calc;
var f=kendo.dom;
var k=/^\[(black|green|white|blue|magenta|yellow|cyan|red)\]/i;
var l=/^\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\]/;
function h(r){r=c.InputStream(r);
var z=[],q=false,p;
while(!r.eof()){var y=x();
z.push(y);
if(y.cond){q=true;
}}if(!q){if(z.length==1){z[0].cond="num";
}else{if(z.length==2){z[0].cond={op:">=",value:0};
z[1].cond={op:"<",value:0};
}else{if(z.length>=3){z[0].cond={op:">",value:0};
z[1].cond={op:"<",value:0};
z[2].cond={op:"=",value:0};
if(z.length>3){z[3].cond="text";
z=z.slice(0,4);
}}}}}return z;
function s(){var A=r.skip(k);
if(A){return A[1].toLowerCase();
}}function t(){var A=r.skip(l);
if(A){var B=parseFloat(A[2]);
if(!isNaN(B)){return{op:A[1],value:B};
}}}function v(){var A=[],C,B=null;
while(!r.eof()&&(C=w())){if(C.type=="date"){if(B&&/^(el)?time$/.test(B.type)&&B.part=="h"&&C.part=="m"&&C.format<3){C.type="time";
}}else{if(/^(el)?time$/.test(C.type)&&C.part=="s"){if(B&&B.type=="date"&&B.part=="m"&&B.format<3){B.type="time";
}}}if(!/^(?:str|space|fill)$/.test(C.type)){B=C;
}A.push(C);
}return A;
}function u(B){if(B.type!="date"||B.part=="m"&&B.format<3){var A=r.skip(/^\.(0+)/);
if(A){B.fraction=A[1].length;
if(B.type=="date"){B.type="time";
}}}return B;
}function w(){var A,B;
if(B=r.skip(/^([#0?]+)(?:,([#0?]+))+/)){return{type:"digit",sep:true,format:B[1]+B[2],decimal:p};
}if(B=r.skip(/^[#0?]+/)){return{type:"digit",sep:false,format:B[0],decimal:p};
}if(B=r.skip(/^(e)([+-])/i)){return{type:"exp",ch:B[1],sign:B[2]};
}if(B=r.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)){B=B[1].toLowerCase();
return u({type:"date",part:B.charAt(0),format:B.length});
}if(B=r.skip(/^(hh?|ss?)/i)){B=B[1].toLowerCase();
return u({type:"time",part:B.charAt(0),format:B.length});
}if(B=r.skip(/^\[(hh?|mm?|ss?)\]/i)){B=B[1].toLowerCase();
return u({type:"eltime",part:B.charAt(0),format:B.length});
}if(B=r.skip(/^(am\/pm|a\/p)/i)){B=B[1].split("/");
return{type:"ampm",am:B[0],pm:B[1]};
}switch(A=r.next()){case";":return null;
case"\\":return{type:"str",value:r.next()};
case'"':return{type:"str",value:r.readEscaped(A)};
case"@":return{type:"text"};
case"_":return{type:"space",value:r.next()};
case"*":return{type:"fill",value:r.next()};
case".":if(r.lookingAt(/^\s*[#0?]/)){p=true;
return{type:"dec"};
}return{type:"str",value:"."};
case"%":return{type:"percent"};
case",":return{type:"comma"};
}return{type:"str",value:A};
}function x(){p=false;
var A=s(),B=t();
if(!A&&B){A=s();
}return{color:A,cond:B,body:v()};
}}function i(s){return s.map(q).join(";");
function q(u){var t="";
if(u.color){t+="["+u.color+"]";
}if(u.cond){if(!(u.cond=="text"||u.cond=="num")){t+="["+u.cond.op+u.cond.value+"]";
}}t+=u.body.map(r).join("");
return t;
}function p(t,u){if(u.fraction){t+="."+g("",u.fraction,"0");
}return t;
}function r(t){if(t.type=="digit"){if(t.sep){return t.format.charAt(0)+","+t.format.substr(1);
}else{return t.format;
}}else{if(t.type=="exp"){return t.ch+t.sign;
}else{if(t.type=="date"||t.type=="time"){return p(g("",t.format,t.part),t);
}else{if(t.type=="eltime"){return p("["+g("",t.format,t.part)+"]",t);
}else{if(t.type=="ampm"){return t.am+"/"+t.pm;
}else{if(t.type=="str"){return JSON.stringify(t.value);
}else{if(t.type=="text"){return"@";
}else{if(t.type=="space"){return"_"+t.value;
}else{if(t.type=="fill"){return"*"+t.value;
}else{if(t.type=="dec"){return".";
}else{if(t.type=="percent"){return"%";
}else{if(t.type=="comma"){return",";
}}}}}}}}}}}}}}function a(p,q){p.forEach(function(v){var t=q;
if(v.cond=="text"){return;
}var s=v.body,r=false,u=s.length;
while(t!==0&&--u>=0){var x=s[u];
if(x.type=="digit"){if(x.decimal){r=true;
if(t>0){x.format+=g("",t,"0");
}else{if(t<0){var w=x.format.length;
x.format=x.format.substr(0,w+t);
t+=w-x.format.length;
}}if(x.format.length===0){s.splice(u,1);
while(--u>=0){x=s[u];
if(x.type=="digit"&&x.decimal){++u;
break;
}if(x.type=="dec"){s.splice(u,1);
break;
}}}}if(t>0){break;
}}}if(!r&&t>0){s.splice(u+1,0,{type:"dec"},{type:"digit",sep:false,decimal:true,format:g("",t,"0")});
}});
}function o(q){var p=0;
return{next:function(){return q[p++];
},eof:function(){return p>=q.length;
},ahead:function(s,r){if(p+s<=q.length){var t=r.apply(null,q.slice(p,p+s));
if(t){p+=s;
}return t;
}},restart:function(){p=0;
}};
}function e(u){var y=o(u.body);
var w=false;
var x=false;
var v=false;
var B=0;
var D=0;
var q="";
var E=false;
var t=0;
var z=[],s=[];
var r=u.cond;
var C="";
if(r=="text"){C="if (typeof value == 'string' || value instanceof kendo.spreadsheet.CalcError) { ";
}else{if(r=="num"){C="if (typeof value == 'number') { ";
}else{if(r){var A=r.op=="="?"==":r.op;
C="if (typeof value == 'number' && value "+A+" "+r.value+") { ";
q+="value = Math.abs(value); ";
}}}if(u.color){q+="result.color = "+JSON.stringify(u.color)+"; ";
}function p(G,H){if(G.type=="digit"&&H.type=="comma"||G.type=="comma"&&G.hidden&&H.type=="comma"){H.hidden=true;
D++;
}}while(!y.eof()){y.ahead(2,p);
var F=y.next();
if(F.type=="percent"){B++;
}else{if(F.type=="digit"){if(F.decimal){t+=F.format.length;
s.push(F.format);
}else{z.push(F.format);
if(F.sep){E=true;
}}}else{if(F.type=="time"){x=true;
}else{if(F.type=="date"){w=true;
}else{if(F.type=="ampm"){v=x=true;
}}}}}}if(B>0){q+="value *= "+Math.pow(100,B)+"; ";
}if(D>0){q+="value /= "+Math.pow(1000,D)+"; ";
}if(z.length){q+="var intPart = runtime.formatInt(culture, value, "+JSON.stringify(z)+", "+t+", "+E+"); ";
}if(s.length){q+="var decPart = runtime.formatDec(value, "+JSON.stringify(s)+", "+t+"); ";
}if(z.length||s.length){q+="type = 'number'; ";
}if(w){q+="var date = runtime.unpackDate(value); ";
}if(x){q+="var time = runtime.unpackTime(value); ";
}if(w||x){q+="type = 'date'; ";
}if(B>0||D>0||z.length||s.length||w||x){if(!C){C="if (typeof value == 'number') { ";
}}y.restart();
while(!y.eof()){var F=y.next();
if(F.type=="dec"){q+="output += culture.numberFormat['.']; ";
}else{if(F.type=="comma"&&!F.hidden){q+="output += ','; ";
}else{if(F.type=="percent"){q+="type = 'percent'; ";
q+="output += culture.numberFormat.percent.symbol; ";
}else{if(F.type=="str"){q+="output += "+JSON.stringify(F.value)+"; ";
}else{if(F.type=="text"){q+="type = 'text'; ";
q+="output += value; ";
}else{if(F.type=="space"){q+="if (output) result.body.push(output); ";
q+="output = ''; ";
q+="result.body.push({ type: 'space', value: "+JSON.stringify(F.value)+" }); ";
}else{if(F.type=="fill"){q+="output += runtime.fill("+JSON.stringify(F.value)+"); ";
}else{if(F.type=="digit"){q+="output += "+(F.decimal?"decPart":"intPart")+".shift(); ";
}else{if(F.type=="date"){q+="output += runtime.date(culture, date, "+JSON.stringify(F.part)+", "+F.format+"); ";
}else{if(F.type=="time"){q+="output += runtime.time(time, "+JSON.stringify(F.part)+", "+F.format+", "+v+", "+F.fraction+"); ";
}else{if(F.type=="eltime"){q+="output += runtime.eltime(value, "+JSON.stringify(F.part)+", "+F.format+", "+F.fraction+"); ";
}else{if(F.type=="ampm"){q+="output += time.hours < 12 ? "+JSON.stringify(F.am)+" : "+JSON.stringify(F.pm)+"; ";
}}}}}}}}}}}}}q+="if (output) result.body.push(output); ";
q+="result.type = type; ";
q+="return result; ";
if(C){q=C+q+"}";
}return q;
}var b=Object.create(null);
var n=e({cond:"text",body:[{type:"text"}]});
function d(r){var q=b[r];
if(!q){var s=h(r);
var p=s.map(e);
p.push(n);
p=p.join("\n");
p="'use strict'; return function(value, culture){ if (!culture) culture = kendo.culture(); var output = '', type = null, result = { body: [] }; "+p+"; return result; };";
q=b[r]=new Function("runtime",p)(j);
}return q;
}var j={unpackDate:c.runtime.unpackDate,unpackTime:c.runtime.unpackTime,date:function(p,q,s,r){switch(s){case"d":switch(r){case 1:return q.date;
case 2:return g(q.date,2,"0");
case 3:return p.calendars.standard.days.namesAbbr[q.day];
case 4:return p.calendars.standard.days.names[q.day];
}break;
case"m":switch(r){case 1:return q.month+1;
case 2:return g(q.month+1,2,"0");
case 3:return p.calendars.standard.months.namesAbbr[q.month];
case 4:return p.calendars.standard.months.names[q.month];
case 5:return p.calendars.standard.months.names[q.month].charAt(0);
}break;
case"y":switch(r){case 2:return q.year%100;
case 4:return q.year;
}break;
}return"##";
},time:function(w,u,s,p,q){var v,r;
switch(u){case"h":v=g(p?w.hours%12||12:w.hours,s,"0");
if(q){r=(w.minutes+(w.seconds+w.milliseconds/1000)/60)/60;
}break;
case"m":v=g(w.minutes,s,"0");
if(q){r=(w.seconds+w.milliseconds/1000)/60;
}break;
case"s":v=g(w.seconds,s,"0");
if(q){r=w.milliseconds/1000;
}break;
}if(r){v+=r.toFixed(q).replace(/^0+/,"");
}return v;
},eltime:function(u,s,r,p){var t,q;
switch(s){case"h":t=u*24;
break;
case"m":t=u*24*60;
break;
case"s":t=u*24*60*60;
break;
}if(p){q=t-(t|0);
}t=g(t|0,r,"0");
if(q){t+=q.toFixed(p).replace(/^0+/,"");
}return t;
},fill:function(p){return p;
},formatInt:function(r,C,y,s,A){C=C.toFixed(s).replace(/\..*$/,"");
if(s>0){if(C==="0"){C="";
}else{if(C==="-0"){C="-";
}}}var u=C.length-1;
var z=[];
var x=0,B;
function p(D){if(A&&x&&x%3===0&&/^[0-9]$/.test(D)){B=r.numberFormat[","]+B;
}B=D+B;
x++;
}for(var v=y.length;
--v>=0;
){var t=y[v];
B="";
for(var w=t.length;
--w>=0;
){var q=t.charAt(w);
if(u<0){if(q=="0"){p("0");
}else{if(q=="?"){p(" ");
}}}else{p(C.charAt(u--));
}}if(v===0){while(u>=0){p(C.charAt(u--));
}}z.unshift(B);
}return z;
},formatDec:function(z,v,q){z=z.toFixed(q);
var w=z.indexOf(".");
if(w>=0){z=z.substr(w+1).replace(/0+$/,"");
}else{z="";
}var s=0;
var x=[];
for(var t=0;
t<v.length;
++t){var r=v[t];
var y="";
for(var u=0;
u<r.length;
++u){var p=r.charAt(u);
if(s<z.length){y+=z.charAt(s++);
}else{if(p=="0"){y+="0";
}else{if(p=="?"){y+=" ";
}}}}x.push(y);
}return x;
}};
function g(q,r,p){q+="";
while(q.length<r){q=p+q;
}return q;
}function m(r){var p=r.body;
var t="";
for(var s=0;
s<p.length;
++s){var q=p[s];
if(typeof q=="string"){t+=q;
}else{if(q.type=="space"){t+=" ";
}}}return t;
}kendo.spreadsheet.formatting={compile:d,parse:h,format:function(w,t,q){var s=d(t)(w,q);
var v=f.element("span");
v.__dataType=s.type;
var p=s.body;
if(s.color){v.attr.style={color:s.color};
}for(var u=0;
u<p.length;
++u){var r=p[u];
if(typeof r=="string"){v.children.push(f.text(r));
}else{if(r.type=="space"){v.children.push(f.element("span",{style:{visibility:"hidden"}},[f.text(r.value)]));
}}}return v;
},text:function(s,r,p){var q=d(r)(s,p);
return m(q);
},textAndColor:function(s,r,p){var q=d(r)(s,p);
return{text:m(q),color:q.color,type:q.type};
},type:function(q,p){return d(p)(q).type;
},adjustDecimals:function(r,q){var p=h(r);
a(p,q);
return i(p);
}};
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/runtime.functions",["spreadsheet/runtime","util/main"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var U=kendo.util;
var R=kendo.spreadsheet;
var x=R.calc;
var P=x.runtime;
var D=P.defineFunction;
var C=P.defineAlias;
var y=P.CalcError;
var N=R.RangeRef;
var z=R.CellRef;
var S=R.UnionRef;
var J=P.Matrix;
var O=R.Ref;
var A=P.daysInMonth;
var L=P.packDate;
var T=P.unpackDate;
var B=P.daysInYear;
["abs","cos","sin","acos","asin","tan","atan","exp","sqrt"].forEach(function(W){D(W,Math[W]).args([["*n","number"]]);
});
D("ln",Math.log).args([["*n","number"]]);
D("log",function(X,W){return Math.log(X)/Math.log(W);
}).args([["*num","number++"],["*base",["or","number++",["null",10]]],["?",["assert","$base != 1","DIV/0"]]]);
D("log10",function(W){return Math.log(W)/Math.log(10);
}).args([["*num","number++"]]);
D("pi",function(){return Math.PI;
}).args([]);
D("sqrtpi",function(W){return Math.sqrt(W*Math.PI);
}).args([["*num","number+"]]);
D("degrees",function(W){return 180*W/Math.PI%360;
}).args([["*radians","number"]]);
D("radians",function(W){return Math.PI*W/180;
}).args([["*degrees","number"]]);
function d(W){return(Math.exp(W)+Math.exp(-W))/2;
}D("cosh",d).args([["*num","number"]]);
D("acosh",function(W){return Math.log(W+Math.sqrt(W-1)*Math.sqrt(W+1));
}).args([["*num","number"],["?",["assert","$num >= 1"]]]);
function n(W){return(Math.exp(W)-Math.exp(-W))/2;
}D("sinh",n).args([["*num","number"]]);
D("asinh",function(W){return Math.log(W+Math.sqrt(W*W+1));
}).args([["*num","number"]]);
D("sec",function(W){return 1/Math.cos(W);
}).args([["*num","number"]]);
D("sech",function(W){return 1/d(W);
}).args([["*num","number"]]);
D("csc",function(W){return 1/Math.sin(W);
}).args([["*num","number"]]);
D("csch",function(W){return 1/n(W);
}).args([["*num","number"]]);
D("atan2",function(W,X){return Math.atan(X/W);
}).args([["*x","divisor"],["*y","number"]]);
function p(W){return n(W)/d(W);
}D("tanh",p).args([["*num","number"]]);
D("atanh",function(W){return Math.log(Math.sqrt(1-W*W)/(1-W));
}).args([["*num",["and","number",["(between)",-1,1]]]]);
D("cot",function(W){return 1/Math.tan(W);
}).args([["*num","divisor"]]);
D("coth",function(W){return 1/p(W);
}).args([["*num","divisor"]]);
D("acot",function(W){return Math.PI/2-Math.atan(W);
}).args([["*num","number"]]);
D("acoth",function(W){return Math.log((W+1)/(W-1))/2;
}).args([["*num","number"],["?",["or",["assert","$num < -1"],["assert","$num > 1"]]]]);
D("power",function(W,X){return Math.pow(W,X);
}).args([["*a","number"],["*b","number"]]);
D("mod",function(W,X){return W%X;
}).args([["*a","number"],["*b","divisor"]]);
D("quotient",function(W,X){return Math.floor(W/X);
}).args([["*a","number"],["*b","divisor"]]);
D("ceiling",function(W,X){return X?X*Math.ceil(W/X):0;
}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]);
D("ceiling.precise",function(W,X){X=Math.abs(X);
return X?X*Math.ceil(W/X):0;
}).args([["*number","number"],["*significance",["or","number",["null",1]]]]);
C("iso.ceiling","ceiling.precise");
D("ceiling.math",function(X,Y,W){if(!Y||!X){return 0;
}if(X<0&&(!W&&Y<0||W&&Y>0)){Y=-Y;
}return Y?Y*Math.ceil(X/Y):0;
}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]);
D("floor",function(W,X){return X?X*Math.floor(W/X):0;
}).args([["*number","number"],["*significance","number"],["?",["assert","$significance >= 0 || $number < 0"]]]);
D("floor.precise",function(W,X){X=Math.abs(X);
return X?X*Math.floor(W/X):0;
}).args([["*number","number"],["*significance",["or","number",["null",1]]]]);
D("floor.math",function(X,Y,W){if(!Y||!X){return 0;
}if(X<0&&(!W&&Y<0||W&&Y>0)){Y=-Y;
}return Y?Y*Math.floor(X/Y):0;
}).args([["*number","number"],["*significance",["or","number",["null","$number < 0 ? -1 : 1"]]],["*mode",["or","logical",["null",0]]]]);
D("int",Math.floor).args([["*number","number"]]);
D("mround",function(X,W){return W?W*Math.round(X/W):0;
}).args([["*number","number"],["*multiple","number"]]);
D("round",function(X,W){var Y=X<0?-1:1;
if(Y<0){X=-X;
}W=Math.pow(10,W);
X*=W;
X=Math.round(X);
return Y*X/W;
}).args([["*number","number"],["*digits","number"]]);
D("roundup",function(X,W){W=Math.pow(10,W);
X*=W;
X=X<0?Math.floor(X):Math.ceil(X);
return X/W;
}).args([["*number","number"],["*digits","number"]]);
D("rounddown",function(X,W){W=Math.pow(10,W);
X*=W;
X=X<0?Math.ceil(X):Math.floor(X);
return X/W;
}).args([["*number","number"],["*digits","number"]]);
D("even",function(X){var W=X<0?Math.floor(X):Math.ceil(X);
return W%2?W+(W<0?-1:1):W;
}).args([["*number","number"]]);
D("odd",function(X){var W=X<0?Math.floor(X):Math.ceil(X);
return W%2?W:W+(W<0?-1:1);
}).args([["*number","number"]]);
D("sign",function(W){return W<0?-1:W>0?1:0;
}).args([["*number","number"]]);
function h(W,X){while(X){var Y=W%X;
W=X;
X=Y;
}return W;
}function i(W,X){return Math.abs(W*X)/h(W,X);
}D("gcd",function(X){var W=X[0];
for(var Y=1;
Y<X.length;
++Y){W=h(W,X[Y]);
}return W;
}).args([["numbers",["collect","number"]]]);
D("lcm",function(X){var W=X[0];
for(var Y=1;
Y<X.length;
++Y){W=i(W,X[Y]);
}return W;
}).args([["numbers",["collect","number"]]]);
D("sum",function(W){return W.reduce(function(Y,X){return Y+X;
},0);
}).args([["numbers",["collect","number"]]]);
D("product",function(W){return W.reduce(function(Y,X){return Y*X;
},1);
}).args([["numbers",["collect","number"]]]);
D("sumproduct",function(W,X){var Y=0;
W.each(function(ab,ac,Z){if(typeof ab=="number"){for(var aa=0;
aa<X.length;
++aa){var ad=X[aa].get(ac,Z);
if(typeof ad!="number"){return;
}ab*=ad;
}Y+=ab;
}});
return Y;
}).args([["a1","matrix"],["+",["a2",["and","matrix",["assert","$a2.width == $a1.width"],["assert","$a2.height == $a1.height"]]]]]);
D("sumsq",function(W){return W.reduce(function(Y,X){return Y+X*X;
},0);
}).args([["numbers",["collect","number"]]]);
D("sumx2my2",function(W,X){var Y=0;
W.each(function(ab,aa,Z){var ac=X.get(aa,Z);
if(typeof ab=="number"&&typeof ac=="number"){Y+=ab*ab-ac*ac;
}});
return Y;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
D("sumx2py2",function(W,X){var Y=0;
W.each(function(ab,aa,Z){var ac=X.get(aa,Z);
if(typeof ab=="number"&&typeof ac=="number"){Y+=ab*ab+ac*ac;
}});
return Y;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
D("sumxmy2",function(W,X){var Y=0;
W.each(function(ab,aa,Z){var ac=X.get(aa,Z);
if(typeof ab=="number"&&typeof ac=="number"){Y+=(ab-ac)*(ab-ac);
}});
return Y;
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.width == $a.width"],["assert","$b.height == $a.height"]]]]);
D("seriessum",function(aa,Y,X,W){var Z=0;
W.each(function(ab){if(typeof ab!="number"){throw new y("VALUE");
}Z+=ab*Math.pow(aa,Y);
Y+=X;
});
return Z;
}).args([["x","number"],["y","number"],["m","number"],["a","matrix"]]);
D("min",function(W){return Math.min.apply(Math,W);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
D("max",function(W){return Math.max.apply(Math,W);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
D("counta",function(W){return W.length;
}).args([["values",["#collect","anyvalue"]]]);
D("count",function(W){return W.length;
}).args([["numbers",["#collect","number"]]]);
D("countunique",function(Y){var W=0,X=[];
Y.forEach(function(Z){if(X.indexOf(Z)<0){W++;
X.push(Z);
}});
return W;
}).args([["values",["#collect","anyvalue"]]]);
D("countblank",function(W){var Y=0;
function X(aa){if(aa==null||aa===""){Y++;
}}function Z(aa){for(var ab=0;
ab<aa.length;
++ab){var ac=aa[ab];
if(ac instanceof J){ac.each(X,true);
}else{X(ac);
}}}Z(W);
return Y;
}).args([["+",["args",["or","matrix","anyvalue"]]]]);
D("iseven",function(W){return W%2===0;
}).args([["*number","number"]]);
D("isodd",function(W){return W%2!==0;
}).args([["*number","number"]]);
D("n",function(W){if(typeof W=="boolean"){return W?1:0;
}if(typeof W=="number"){return W;
}return 0;
}).args([["*value","anyvalue"]]);
D("na",function(){return new y("N/A");
}).args([]);
function G(W,Z){var X=[],aa=0,ab=W[0];
while(aa<W.length){X.push({matrix:W[aa++],pred:M(W[aa++])});
}ROW:for(var ac=0;
ac<ab.height;
++ac){COL:for(var Y=0;
Y<ab.width;
++Y){for(aa=0;
aa<X.length;
++aa){var ad=X[aa].matrix.get(ac,Y);
if(!X[aa].pred(ad==null||ad===""?0:ad)){continue COL;
}}Z(ac,Y);
}}}var s=[["m1","matrix"],["c1","anyvalue"],[["m2",["and","matrix",["assert","$m1.width == $m2.width"],["assert","$m1.height == $m2.height"]]],["c2","anyvalue"]]];
D("countifs",function(Y,W,Z){var X=0;
Z.unshift(Y,W);
G(Z,function(){X++;
});
return X;
}).args(s);
var v=[["range","matrix"]].concat(s);
D("sumifs",function(Z,Y,X,W){W.unshift(Z,K,Y,X);
var aa=0;
G(W,function(ac,ab){var ad=Z.get(ac,ab);
if(ad){aa+=ad;
}});
return aa;
}).args(v);
D("averageifs",function(aa,Z,X,W){W.unshift(aa,K,Z,X);
var ab=0,Y=0;
G(W,function(ad,ac){var ae=aa.get(ad,ac);
if(ae==null||ae===""){ae=0;
}ab+=ae;
Y++;
});
return Y?ab/Y:new y("DIV/0");
}).args(v);
D("countif",function(Y,X){X=M(X);
var W=0;
Y.each(function(Z){if(X(Z)){W++;
}});
return W;
}).args([["range","matrix"],["*criteria","anyvalue"]]);
var u=[["range","matrix"],["*criteria","anyvalue"],["sumRange",["or",["and","matrix",["assert","$sumRange.width == $range.width"],["assert","$sumRange.height == $range.height"]],["null","$range"]]]];
D("sumif",function(X,W,Z){var Y=0;
W=M(W);
X.each(function(ad,ab,aa){if(W(ad)){var ac=Z.get(ab,aa);
if(K(ac)){Y+=ac||0;
}}});
return Y;
}).args(u);
D("averageif",function(Y,X,aa){var Z=0,W=0;
X=M(X);
Y.each(function(ae,ac,ab){if(X(ae)){var ad=aa.get(ac,ab);
if(K(ad)){Z+=ad||0;
W++;
}}});
return W?Z/W:new y("DIV/0");
}).args(u);
(function(W){W("large",function(Y,X){return Y.sort(E)[X];
});
W("small",function(Y,X){return Y.sort(w)[X];
});
}(function(X,W){D(X,function(Z,aa){var ab=[];
var Y=Z.each(function(ac){if(ac instanceof y){return ac;
}if(typeof ac=="number"){ab.push(ac);
}});
if(Y){return Y;
}if(aa>ab.length){return new y("NUM");
}return W(ab,aa-1);
}).args([["array","matrix"],["*nth","number++"]]);
}));
function a(W){return W.reduce(function(Y,X){return Y+X;
},0)/W.length;
}function q(Y,X,W){if(W==null){W=a(Y);
}return Y.reduce(function(aa,Z){return aa+Math.pow(Z-W,2);
},0)/X;
}function o(X,W){return Math.sqrt(q(X,W));
}D("stdev.s",function(W){return o(W,W.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("stdev.p",function(W){return o(W,W.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("var.s",function(W){return q(W,W.length-1);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("var.p",function(W){return q(W,W.length);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
D("median",function(X){var W=X.length;
X.sort(w);
if(W%2){return X[W>>1];
}return(X[W>>1]+X[W>>1+1])/2;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","N/A"]]]);
D("mode.sngl",function(ab){ab.sort(w);
var ac=null,W=0,Y=1,Z=null;
for(var X=0;
X<ab.length;
++X){var aa=ab[X];
if(aa!=ac){W=1;
ac=aa;
}else{W++;
}if(W>Y){Y=W;
Z=aa;
}}return Z==null?new y("N/A"):Z;
}).args([["numbers",["collect","number"]]]);
D("mode.mult",function(Y){var aa=Object.create(null),X=2,Z=[];
Y.forEach(function(ab){var ac=aa[ab]||0;
aa[ab]=++ac;
if(ac==X){Z.push(ab);
}else{if(ac>X){X=ac;
Z=[ab];
}}});
var W=new J(this);
Z.forEach(function(ac,ab){W.set(ab,0,ac);
});
return W;
}).args([["numbers",["collect","number"]]]);
D("geomean",function(X){var W=X.length;
var Y=X.reduce(function(aa,Z){if(Z<0){throw new y("NUM");
}return aa*Z;
},1);
return Math.pow(Y,1/W);
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
D("harmean",function(X){var W=X.length;
var Y=X.reduce(function(aa,Z){if(!Z){throw new y("DIV/0");
}return aa+1/Z;
},0);
return W/Y;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length > 0","NUM"]]]);
D("trimmean",function(Z,aa){var Y=Z.length;
Z.sort(w);
var W=Math.floor(Y*aa);
if(W%2){--W;
}W/=2;
var ab=0;
for(var X=W;
X<Y-W;
++X){ab+=Z[X];
}return ab/(Y-W*2);
}).args([["numbers",["collect","number",1]],["percent",["and","number",["[between)",0,1]]],["?",["assert","$numbers.length > 0","NUM"]]]);
D("frequency",function(Y,W){Y.sort(w);
W.sort(w);
var ab=-Infinity;
var Z=0;
function X(ac){var ad=0;
while(Z<Y.length&&Y[Z]>ab&&Y[Z]<=ac){++ad;
++Z;
}return ad;
}var aa=new J(this);
W.forEach(function(ae,ac){var ad=X(ae);
ab=ae;
aa.set(ac,0,ad);
});
aa.set(aa.height,0,Y.length-Z);
return aa;
}).args([["data",["collect","number",1]],["bins",["collect","number",1]]]);
D("rank.eq",function(Z,X,W){X.sort(W?w:E);
var Y=X.indexOf(Z);
return Y<0?new y("N/A"):Y+1;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
C("rank","rank.eq");
D("rank.avg",function(aa,Y,W){Y.sort(W?w:E);
var Z=Y.indexOf(aa);
if(Z<0){return new y("N/A");
}for(var X=Z;
Y[X]==aa;
++X){}return(Z+X+1)/2;
}).args([["value","number"],["numbers",["collect","number"]],["order",["or","logical",["null",false]]]]);
D("kurt",function(Y){var X=Y.length;
var W=a(Y);
var ab=q(Y,X-1,W);
var Z=Math.sqrt(ab);
var aa=Y.reduce(function(ad,ac){return ad+Math.pow((ac-W)/Z,4);
},0);
return X*(X+1)/((X-1)*(X-2)*(X-3))*aa-3*Math.pow(X-1,2)/((X-2)*(X-3));
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 4","NUM"]]]);
function m(ab,ad,W){var aa=0,Z=0,Y=null,ac=null,X=false;
ab.forEach(function(ae){if(ae<ad){aa++;
Y=Y==null?ae:Math.max(Y,ae);
}else{if(ae>ad){Z++;
ac=ac==null?ae:Math.min(ac,ae);
}else{X=true;
}}});
if(!aa&&!Z){return new y("N/A");
}if(X){if(W){return(aa+1)/(ab.length+1);
}return aa/(aa+Z);
}return((ac-ad)*m(ab,Y,W)+(ad-Y)*m(ab,ac,W))/(ac-Y);
}var t=[["array",["collect","number",1]],["x","number"],["significance",["or",["null",3],"integer++"]],["?",["assert","$array.length > 0","NUM"]]];
D("percentrank.inc",function(W,Z,Y){var X=m(W,Z,0);
X=X.toFixed(Y+1);
return parseFloat(X.substr(0,X.length-1));
}).args(t);
D("percentrank.exc",function(W,Z,Y){var X=m(W,Z,1);
X=X.toFixed(Y+1);
return parseFloat(X.substr(0,X.length-1));
}).args(t);
C("percentrank","percentrank.inc");
function e(ac,ad,Y){var ab=0;
var W=a(ac);
var X=a(ad);
var aa=ac.length;
for(var Z=0;
Z<aa;
++Z){ab+=(ac[Z]-W)*(ad[Z]-X);
}return ab/Y;
}D("covariance.p",function(W,X){return e(W,X,W.length);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 0","DIV/0"]]]);
D("covariance.s",function(W,X){return e(W,X,W.length-1);
}).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length == $array2.length","N/A"]],["?",["assert","$array1.length > 1","DIV/0"]]]);
C("covar","covariance.p");
var g=U.memoize(function(Y){for(var X=2,W=1;
X<=Y;
++X){W*=X;
}return W;
});
D("fact",g).args([["*n","integer+"]]);
D("factdouble",function(Y){for(var X=2+(Y&1),W=1;
X<=Y;
X+=2){W*=X;
}return W;
}).args([["*n","integer+"]]);
D("multinomial",function(X){var W=1,Y=0;
X.forEach(function(Z){if(Z<0){throw new y("NUM");
}Y+=Z;
W*=g(Z);
});
return g(Y)/W;
}).args([["numbers",["collect","number"]]]);
var c=U.memoize(function(Z,Y){for(var W=Y+1,X=1,aa=1,ab=1;
X<=Z-Y;
++W,++X){aa*=W;
ab*=X;
}return aa/ab;
});
D("combin",c).args([["*n","integer++"],["*k",["and","integer",["[between]",0,"$n"]]]]);
D("combina",function(X,W){return c(X+W-1,X-1);
}).args([["*n","integer++"],["*k",["and","integer",["[between]",1,"$n"]]]]);
D("average",function(W){var X=W.reduce(function(Z,Y){return Z+Y;
},0);
return X/W.length;
}).args([["numbers",["collect",["and","number",["not","boolean"]]]],["?",["assert","$numbers.length > 0","DIV/0"]]]);
D("averagea",function(Y){var X=0,W=0;
Y.forEach(function(Z){if(typeof Z!="string"){X+=Z;
}++W;
});
return W?X/W:new y("DIV/0");
}).args([["values",["collect","anyvalue"]]]);
function j(Z,aa){Z.sort(w);
var Y=Z.length;
var X=aa|0,W=aa-X;
if(X===0){return Z[0];
}if(X>=Y){return Z[Y-1];
}--X;
return Z[X]+W*(Z[X+1]-Z[X]);
}function l(W,X){var Y=X*(W.length-1)+1;
return j(W,Y);
}function k(W,X){var Y=X*(W.length+1);
return j(W,Y);
}D("percentile.inc",l).args([["numbers",["collect","number",1]],["p",["and","number",["[between]",0,1]]]]);
D("percentile.exc",k).args([["numbers",["collect","number",1]],["p",["and","number",["(between)",0,1]]]]);
D("quartile.inc",function(W,X){return l(W,X/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
D("quartile.exc",function(W,X){return k(W,X/4);
}).args([["numbers",["collect","number",1]],["quarter",["values",0,1,2,3,4]]]);
C("quartile","quartile.inc");
C("percentile","percentile.inc");
var r=["AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","STDEV.S","STDEV.P","SUM","VAR.S","VAR.P","MEDIAN","MODE.SNGL","LARGE","SMALL","PERCENTILE.INC","QUARTILE.INC","PERCENTILE.EXC","QUARTILE.EXC"];
function F(ac,W,ab){var ad=[];
var Z=1;
var Y=2;
var aa=4;
(function X(ae){if(ae instanceof O){ac.getRefCells(ae,true).forEach(function(ag){var ai=ag.value;
if(ab&Z&&ag.hidden){return;
}if(ag.formula){var ah=ag.formula.print(ag.row,ag.col);
if(/^\s*(?:aggregate|subtotal)\s*\(/i.test(ah)){if(!(ab&aa)){return;
}}if("value" in ag.formula){ai=ag.formula.value;
}}if(ab&Y&&ai instanceof y){return;
}if(typeof ai=="number"||ai instanceof y){ad.push(ai);
}});
}else{if(Array.isArray(ae)){for(var af=0;
af<ae.length;
++af){X(ae[af]);
}}else{if(ae instanceof J){ae.each(X);
}else{if(typeof ae=="number"){ad.push(ae);
}else{if(ae instanceof y&&!(ab&Y)){ad.push(ae);
}}}}}}(W));
return ad;
}D("aggregate",function(X,Y,Z,W){var aa=this;
aa.resolveCells(W,function(){var ac;
if(Y>12){ac=F(aa,W[0],Z);
var ab=W[1];
if(ab instanceof z){ab=aa.getRefData(ab);
}if(typeof ab!="number"){return X(new y("VALUE"));
}}else{ac=F(aa,W,Z);
}aa.func(r[Y-1],X,ac);
});
}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],["options",["or",["null",0],["values",0,1,2,3,4,5,6,7]]],["args","rest"]]);
D("subtotal",function(X,Y){var ab=this;
var aa=Y>100;
if(aa){Y-=100;
}var W=[];
for(var Z=2;
Z<arguments.length;
++Z){W.push(arguments[Z]);
}ab.resolveCells(W,function(){var ac=F(ab,W,aa?1:0);
ab.func(r[Y-1],X,ac);
});
}).argsAsync([["funcId",["values",1,2,3,4,5,6,7,8,9,10,11,101,102,103,104,105,106,107,108,109,110,111]],["+",["ref",["or","ref","#matrix"]]]]);
D("avedev",function(X){var W=X.reduce(function(Z,Y){return Z+Y;
},0)/X.length;
return X.reduce(function(Z,Y){return Z+Math.abs(Y-W);
},0)/X.length;
}).args([["numbers",["collect","number"]],["?",["assert","$numbers.length >= 2","NUM"]]]);
function b(ab,Y,Z,W){if(!W){return c(Y,ab)*Math.pow(Z,ab)*Math.pow(1-Z,Y-ab);
}else{var aa=0;
for(var X=0;
X<=ab;
++X){aa+=c(Y,X)*Math.pow(Z,X)*Math.pow(1-Z,Y-X);
}return aa;
}}D("binom.dist",b).args([["successes","integer+"],["trials",["and","integer",["assert","$trials >= $successes"]]],["probability",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
C("binomdist","binom.dist");
D("binom.inv",function(X,Y,W){for(var Z=0;
Z<=X;
++Z){if(b(Z,X,Y,true)>=W){return Z;
}}return new y("N/A");
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["alpha",["and","number",["[between]",0,1]]]]);
C("critbinom","binom.inv");
D("binom.dist.range",function(X,Y,Z,aa){var ab=0;
for(var W=Z;
W<=aa;
++W){ab+=c(X,W)*Math.pow(Y,W)*Math.pow(1-Y,X-W);
}return ab;
}).args([["trials","integer+"],["probability",["and","number",["[between]",0,1]]],["successes_min",["and","integer",["[between]",0,"$trials"]]],["successes_max",["or",["and","integer",["[between]","$successes_min","$trials"]],["null","$successes_min"]]]]);
D("negbinom.dist",function(aa,X,Y,W){if(W){var Z=0;
while(aa>=0){Z+=c(aa+X-1,aa)*Math.pow(Y,X)*Math.pow(1-Y,aa);
aa--;
}return Z;
}return c(aa+X-1,aa)*Math.pow(Y,X)*Math.pow(1-Y,aa);
}).args([["number_f","integer+"],["number_s","integer+"],["probability_s",["and","number",["[between]",0,1]]],["cumulative","logical"]]);
C("negbinomdist","negbinom.dist");
D("address",function(aa,Z,X,W,ab){var Y=new z(aa-1,Z-1,X-1);
if(ab){Y.setSheet(ab,true);
}return W?Y.print(0,0):Y.print();
}).args([["row","integer++"],["col","integer++"],["abs",["or",["null",1],["values",1,2,3,4]]],["a1",["or",["null",true],"logical"]],["sheet",["or","null","string"]]]);
D("areas",function(Y){var W=0;
(function X(Z){if(Z instanceof z||Z instanceof N){W++;
}else{if(Z instanceof S){Z.refs.forEach(X);
}}}(Y));
return W;
}).args([["ref","ref"]]);
D("choose",function(X,W){if(X>W.length){return new y("N/A");
}else{return W[X-1];
}}).args([["*index","integer"],["+",["value","anything"]]]);
D("column",function(W){if(!W){return this.formula.col+1;
}if(W instanceof z){return W.col+1;
}return this.asMatrix(W).mapCol(function(X){return X+W.topLeft.col+1;
});
}).args([["ref",["or","area","null"]]]);
D("columns",function(W){return W instanceof O?W.width():W.width;
}).args([["ref",["or","area","#matrix"]]]);
D("formulatext",function(X){var W=this.getRefCells(X)[0];
if(!W.formula){return new y("N/A");
}return W.formula.print(W.row,W.col);
}).args([["ref","ref"]]);
D("hlookup",function(aa,X,Z,W){var Y=null;
X.eachCol(function(ab){var ac=X.get(0,ab);
if(W){if(ac>aa){return true;
}Y=ab;
}else{if(ac===aa){Y=ab;
return true;
}}});
if(Y==null){return new y("N/A");
}return X.get(Z-1,Y);
}).args([["value","anyvalue"],["range","matrix"],["row","integer++"],["approx",["or","logical",["null",true]]]]);
D("index",function(Z,aa,X,W){var Y=Z instanceof S?Z.refs[W-1]:Z;
if(!aa&&!X||!Y){return new y("N/A");
}Y=this.asMatrix(Y);
if(Y.width>1&&Y.height>1){if(aa&&X){return Y.get(aa-1,X-1);
}if(!aa){return Y.mapRow(function(ab){return Y.get(ab,X-1);
});
}if(!X){return Y.mapCol(function(ab){return Y.get(aa-1,ab);
});
}}if(Y.width==1){return Y.get(aa-1,0);
}if(Y.height==1){return Y.get(0,X-1);
}return new y("REF");
}).args([["range",["or","matrix","ref"]],["row",["or","integer+","null"]],["col",["or","integer+","null"]],["areanum",["or","integer++",["null",1]]]]);
D("indirect",function(Z){try{var Y=this.formula;
var X=x.parseFormula(Y.sheet,Y.row,Y.col,Z);
if(!(X.ast instanceof O)){throw 1;
}return X.ast.absolute(Y.row,Y.col);
}catch(W){return new y("REF");
}}).args([["thing","string"]]);
D("match",function(aa,Y,Z){var X=1,W;
if(Z===0){W=M(aa);
}else{if(Z===-1){W=M("<="+aa);
}else{if(Z===1){W=M(">="+aa);
}}}if(Y.each(function(ab){if(ab!=null&&W(ab)){if(Z!==0&&aa!=ab){--X;
}return true;
}X++;
},true)&&X>0){return X;
}else{return new y("N/A");
}}).args([["value","anyvalue"],["range","matrix"],["type",["or",["values",-1,0,1],["null",1]]]]);
D("offset",function(Y,Z,W,X,ab){var aa=(Y instanceof z?Y:Y.topLeft).clone();
aa.row+=Z;
aa.col+=W;
if(aa.row<0||aa.col<0){return new y("VALUE");
}if(X>1||ab>1){return new N(aa,new z(aa.row+X-1,aa.col+ab-1)).setSheet(Y.sheet,Y.hasSheet());
}return aa;
}).args([["ref","area"],["*rows","integer"],["*cols","integer"],["*height",["or","integer++",["null","$ref.height()"]]],["*width",["or","integer++",["null","$ref.width()"]]]]);
D("row",function(W){if(!W){return this.formula.row+1;
}if(W instanceof z){return W.row+1;
}return this.asMatrix(W).mapRow(function(X){return X+W.topLeft.row+1;
});
}).args([["ref",["or","area","null"]]]);
D("rows",function(W){return W instanceof O?W.height():W.height;
}).args([["ref",["or","area","#matrix"]]]);
D("vlookup",function(aa,Y,X,W){var Z=null;
Y.eachRow(function(ac){var ab=Y.get(ac,0);
if(W){if(ab>aa){return true;
}Z=ac;
}else{if(ab===aa){Z=ac;
return true;
}}});
if(Z==null){return new y("N/A");
}return Y.get(Z,X-1);
}).args([["value","anyvalue"],["range","matrix"],["col","integer++"],["approx",["or","logical",["null",true]]]]);
D("date",function(Y,X,W){return L(Y,X-1,W);
}).args([["*year","integer"],["*month","integer"],["*date","integer"]]);
D("day",function(W){return T(W).date;
}).args([["*date","date"]]);
D("month",function(W){return T(W).month+1;
}).args([["*date","date"]]);
D("year",function(W){return T(W).year;
}).args([["*date","date"]]);
D("weekday",function(W){return T(W).day+1;
}).args([["*date","date"]]);
D("weeknum",function(W,aa){var Y=L(T(W).year,0,1);
var Z=T(Y);
var X;
if(aa==21){X=3-(Z.day+6)%7;
if(X<0){X+=7;
}Y+=X;
Z.date+=X;
Z.day=4;
aa=1;
}else{if(aa==1){aa=0;
}else{if(aa==2){aa=1;
}else{aa=(aa-10)%7;
}}}X=Z.day-aa;
if(X<0){X+=7;
}Y-=X;
return Math.ceil((W+1-Y)/7);
}).args([["*date","date"],["*type",["or",["null",1],["values",1,2,11,12,13,14,15,16,17,21]]]]);
function V(X){var W=T(L(X,0,1));
if(W.day==4||W.day==3&&P.isLeapYear(X)){return 53;
}return 52;
}D("isoweeknum",function I(X){var W=T(X);
var Y=W.day||7;
var Z=Math.floor((W.ord-Y+10)/7);
if(Z<1){return V(W.year-1);
}else{if(Z==53&&Z>V(W.year)){return 1;
}}return Z;
}).args([["*date","date"]]);
D("now",function(){return P.dateToSerial(new Date());
}).args([]);
D("today",function(){return P.dateToSerial(new Date())|0;
}).args([]);
D("time",function(W,X,Y){return P.packTime(W,X,Y,0);
}).args([["*hours","integer"],["*minutes","integer"],["*seconds","integer"]]);
D("hour",function(W){return P.unpackTime(W).hours;
}).args([["*time","datetime"]]);
D("minute",function(W){return P.unpackTime(W).minutes;
}).args([["*time","datetime"]]);
D("second",function(W){return P.unpackTime(W).seconds;
}).args([["*time","datetime"]]);
D("edate",function(W,Z){var X=T(W);
var Y=X.month+Z;
var aa=X.year+Math.floor(Y/12);
Y%=12;
if(Y<0){Y+=12;
}X=Math.min(X.date,A(aa,Y));
return L(aa,Y,X);
}).args([["*start_date","date"],["*months","integer"]]);
D("eomonth",function(W,Z){var X=T(W);
var Y=X.month+Z;
var aa=X.year+Math.floor(Y/12);
Y%=12;
if(Y<0){Y+=12;
}X=A(aa,Y);
return L(aa,Y,X);
}).args([["*start_date","date"],["*months","integer"]]);
D("workday",function(W,aa,Y){var Z=aa>0?1:-1;
aa=Math.abs(aa);
var X=T(W).day;
while(aa>0){W+=Z;
X=(X+Z)%7;
if(X>0&&X<6&&Y.indexOf(W)<0){--aa;
}}return W;
}).args([["start_date","date"],["days","integer"],["holidays",["collect","date"]]]);
D("networkdays",function(X,Z,aa){if(X>Z){var ab=X;
X=Z;
Z=ab;
}var W=0;
var Y=T(X).day;
while(X<=Z){if(Y>0&&Y<6&&aa.indexOf(X)<0){W++;
}X++;
Y=(Y+1)%7;
}return W;
}).args([["start_date","date"],["end_date","date"],["holidays",["collect","date"]]]);
D("days",function(X,W){return W-X;
}).args([["*start_date","date"],["*end_date","date"]]);
function f(aa,Y,Z){var W=T(aa);
var X=T(Y);
if(Z){if(W.date==31){W.date=30;
}if(X.date==31){X.date=30;
}}else{if(W.month==1&&X.month==1&&W.date==A(W.year,1)&&X.date==A(X.year,1)){X.date=30;
}if(W.date==A(W.year,W.month)){W.date=30;
if(X.date==31){X.date=30;
}}else{if(W.date==30&&X.date==31){X.date=30;
}}}return 360*(X.year-W.year)+30*(X.month-W.month)+(X.date-W.date);
}P._days_360=f;
D("days360",f).args([["*start_date","date"],["*end_date","date"],["*method",["or","logical",["null",false]]]]);
D("yearfrac",function(Y,W,X){switch(X){case 0:return f(Y,W,false)/360;
case 1:return(W-Y)/B(T(Y).year);
case 2:return(W-Y)/360;
case 3:return(W-Y)/365;
case 4:return f(Y,W,true)/360;
}}).args([["*start_date","date"],["*end_date","date"],["*method",["or",["null",0],["values",0,1,2,3,4]]]]);
D("datevalue",function(X){var W=P.parseDate(X);
if(W){return P.dateToSerial(W);
}return new y("VALUE");
}).args([["*text","string"]]);
D("timevalue",function(ab){var Y=ab.toLowerCase().match(/(\d+):(\d+)(:(\d+)(\.(\d+))?)?\s*(am?|pm?)?/);
if(Y){var X=parseFloat(Y[1]);
var Z=parseFloat(Y[2]);
var aa=Y[3]?parseFloat(Y[4]):0;
var W=Y[7];
if(W&&(X>12||X<1)){return new y("VALUE");
}if(/^p/.test(W)){X+=12;
}return P.packTime(X,Z,aa,0);
}return new y("VALUE");
}).args([["*text","string"]]);
D("mdeterm",function(X){var W=X.each(function(Y){if(typeof Y!="number"){return new y("VALUE");
}},true);
return W||X.determinant();
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
D("transpose",function(W){return W.transpose();
}).args([["range","matrix"]]);
D("mmult",function(W,X){return W.multiply(X);
}).args([["a","matrix"],["b",["and","matrix",["assert","$b.height == $a.width"]]]]);
D("munit",function(W){return new J(this).unit(W);
}).args([["n","integer+"]]);
D("minverse",function(X){var W=X.each(function(Y){if(typeof Y!="number"){return new y("VALUE");
}},true);
return W||X.inverse()||new y("VALUE");
}).args([["m",["and","matrix",["assert","$m.width == $m.height"]]]]);
D("rand",function(){return Math.random();
}).args([]);
D("randbetween",function(X,W){return X+Math.floor((W-X+1)*Math.random());
}).args([["min","integer"],["max",["and","integer",["assert","$max >= $min"]]]]);
D("true",function(){return true;
}).args([]);
D("false",function(){return true;
}).args([]);
D("roman",function(W){return U.arabicToRoman(W).toUpperCase();
}).args([["*number","integer"]]);
D("arabic",function(X){var W=U.romanToArabic(X);
return W==null?new y("VALUE"):W;
}).args([["*roman","string"]]);
D("base",function(X,Y,W){var Z=X.toString(Y).toUpperCase();
while(Z.length<W){Z="0"+Z;
}return Z;
}).args([["*number","integer"],["*radix",["and","integer",["[between]",2,36]]],["*minLen",["or","integer+",["null",0]]]]);
D("decimal",function(Z,Y){Z=Z.toUpperCase();
var aa=0;
for(var X=0;
X<Z.length;
++X){var W=Z.charCodeAt(X);
if(W>=48&&W<=57){W-=48;
}else{if(W>=65&&W<55+Y){W-=55;
}else{return new y("VALUE");
}}aa=aa*Y+W;
}return aa;
}).args([["*text","string"],["*radix",["and","integer",["[between]",2,36]]]]);
D("char",function(W){return String.fromCharCode(W);
}).args([["*code","integer+"]]);
var Q=/[\0-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g;
D("clean",function(W){return W.replace(Q,"");
}).args([["*text","string"]]);
D("code",function(W){return W.charAt(0);
}).args([["*text","string"]]);
C("unichar","char");
C("unicode","code");
D("concatenate",function(){var X="";
for(var W=0;
W<arguments.length;
++W){X+=arguments[W];
}return X;
}).args([["+",["*text","string"]]]);
D("dollar",function(Z,X){var Y="$#,##0.DECIMALS;($#,##0.DECIMALS)";
var W="";
while(X-->0){W+="0";
}Y=Y.replace(/DECIMALS/g,W);
return R.formatting.text(Z,Y);
}).args([["*number","number"],["*decimals",["or","integer++",["null",2]]]]);
D("exact",function(W,X){return W===X;
}).args([["*text1","string"],["*text2","string"]]);
D("find",function(Z,Y,X){var W=Y.indexOf(Z,X-1);
return W<0?new y("VALUE"):W+1;
}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]);
D("fixed",function(aa,X,Z){var Y=Z?"0.DECIMALS":"#,##0.DECIMALS";
var W="";
while(X-->0){W+="0";
}Y=Y.replace(/DECIMALS/g,W);
return R.formatting.text(aa,Y);
}).args([["*number","number"],["*decimals",["or","integer++",["null",2]]],["*noCommas",["or","boolean",["null",false]]]]);
D("left",function(X,W){return X.substr(0,W);
}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]);
D("right",function(X,W){return X.substr(-W);
}).args([["*text","string"],["*length",["or","integer+",["null",1]]]]);
D("len",function(W){return W.length;
}).args([["*text","string"]]);
D("lower",function(W){return W.toLowerCase();
}).args([["*text","string"]]);
D("upper",function(W){return W.toUpperCase();
}).args([["*text","string"]]);
D("ltrim",function(W){return W.replace(/^\s+/,"");
}).args([["*text","string"]]);
D("rtrim",function(W){return W.replace(/\s+$/,"");
}).args([["*text","string"]]);
D("trim",function(W){return W.replace(/^\s+|\s+$/,"");
}).args([["*text","string"]]);
D("mid",function(Y,X,W){return Y.substr(X-1,W);
}).args([["*text","string"],["*start","integer++"],["*length","integer+"]]);
D("proper",function(W){return W.toLowerCase().replace(/\b./g,function(X){return X.toUpperCase();
});
}).args([["*text","string"]]);
D("replace",function(Z,Y,W,X){return Z.substr(0,--Y)+X+Z.substr(Y+W);
}).args([["*text","string"],["*start","integer++"],["*length","integer+"],["*newText","string"]]);
D("rept",function(Y,W){var X="";
while(W-->0){X+=Y;
}return X;
}).args([["*text","string"],["*number","integer+"]]);
D("search",function(Z,Y,X){var W=Y.toLowerCase().indexOf(Z.toLowerCase(),X-1);
return W<0?new y("VALUE"):W+1;
}).args([["*substring","string"],["*string","string"],["*start",["or","integer++",["null",1]]]]);
D("substitute",function(ab,Y,W,X){if(Y===W){return ab;
}var Z=-1;
function aa(){ab=ab.substring(0,Z)+W+ab.substring(Z+Y.length);
}while((Z=ab.indexOf(Y,Z+1))>=0){if(X==null){aa();
}else{if(--X===0){aa();
break;
}}}return ab;
}).args([["*text","string"],["*oldText","string"],["*newText","string"],["*nth",["or","integer++","null"]]]);
D("t",function(W){return typeof W=="string"?W:"";
}).args([["*value","anyvalue"]]);
D("text",function(X,W){return R.formatting.text(X,W);
}).args([["*value","anyvalue"],["*format","string"]]);
D("value",function(W){if(typeof W=="number"){return W;
}if(typeof W=="boolean"){return +W;
}W=(W+"").replace(/[$,]/g,"");
W=parseFloat(W);
return isNaN(W)?new y("VALUE"):W;
}).args([["*value","anyvalue"]]);
function H(W,X){this.link=W;
this.text=X;
}H.prototype.toString=function(){return this.text;
};
D("hyperlink",function(W,X){return new H(W,X);
}).args([["*link","string"],["*text",["or","string",["null","$link"]]]]);
D("iferror",function(W,X){return W instanceof y?X:W;
}).args([["*value","forced!"],["*value_if_error","anyvalue!"]]);
var M=function(){var ae=Object.create(null);
function ad(af,ah){if(typeof ah=="string"){var ag=parseFloat(ah);
if(!isNaN(ag)&&ag==ah){ah=ag;
}}return function(ai){var aj=ah;
if(typeof ai=="string"&&typeof aj=="string"){ai=ai.toLowerCase();
aj=aj.toLowerCase();
}return af(ai,aj);
};
}function ac(af){if(typeof af=="string"){return af.toLowerCase();
}return af;
}function Z(af,ag){return ac(af)<ac(ag);
}function aa(af,ag){return ac(af)<=ac(ag);
}function X(af,ag){return ac(af)>ac(ag);
}function Y(af,ag){return ac(af)>=ac(ag);
}function ab(af,ag){return ac(af)!=ac(ag);
}function W(af,ag){if(ag instanceof RegExp){return ag.test(af);
}return ac(af)==ac(ag);
}return function(af){if(typeof af=="function"){return af;
}var ag;
if(ag=/^=(.*)$/.exec(af)){return ad(W,ag[1]);
}if(ag=/^<>(.*)$/.exec(af)){return ad(ab,ag[1]);
}if(ag=/^<=(.*)$/.exec(af)){return ad(aa,ag[1]);
}if(ag=/^<(.*)$/.exec(af)){return ad(Z,ag[1]);
}if(ag=/^>=(.*)$/.exec(af)){return ad(Y,ag[1]);
}if(ag=/^>(.*)$/.exec(af)){return ad(X,ag[1]);
}if(/[?*]/.exec(af)){var ah=ae[af];
if(!ah){ah=af.replace(/(~\?|~\*|[\]({\+\.\|\^\$\\})\[]|[?*])/g,function(ai){switch(ai){case"~?":return"\\?";
case"~*":return"\\*";
case"?":return".";
case"*":return".*";
default:return"\\"+ai;
}});
ah=ae[af]=new RegExp("^"+ah+"$","i");
}return ad(W,ah);
}return ad(W,af);
};
}();
function K(W){return typeof W=="number"||typeof W=="boolean"||W==null||W==="";
}function w(W,X){return W===X?0:W<X?-1:1;
}function E(W,X){return W===X?0:W<X?1:-1;
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/runtime.functions.2",["spreadsheet/runtime"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var a1=kendo.spreadsheet;
var u=a1.calc;
var aY=u.runtime;
var Q=aY.defineFunction;
var v=aY.CalcError;
var aK=aY.packDate;
var bb=aY.unpackDate;
var aw=aY.isLeapYear;
var M=aY.daysInMonth;
var c=aY._days_360;
Q("ERF",function(bf,bg){if(bg==null){return U(bf);
}return U(bg)-U(bf);
}).args([["lower_limit","number"],["upper_limit",["or","number","null"]]]);
Q("ERFC",V).args([["x","number"]]);
Q("GAMMALN",ao).args([["x","number++"]]);
Q("GAMMA",ak).args([["x","number"]]);
Q("GAMMA.DIST",al).args([["x","number+"],["alpha","number++"],["beta","number++"],["cumulative","logical"]]);
Q("GAMMA.INV",an).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"]]);
Q("NORM.S.DIST",aG).args([["z","number"],["cumulative","logical"]]);
Q("NORM.S.INV",aH).args([["p",["and","number",["[between]",0,1]]]]);
Q("NORM.DIST",aE).args([["x","number"],["mean","number"],["stddev","number++"],["cumulative","logical"]]);
Q("NORM.INV",aF).args([["p",["and","number",["[between]",0,1]]],["mean","number"],["stddev","number++"]]);
Q("BETADIST",p).args([["x","number"],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]);
Q("BETA.DIST",m).args([["x","number"],["alpha","number++"],["beta","number++"],["cumulative","logical"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]],["?",["assert","$x >= $A","NUM"]],["?",["assert","$x <= $B","NUM"]],["?",["assert","$A < $B","NUM"]]]);
Q("BETA.INV",n).args([["p",["and","number",["[between]",0,1]]],["alpha","number++"],["beta","number++"],["A",["or","number",["null",0]]],["B",["or","number",["null",1]]]]);
Q("CHISQ.DIST",w).args([["x","number+"],["deg_freedom","integer++"],["cumulative","logical"]]);
Q("CHISQ.DIST.RT",y).args([["x","number+"],["deg_freedom","integer++"]]);
Q("CHISQ.INV",x).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
Q("CHISQ.INV.RT",z).args([["p",["and","number",["[between]",0,1]]],["deg_freedom","integer++"]]);
Q("CHISQ.TEST",function(bf,bg){return A(bf.data,bg.data);
}).args([["actual_range","matrix"],["expected_range","matrix"],["?",["assert","$actual_range.width == $expected_range.width"]],["?",["assert","$actual_range.height == $expected_range.height"]]]);
Q("EXPON.DIST",W).args([["x","number+"],["lambda","number++"],["cumulative","logical"]]);
Q("POISSON.DIST",aO).args([["x","integer+"],["mean","number+"],["cumulative","logical"]]);
Q("F.DIST",Y).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"],["cumulative","logical"]]);
Q("F.DIST.RT",Z).args([["x","number+"],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
Q("F.INV",aa).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
Q("F.INV.RT",ab).args([["p",["and","number",["[between]",0,1]]],["deg_freedom1","integer++"],["deg_freedom2","integer++"]]);
Q("F.TEST",ag).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]);
Q("FISHER",ac).args([["x",["and","number",["(between)",-1,1]]]]);
Q("FISHERINV",ad).args([["y","number"]]);
Q("T.DIST",a4).args([["x","number"],["deg_freedom","integer++"],["cumulative","logical"]]);
Q("T.DIST.RT",a8).args([["x","number"],["deg_freedom","integer++"]]);
Q("T.DIST.2T",a5).args([["x","number+"],["deg_freedom","integer++"]]);
Q("T.INV",a7).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
Q("T.INV.2T",a6).args([["p",["and","number",["(between]",0,1]]],["deg_freedom","integer++"]]);
Q("T.TEST",a9).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["tails",["and","integer",["values",1,2]]],["type",["and","integer",["values",1,2,3]]],["?",["assert","$type != 1 || $array1.length == $array2.length","N/A"]],["?",["assert","$array1.length >= 2","DIV/0"]],["?",["assert","$array2.length >= 2","DIV/0"]]]);
Q("CONFIDENCE.T",C).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++",["assert","$size != 1","DIV/0"]]]]);
Q("CONFIDENCE.NORM",B).args([["alpha",["and","number",["(between)",0,1]]],["standard_dev","number++"],["size",["and","integer++"]]]);
Q("GAUSS",ap).args([["z","number"]]);
Q("PHI",aM).args([["x","number"]]);
Q("LOGNORM.DIST",aA).args([["x","number++"],["mean","number"],["standard_dev","number++"],["cumulative","logical"]]);
Q("LOGNORM.INV",aB).args([["probability",["and","number",["(between)",0,1]]],["mean","number"],["standard_dev","number++"]]);
Q("PROB",aS).args([["x_range",["collect","number",1]],["prob_range",["collect","number",1]],["lower_limit","number"],["upper_limit",["or","number",["null","$lower_limit"]]],["?",["assert","$prob_range.length == $x_range.length","N/A"]]]);
Q("SLOPE",a0).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
Q("INTERCEPT",ar).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
Q("PEARSON",aL).args([["array1",["collect","number",1]],["array2",["collect","number",1]],["?",["assert","$array2.length == $array1.length","N/A"]],["?",["assert","$array2.length > 0 && $array1.length > 0","N/A"]]]);
Q("RSQ",aX).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]],["?",["assert","$known_x.length != 1 && $known_y.length != 1","N/A"]]]);
Q("STEYX",a2).args([["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length >= 3 && $known_y.length >= 3","DIV/0"]]]);
Q("FORECAST",ae).args([["x","number"],["known_y",["collect","number",1]],["known_x",["collect","number",1]],["?",["assert","$known_x.length == $known_y.length","N/A"]],["?",["assert","$known_x.length > 0 && $known_y.length > 0","N/A"]]]);
Q("LINEST",ay).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]);
Q("LOGEST",az).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["const",["or","logical",["null",true]]],["stats",["or","logical",["null",false]]]]);
Q("TREND",ba).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]);
Q("GROWTH",aq).args([["known_y","matrix"],["known_x",["or","matrix","null"]],["new_x",["or","matrix","null"]],["const",["or","logical",["null",true]]]]);
Q("FV",ah).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["pv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$pmt || $pv"]]]);
Q("PV",aT).args([["rate","number"],["nper","number"],["pmt",["or","number",["null",0]]],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$pmt || $fv"]]]);
Q("PMT",aN).args([["rate","number"],["nper","number"],["pmt","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]);
Q("NPER",aI).args([["rate","number"],["pmt","number"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]]]);
Q("RATE",aU).args([["nper","number"],["pmt",["or","number",["null",0]]],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["guess",["or","number++",["null",0.01]]],["?",["assert","$pmt || $fv"]]]);
Q("IPMT",au).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]);
Q("PPMT",aP).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["fv",["or","number",["null",0]]],["type",["or",["values",0,1],["null",0]]],["?",["assert","$per >= 1 && $per <= $nper"]]]);
Q("CUMPRINC",L).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
Q("CUMIPMT",K).args([["rate","number++"],["nper","number++"],["pv","number++"],["start_period","number++"],["end_period","number++"],["type",["or",["values",0,1],["null",0]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
Q("NPV",aJ).args([["rate","number"],["values",["collect","number"]],["?",["assert","$values.length > 0","N/A"]]]);
Q("IRR",av).args([["values",["collect","number",1]],["guess",["or","number",["null",0.1]]]]);
Q("EFFECT",S).args([["nominal_rate","number++"],["npery","integer++"]]);
Q("NOMINAL",aD).args([["effect_rate","number++"],["npery","integer++"]]);
Q("XNPV",be).args([["rate","number"],["values",["collect","number",1]],["dates",["collect","date",1]],["?",["assert","$values.length == $dates.length","NUM"]]]);
Q("XIRR",bd).args([["values",["collect","number",1]],["dates",["collect","date",1]],["guess",["or","number",["null",0.1]]],["?",["assert","$values.length == $dates.length","NUM"]]]);
Q("ISPMT",ax).args([["rate","number"],["per","number++"],["nper","number++"],["pv","number"],["?",["assert","$per >= 1 && $per <= $nper"]]]);
Q("DB",O).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["month",["or","number",["null",12]]]]);
Q("DDB",P).args([["cost","number"],["salvage","number"],["life","number++"],["period","number++"],["factor",["or","number",["null",2]]]]);
Q("SLN",aZ).args([["cost","number"],["salvage","number"],["life","number++"]]);
Q("SYD",a3).args([["cost","number"],["salvage","number"],["life","number++"],["per","number++"]]);
Q("VDB",bc).args([["cost","number+"],["salvage","number+"],["life","number++"],["start_period","number+"],["end_period","number+"],["factor",["or","number+",["null",2]]],["no_switch",["or","logical",["null",false]]],["?",["assert","$end_period >= $start_period","NUM"]]]);
var J=[["settlement","date"],["maturity","date"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]];
Q("COUPDAYBS",D).args(J);
Q("COUPDAYS",E).args(J);
Q("COUPDAYSNC",F).args(J);
Q("COUPPCD",I).args(J);
Q("COUPNCD",G).args(J);
Q("COUPNUM",H).args(J);
Q("ACCRINTM",k).args([["issue","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1000],"number++"]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$issue < $settlement","NUM"]]]);
Q("ACCRINT",j).args([["issue","date"],["first_interest","date"],["settlement","date"],["rate","number++"],["par",["or",["null",1000],"number++"]],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["calc_method",["or","logical",["null",true]]],["?",["assert","$issue < $settlement","NUM"]]]);
Q("DISC",R).args([["settlement","date"],["maturity","date"],["pr","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("INTRATE",at).args([["settlement","date"],["maturity","date"],["investment","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("RECEIVED",aV).args([["settlement","date"],["maturity","date"],["investment","number++"],["discount","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("PRICE",aQ).args([["settlement","date"],["maturity","date"],["rate","number++"],["yld","number++"],["redemption","number++"],["frequency",["and","integer",["values",1,2,4]]],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
Q("PRICEDISC",aR).args([["settlement","date"],["maturity","date"],["discount","number++"],["redemption","number++"],["basis",["or",["null",0],["and","integer",["values",0,1,2,3,4]]]],["?",["assert","$settlement < $maturity","NUM"]]]);
var aC=300,T=2.2204e-16,af=1e-30,X=Math.abs;
function U(bj){if(X(bj)>=3.3){return 1-V(bj);
}var bi=bj>0?1:-1;
if(bi==-1){bj=-bj;
}var bg=0,bf=1;
for(var bh=1;
bh<100;
bh++){bg+=bf;
bf*=2*bj*bj/(2*bh+1);
}return bi*2/Math.sqrt(Math.PI)*bj*Math.exp(-bj*bj)*bg;
}function V(bi){if(X(bi)<3.3){return 1-U(bi);
}var bh=1;
if(bi<0){bh=-1;
bi=-bi;
}var bf=bi;
for(var bg=8;
bg>=1;
bg-=0.5){bf=bi+bg/bf;
}bf=1/(bi+bf);
return bh==1?Math.exp(-bi*bi)/Math.sqrt(Math.PI)*bf:2-Math.exp(-bi*bi)/Math.sqrt(Math.PI)*bf;
}function ao(bj){var bf=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,0.001208650973866179,-5.395239384953e-06];
var bk=bj,bi=bj+5.5,bh=bf[0];
bi-=(bj+0.5)*Math.log(bi);
for(var bg=1;
bg<=6;
bg++){bk+=1;
bh+=bf[bg]/bk;
}return -bi+Math.log(Math.sqrt(2*Math.PI)*bh/bj);
}function ak(bg){if(bg>0){return Math.exp(ao(bg));
}var bf=Math.PI,bh=-bg;
return -bf/(bh*ak(bh)*Math.sin(bf*bh));
}function q(bf,bg){return ao(bf)+ao(bg)-ao(bf+bg);
}function l(bf,bg){return Math.exp(q(bf,bg));
}function am(bf,bg){return bg<bf+1?aj(bf,bg):1-ai(bf,bg);
}function aj(bf,bl){var bk=1/bf,bh=bk,bg=bf;
var bi=ao(bf),bj;
for(bj=1;
bj<=aC;
bj++){bg++;
bh*=bl/bg;
bk+=bh;
if(X(bh)<X(bk)*T){break;
}}return bk*Math.exp(-bl+bf*Math.log(bl)-bi);
}function ai(bf,bp){var bm=af,bi=bm,bk=0,bg=1,bh=bp+1-bf;
var bn=ao(bf);
for(var bo=1;
bo<=aC;
bo++){bk=bh+bg*bk;
if(X(bk)<af){bk=af;
}bi=bh+bg/bi;
if(X(bi)<af){bi=af;
}bk=1/bk;
var bl=bi*bk;
bm*=bl;
if(X(bl-1)<T){break;
}bh+=2;
bg=-bo*(bo-bf);
}return bm*Math.exp(-bp-bn+bf*Math.log(bp));
}function al(bi,bf,bg,bh){if(!bh){return Math.pow(bi/bg,bf-1)*Math.exp(-bi/bg)/(bg*ak(bf));
}return am(bf,bi/bg);
}function an(bl,bf,bh){if(bl===0){return 0;
}if(bl==1){return Infinity;
}var bj=0,bk=10,bn=0,bg=bf*bh;
if(bg>1){bk*=bg;
}for(var bi=0;
bi<aC;
bi++){bn=0.5*(bj+bk);
var bm=al(bn,bf,bh,true);
if(X(bl-bm)<1e-16){break;
}if(bm>bl){bk=bn;
}else{bj=bn;
}}return bn;
}function aG(bg,bf){if(!bf){return Math.exp(-bg*bg/2)/Math.sqrt(2*Math.PI);
}return 0.5+0.5*U(bg/Math.sqrt(2));
}function aH(bj){var bf=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],bg=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],bh=[-0.007784894002430293,-0.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],bi=[0.007784695709041462,0.3224671290700398,2.445134137142996,3.754408661907416];
var bl=0.02425,bk=1-bl;
var bm,bn;
if(bj<bl){bm=Math.sqrt(-2*Math.log(bj));
return(((((bh[0]*bm+bh[1])*bm+bh[2])*bm+bh[3])*bm+bh[4])*bm+bh[5])/((((bi[0]*bm+bi[1])*bm+bi[2])*bm+bi[3])*bm+1);
}if(bk<bj){bm=Math.sqrt(-2*Math.log(1-bj));
return -(((((bh[0]*bm+bh[1])*bm+bh[2])*bm+bh[3])*bm+bh[4])*bm+bh[5])/((((bi[0]*bm+bi[1])*bm+bi[2])*bm+bi[3])*bm+1);
}bm=bj-0.5;
bn=bm*bm;
return(((((bf[0]*bn+bf[1])*bn+bf[2])*bn+bf[3])*bn+bf[4])*bn+bf[5])*bm/(((((bg[0]*bn+bg[1])*bn+bg[2])*bn+bg[3])*bn+bg[4])*bn+1);
}function aE(bi,bg,bh,bf){if(!bf){return Math.exp(-(bi-bg)*(bi-bg)/(2*bh*bh))/(bh*Math.sqrt(2*Math.PI));
}return aG((bi-bg)/bh,true);
}function aF(bg,bf,bh){return bf+bh*aH(bg);
}function t(bh,bf,bg){return Math.exp((bf-1)*Math.log(bh)+(bg-1)*Math.log(1-bh)-q(bf,bg));
}function r(bi,bf,bg){var bh=Math.exp(bf*Math.log(bi)+bg*Math.log(1-bi)-q(bf,bg));
return bi<(bf+1)/(bf+bg+2)?bh*o(bf,bg,bi)/bf:1-bh*o(bg,bf,1-bi)/bg;
}function o(bf,bh,br){var bm,bn;
var bg,bi,bj,bk,bl,bo,bp,bq;
bo=bf+bh;
bq=bf+1;
bp=bf-1;
bi=1;
bj=1-bo*br/bq;
if(X(bj)<af){bj=af;
}bj=1/bj;
bl=bj;
for(bm=1;
bm<=aC;
bm++){bn=2*bm;
bg=bm*(bh-bm)*br/((bp+bn)*(bf+bn));
bj=1+bg*bj;
if(X(bj)<af){bj=af;
}bi=1+bg/bi;
if(X(bi)<af){bi=af;
}bj=1/bj;
bl*=bj*bi;
bg=-(bf+bm)*(bo+bm)*br/((bf+bn)*(bq+bn));
bj=1+bg*bj;
if(X(bj)<af){bj=af;
}bi=1+bg/bi;
if(X(bi)<af){bi=af;
}bj=1/bj;
bk=bj*bi;
bl*=bk;
if(X(bk-1)<T){break;
}}return bl;
}function s(bk,bf,bg){var bi=0,bj=1,bm=0;
for(var bh=0;
bh<aC;
bh++){bm=0.5*(bi+bj);
var bl=r(bm,bf,bg);
if(X(bk-bl)<T){break;
}if(bl>bk){bj=bm;
}else{bi=bm;
}}return bm;
}function p(bj,bf,bg,bh,bi){return r((bj-bh)/(bi-bh),bf,bg);
}function m(bk,bf,bg,bh,bi,bj){if(bh){return r((bk-bi)/(bj-bi),bf,bg);
}return t((bk-bi)/(bj-bi),bf,bg)/(bj-bi);
}function n(bj,bf,bg,bh,bi){return bh+(bi-bh)*s(bj,bf,bg);
}function w(bh,bg,bf){return al(bh,bg/2,2,bf);
}function y(bg,bf){return 1-w(bg,bf,true);
}function x(bg,bf){return an(bg,bf/2,2);
}function z(bg,bf){return x(1-bg,bf);
}function A(bm,bi){var bn=bm.length,bf=bm[0].length;
var bo=0,bj,bk;
for(bj=0;
bj<bn;
bj++){for(bk=0;
bk<bf;
bk++){var bh=bi[bj][bk];
var bg=bm[bj][bk]-bh;
bg*=bg;
bo+=bg/bh;
}}var bl=(bn-1)*(bf-1);
return y(bo,bl);
}function W(bh,bg,bf){if(bf){return 1-Math.exp(-bg*bh);
}return bg*Math.exp(-bg*bh);
}function aO(bh,bj,bf){if(bf){return 1-w(2*bj,2*(bh+1),true);
}var bi=0;
for(var bg=2;
bg<=bh;
bg++){bi+=Math.log(bg);
}return Math.exp(bh*Math.log(bj)-bj-bi);
}function Y(bj,bh,bg,bf){if(bf){return r(bh*bj/(bg+bh*bj),bh/2,bg/2);
}var bi=bh/bg;
bh/=2;
bg/=2;
return bi/l(bh,bg)*Math.pow(bi*bj,bh-1)/Math.pow(1+bi*bj,bh+bg);
}function Z(bh,bg,bf){return 1-Y(bh,bg,bf,true);
}function ab(bh,bg,bf){return bf/bg*(1/n(bh,bf/2,bg/2,0,1)-1);
}function aa(bh,bg,bf){return bf/bg*(1/n(1-bh,bf/2,bg/2,0,1)-1);
}function h(bf){var bh=0,bi=bf.length;
for(var bg=0;
bg<bi;
bg++){bh+=bf[bg];
}return bh/bi;
}function i(bf,bi){var bk=0,bj=bf.length;
for(var bh=0;
bh<bj;
bh++){var bg=bf[bh]-bi;
bk+=bg*bg;
}return bk/(bj-1);
}function ag(bf,bg){var bh=bf.length-1,bi=bg.length-1;
var bj=i(bf,h(bf)),bk=i(bg,h(bg));
if(!bj||!bk){throw new v("DIV/0");
}return 2*Y(bj/bk,bh,bi,true);
}function ac(bf){return 0.5*Math.log((1+bf)/(1-bf));
}function ad(bg){var bf=Math.exp(2*bg);
return(bf-1)/(bf+1);
}function a4(bh,bg,bf){if(bf){return 1-0.5*r(bg/(bh*bh+bg),bg/2,0.5);
}return 1/(Math.sqrt(bg)*l(0.5,bg/2))*Math.pow(1+bh*bh/bg,-(bg+1)/2);
}function a8(bg,bf){return 1-a4(bg,bf,true);
}function a5(bg,bf){if(bg<0){bg=-bg;
}return 2*a8(bg,bf);
}function a7(bg,bf){var bh=s(2*Math.min(bg,1-bg),bf/2,0.5);
bh=Math.sqrt(bf*(1-bh)/bh);
return bg>0.5?bh:-bh;
}function a6(bg,bf){return a7(1-bg/2,bf);
}function a9(bj,bk,bu,bv){var bp=bj.length,bq=bk.length;
var bt,bi;
if(bv==1){var bf=0,bg=0;
for(var bl=0;
bl<bp;
bl++){var bh=bj[bl]-bk[bl];
bf+=bh;
bg+=bh*bh;
}var bo=bf/bp;
bt=bo/Math.sqrt((bg-bf*bo)/(bp*(bp-1)));
return bu==1?a8(bt,bp-1):a5(bt,bp-1);
}var bm=h(bj),bn=h(bk),bz=i(bj,bm),bA=i(bk,bn);
if(bv==3){var bx=bz/bp,by=bA/bq,bw=bx+by;
var br=bx/bw,bs=by/bw;
bi=1/(br*br/(bp-1)+bs*bs/(bq-1));
bt=X(bm-bn)/Math.sqrt(bw);
return bu==1?a8(bt,bi):a5(bt,bi);
}else{bi=bp+bq-2;
bt=X(bm-bn)*Math.sqrt(bi*bp*bq/((bp+bq)*((bp-1)*bz+(bq-1)*bA)));
return bu==1?a8(bt,bi):a5(bt,bi);
}}function C(bf,bh,bg){return -a7(bf/2,bg-1)*bh/Math.sqrt(bg);
}function B(bf,bh,bg){return -aH(bf/2)*bh/Math.sqrt(bg);
}function ap(bf){return aG(bf,true)-0.5;
}function aM(bf){return aG(bf);
}function aA(bj,bg,bh,bf){if(bf){return 0.5+0.5*U((Math.log(bj)-bg)/(bh*Math.sqrt(2)));
}var bi=Math.log(bj)-bg;
return Math.exp(-bi*bi/(2*bh*bh))/(bj*bh*Math.sqrt(2*Math.PI));
}function aB(bg,bf,bh){return Math.exp(aF(bg,bf,bh));
}function aS(bn,bi,bg,bl){var bh=bn.length;
var bk=0,bf;
for(bf=0;
bf<bh;
bf++){if(bi[bf]<=0||bi[bf]>1){throw new v("NUM");
}bk+=bi[bf];
}if(bk!=1){throw new v("NUM");
}var bj=0;
for(bf=0;
bf<bh;
bf++){var bm=bn[bf];
if(bm>=bg&&bm<=bl){bj+=bi[bf];
}}return bj;
}function a0(bn,bm){var bi=h(bm),bj=h(bn),bf=0,bg=0;
for(var bh=0,bk=bn.length;
bh<bk;
bh++){var bl=bm[bh]-bi;
bf+=bl*(bn[bh]-bj);
bg+=bl*bl;
}return bf/bg;
}function ar(bn,bm){var bi=h(bm),bj=h(bn);
var bf=0,bg=0;
for(var bh=0,bk=bn.length;
bh<bk;
bh++){var bl=bm[bh]-bi;
bf+=bl*(bn[bh]-bj);
bg+=bl*bl;
}return bj-bf*bi/bg;
}function aL(bo,bp){var bg=h(bo),bh=h(bp);
var bj=0,bk=0,bl=0;
for(var bf=0,bi=bo.length;
bf<bi;
bf++){var bm=bo[bf]-bg,bn=bp[bf]-bh;
bj+=bm*bn;
bk+=bm*bm;
bl+=bn*bn;
}return bj/Math.sqrt(bk*bl);
}function aX(bg,bh){var bf=aL(bg,bh);
return bf*bf;
}function a2(bp,bo){var bi=bo.length;
var bg=h(bo),bh=h(bp);
var bj=0,bk=0,bl=0;
for(var bf=0;
bf<bi;
bf++){var bm=bo[bf]-bg,bn=bp[bf]-bh;
bj+=bn*bn;
bk+=bm*bn;
bl+=bm*bm;
}return Math.sqrt((bj-bk*bk/bl)/(bi-2));
}function ae(bp,br,bq){var bi=h(bq),bj=h(br);
var bl=0,bm=0;
for(var bh=0,bk=bq.length;
bh<bk;
bh++){var bn=bq[bh]-bi,bo=br[bh]-bj;
bl+=bn*bo;
bm+=bn*bn;
}if(bm===0){throw new v("N/A");
}var bg=bl/bm,bf=bj-bg*bi;
return bf+bg*bp;
}function g(bg){var bh=bg.height,bi=0;
for(var bf=0;
bf<bh;
bf++){bi+=bg.data[bf][0];
}return bi/bh;
}function f(bg,bh){var bi=bg.height,bj=0;
for(var bf=0;
bf<bi;
bf++){var bk=bg.data[bf][0]-bh;
bj+=bk*bk;
}return bj;
}function ay(bz,bx,bk,bw){var bj=0;
if(!bx){bx=bz.map(function(){return ++bj;
});
}if(bk){bx=bx.clone();
bx.eachRow(function(bC){bx.data[bC].unshift(1);
});
++bx.width;
}var by=bx.transpose();
var bf=by.multiply(bx).inverse().multiply(by).multiply(bz);
var bl=[];
for(bj=bf.height-1;
bj>=0;
bj--){bl.push(bf.data[bj][0]);
}if(!bk){bl.push(0);
}if(!bw){return this.asMatrix([bl]);
}var bB=bx.multiply(bf);
var bA=bz.adds(bB,true);
var br=!bk?0:g(bB);
var bu=f(bB,br);
var bq=!bk?0:g(bA);
var bv=f(bA,bq);
var bp=[];
bp.push(bu,bv);
var bs=bu/(bu+bv);
var bg=bz.height-bx.width;
var bh=Math.sqrt(bv/bg);
var bn=[];
bn.push(bs,bh);
var bi=!bk?bs/bx.width/((1-bs)/bg):bu/(bx.width-1)/(bv/bg);
var bo=[];
bo.push(bi,bg);
var bt=by.multiply(bx).inverse();
var bm=[];
for(bj=bt.height-1;
bj>=0;
bj--){bm.push(Math.sqrt(bt.data[bj][bj]*bv/bg));
}return this.asMatrix([bl,bm,bn,bo,bp]);
}function az(bi,bh,bf,bg){return ay.call(this,bi.map(Math.log),bh,bf,bg).map(Math.exp);
}function ba(bl,bj,bi,bh){var bg=0;
if(!bj){bj=bl.map(function(){return ++bg;
});
}if(bh){bj=bj.clone();
bj.eachRow(function(bm){bj.data[bm].unshift(1);
});
++bj.width;
}var bk=bj.transpose();
var bf=bk.multiply(bj).inverse().multiply(bk).multiply(bl);
if(!bi){bi=bj;
}else{if(bh){bi=bi.clone();
bi.eachRow(function(bm){bi.data[bm].unshift(1);
});
++bi.width;
}}return bi.multiply(bf);
}function aq(bi,bh,bg,bf){return ba.call(this,bi.map(Math.log),bh,bg,bf).map(Math.exp);
}function aW(bl,bm,bo,bh){var bp=bo||20,bi=bh||1e-07;
var bq=bm;
for(var bn=1;
bn<=bp;
bn++){var bk=bl(bq),bj=bk[0],bf=bk[1];
var bg=bj/bf;
bq-=bg;
if(Math.abs(bg)<bi){return bq;
}}return new v("NUM");
}function ah(bk,bh,bi,bj,bl){var bf=Math.pow(1+bk,bh);
var bg=bk?(bf-1)/bk:bh;
return -(bj*bf+bi*bg*(1+bk*bl));
}function aT(bj,bh,bi,bf,bk){if(!bj){return -bf-bi*bh;
}var bg=Math.pow(1+bj,bh);
return -(bf+bi*(bg-1)/bj*(1+bj*bk))/bg;
}function aN(bj,bh,bi,bf,bk){if(!bj){return -(bf+bi)/bh;
}var bg=Math.pow(1+bj,bh);
return -bj*(bf+bi*bg)/((1+bj*bk)*(bg-1));
}function aI(bj,bh,bi,bf,bk){if(!bj){return -(bf+bi)/bh;
}var bg=bh*(1+bj*bk);
return Math.log((bg-bf*bj)/(bg+bi*bj))/Math.log(1+bj);
}function aU(bh,bi,bj,bf,bk,bg){function bl(bo){var bn=Math.pow(1+bo,bh-1),bm=bn*(1+bo);
return[bj*bm+bi*(1/bo+bk)*(bm-1)+bf,bh*bj*bn+bi*(-(bm-1)/(bo*bo)+(1/bo+bk)*bh*bn)];
}return aW(bl,bg);
}function au(bl,bi,bh,bk,bf,bm){if(bm==1&&bi==1){return 0;
}var bj=aN(bl,bh,bk,bf,bm);
var bg=ah(bl,bi-1,bj,bk,bm)*bl;
return bm?bg/(1+bl):bg;
}function aP(bk,bh,bg,bj,bf,bl){var bi=aN(bk,bg,bj,bf,bl);
return bi-au(bk,bh,bg,bj,bf,bl);
}function L(bj,bh,bi,bm,bf,bq){if(bq==1){bm--;
bf--;
}var bo=Math.pow(1+bj,bh),bp=Math.pow(1+bj,bm-1),bn=Math.pow(1+bj,bf);
var bg=bj*bi*bo/(bo-1);
var bl=bp*bi-(bp-1)/bj*bg;
var bk=bn*bi-(bn-1)/bj*bg;
return bk-bl;
}function K(bk,bi,bj,bl,bg,bm){var bf=0;
for(var bh=bl;
bh<=bg;
bh++){bf+=au(bk,bh,bi,bj,0,bm);
}return bf;
}function aJ(bj,bf){var bi=0;
for(var bg=0,bh=bf.length;
bg<bh;
bg++){bi+=bf[bg]*Math.pow(1+bj,-bg-1);
}return bi;
}function av(bf,bg){function bh(bm){var bk=0,bl=0;
for(var bi=0,bj=bf.length;
bi<bj;
bi++){bk+=bf[bi]*Math.pow(1+bm,-bi-1);
bl+=-bi*bf[bi]*Math.pow(1+bm,-bi-2);
}return[bk,bl];
}return aW(bh,bg);
}function S(bf,bg){return Math.pow(1+bf/bg,bg)-1;
}function aD(bf,bg){return bg*(Math.pow(bf+1,1/bg)-1);
}function be(bj,bk,bf){var bi=0;
for(var bg=0,bh=bk.length;
bg<bh;
bg++){bi+=bk[bg]*Math.pow(1+bj,(bf[0]-bf[bg])/365);
}return bi;
}function bd(bh,bf,bg){function bi(bo){var bm=bh[0],bn=0;
for(var bk=1,bl=bh.length;
bk<bl;
bk++){var bj=(bf[0]-bf[bk])/365;
bm+=bh[bk]*Math.pow(1+bo,bj);
bn+=bj*bh[bk]*Math.pow(1+bo,bj-1);
}return[bm,bn];
}return aW(bi,bg);
}function ax(bi,bg,bf,bh){var bj=-bh*bi;
return bj*(1-bg/bf);
}function O(bf,bm,bi,bk,bj){var bl=1-Math.pow(bm/bf,1/bi);
bl=Math.floor(bl*1000+0.5)/1000;
var bg=bf*bl*bj/12;
if(bk==1){return bg;
}for(var bh=1;
bh<bi;
bh++){if(bh==bk-1){return(bf-bg)*bl;
}bg+=(bf-bg)*bl;
}return(bf-bg)*bl*(12-bj)/12;
}function P(bf,bm,bj,bk,bi){var bh=bi/bj;
var bl=-bf*(Math.pow(1-bh,bk-1)-1);
var bg=(bf-bl)*bh;
bg=Math.min(bg,Math.max(0,bf-bl-bm));
return bg;
}function aZ(bf,bh,bg){return(bf-bh)/bg;
}function a3(bf,bi,bg,bh){return(bf-bi)*(bg-bh+1)*2/(bg*(bg+1));
}function bc(bh,bs,bo,bt,bi,bj,bq){var bm=bj>=bo?1:bj/bo;
function bf(bA,bz){var bw,by,bx;
if(bm==1){by=bz==1?bA:0;
}else{by=bA*Math.pow(1-bm,bz-1);
}bx=bA*Math.pow(1-bm,bz);
bw=bx<bs?by-bs:by-bx;
return bw<0?0:bw;
}function bg(bw,bB,bD){var bE=bw-bs;
var bz=Math.ceil(bD);
var bF,bA=0,bG=0,bC=false;
for(var by=1;
by<=bz;
by++){if(!bC){var bx=bf(bw,by);
bA=bE/(bB-by+1);
if(bA>bx){bF=bA;
bC=true;
}else{bF=bx;
bE-=bx;
}}else{bF=bA;
}if(by==bz){bF*=bD+1-bz;
}bG+=bF;
}return bG;
}var bn=Math.floor(bt),bl=Math.ceil(bi);
var bv=0;
if(bq){for(var bk=bn+1;
bk<=bl;
bk++){var bu=bf(bh,bk);
if(bk==bn+1){bu*=Math.min(bi,bn+1)-bt;
}else{if(bk==bl){bu*=bi+1-bl;
}}bv+=bu;
}}else{var bp=bo;
if(bt!=Math.floor(bt)){if(bj>1){if(bt>=bo/2){var br=bt-bo/2;
bt=bo/2;
bi-=br;
bp+=1;
}}}bh-=bg(bh,bp,bt);
bv=bg(bh,bo-bt,bi-bt);
}return bv;
}function e(bf,bi){var bg=bb(bf);
var bh=bg.month+bi;
var bj=bg.year+Math.floor(bh/12);
bh%=12;
if(bh<0){bh+=12;
}bg=Math.min(bg.date,M(bj,bh));
return aK(bj,bh,bg);
}function d(bg,bh,bf){if(bf==1||bf==2||bf==3){return bh-bg;
}return c(bg,bh,bf);
}function a(bn,bh,bg){var bm=bb(bn),bf=bb(bh);
var bk=bf.year-bm.year;
if(bk>0){bk=(bk-1)*bg;
}var bl,bj,bi=12/bg;
do{bk++;
bl=e(bh,-bk*bi);
}while(bn<bl);
bk--;
bj=e(bh,-bk*bi);
return[bl,bj];
}function b(bg,bn,bh){var bm=bb(bn),bf=bb(bg);
var bk=bm.year-bf.year;
if(bk>0){bk=(bk-1)*bh;
}var bl=bg,bj,bi=12/bh;
while(bn>bl){bj=bl;
bk++;
bl=e(bg,bk*bi);
}return[bj,bl];
}function D(bj,bh,bg,bf){var bi=a(bj,bh,bg)[0];
return d(bi,bj,bf);
}function E(bj,bi,bh,bf){if(bf==1){var bg=a(bj,bi,bh);
return d(bg[0],bg[1],1);
}if(bf==3){return 365/bh;
}return 360/bh;
}function F(bj,bh,bg,bf){var bi=a(bj,bh,bg)[1];
return d(bj,bi,bf);
}function I(bh,bg,bf){return a(bh,bg,bf)[0];
}function G(bh,bg,bf){return a(bh,bg,bf)[1];
}function H(bk,bh,bf){var bj=bb(bk),bg=bb(bh);
var bi=12*(bg.year-bj.year)+bg.month-bj.month;
return 1+(bi*bf/12|0);
}function N(bg,bf){if(bf==3){return 365;
}if(bf==1){return aw(bg)?366:365;
}return 360;
}function k(bg,bh,bj,bi,bf){var bk=N(bb(bh).year,bf);
return bj*bi*d(bg,bh,bf)/bk;
}function j(bo,bm,bw,bv,bs,bn,bi,bk){var bg=0,bl=bs*bv/bn;
var bj,bt,bp,bu,bq,br;
var bh=bi%2===0?360:365;
function bf(bx,by){return(by-bx)*bn/bh|0;
}if(bw<=bm){bj=a(bw,bm,bn);
bt=bj[0];
bp=bj[1];
if(bt<=bo){return bl*d(bo,bw,bi)/d(bt,bp,bi);
}bj=a(bo,bt,bn);
bu=bj[0];
bq=bj[1];
br=bf(bq,bw);
return bl*(br+d(bo,bq,bi)/d(bu,bq,bi)+(bw<bp?d(bt,bw,bi)/d(bt,bp,bi):0));
}else{bj=b(bm,bw,bn);
bt=bj[0];
bp=bj[1];
br=bf(bm,bw);
if(bp==bw){bg=bl*br;
}else{bg=bl*(br+d(bt,bw,bi)/d(bt,bp,bi));
}if(!bk){return bg;
}bj=a(bo,bm,bn);
bt=bj[0];
bp=bj[1];
br=bf(bo,bm);
bg+=bl*(br+d(bo,bp,bi)/d(bt,bp,bi));
return bg;
}}function R(bk,bh,bi,bj,bg){var bf=bg%2===0?360:aw(bb(bk).year)?366:365;
return(bj-bi)/bj*bf/d(bk,bh,bg);
}function at(bk,bi,bh,bj,bg){var bf=bg%2===0?360:aw(bb(bk).year)?366:365;
return(bj-bh)/bh*bf/d(bk,bi,bg);
}function aV(bk,bj,bi,bh,bg){var bf=bg%2===0?360:aw(bb(bk).year)?366:365;
return bi/(1-bh*d(bk,bj,bg)/bf);
}function aQ(bs,bm,bq,bv,br,bl,bf){var bn=1+((bm-bs)*bl/(bf%2===0?360:365)|0);
var bi=a(bs,bm,bl),bp=bi[0],bo=bi[1];
var bh=d(bp,bs,bf),bt=d(bs,bo,bf),bg=d(bp,bo,bf);
var bj=100*bq/bl,bu=bv/bl,bk=bt/bg;
if(bn==1){return(br+bj)/(1+bk*bu)-bh/bg*bj;
}return br/Math.pow(1+bu,bn-1+bk)+bj*Math.pow(1+bu,1-bn-bk)*(Math.pow(1+bu,bn)-1)/bu-bh/bg*bj;
}function aR(bl,bj,bg,bk,bf){var bh=d(bl,bj,bf),bi=N(bb(bj).year,bf);
return bk-bg*bk*bh/bi;
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/borderpalette",["kendo.core","kendo.colorpicker","kendo.popup"],b);
}(function(){(function(f){if(f.support.browser.msie&&f.support.browser.version<9){return;
}var a=f.jQuery;
var c=["allBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","outsideBorders","leftBorder","topBorder","rightBorder","bottomBorder","noBorders"];
var b=f.spreadsheet.messages.borderPalette={allBorders:"All borders",insideBorders:"Inside borders",insideHorizontalBorders:"Inside horizontal borders",insideVerticalBorders:"Inside vertical borders",outsideBorders:"Outside borders",leftBorder:"Left border",topBorder:"Top border",rightBorder:"Right border",bottomBorder:"Bottom border",noBorders:"No border",reset:"Reset color",customColor:"Custom color...",apply:"Apply",cancel:"Cancel"};
function g(h){return function(i){i.preventDefault();
return h.apply(this,arguments);
};
}var e=f.ui.Widget.extend({init:function(h,i){f.ui.Widget.call(this,h,i);
this.element=h;
this.color=i.color;
this._resetButton();
this._colorPalette();
this._customColorPalette();
this._customColorButton();
this.resetButton.on("click",g(this.resetColor.bind(this)));
this.customColorButton.on("click",g(this.customColor.bind(this)));
},options:{name:"ColorChooser"},events:["change"],destroy:function(){f.unbind(this.dialog.element.find(".k-action-buttons"));
this.dialog.destroy();
this.colorPalette.destroy();
this.resetButton.off("click");
this.customColorButton.off("click");
},value:function(h){if(h!==undefined){this.color=h;
this.customColorButton.find(".k-icon").css("background-color",this.color);
this.colorPalette.value(null);
this.flatColorPicker.value(this.color);
}else{return this.color;
}},_change:function(h){this.color=h;
this.trigger("change",{value:h});
},_colorPalette:function(){var i=a("<div />",{"class":"k-spreadsheet-color-palette"});
var h=this.colorPalette=a("<div />").kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],value:this.color,change:function(j){this.customColorButton.find(".k-icon").css("background-color","transparent");
this.flatColorPicker.value(null);
this._change(j.value);
}.bind(this)}).data("kendoColorPalette");
i.append(h.wrapper).appendTo(this.element);
},_customColorPalette:function(){var i=a("<div />",{"class":"k-spreadsheet-window",html:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>"+b.apply+"</button><button class='k-button' data-bind='click: close'>"+b.cancel+"</button></div>"});
var h=this.dialog=i.appendTo(document.body).kendoWindow({animation:false,scrollable:false,resizable:false,maximizable:false,modal:true,visible:false,width:268,open:function(){this.center();
}}).data("kendoWindow");
h.one("activate",function(){this.element.find("[data-role=flatcolorpicker]").data("kendoFlatColorPicker")._hueSlider.resize();
});
var j=this.flatColorPicker=h.element.children().first().kendoFlatColorPicker().data("kendoFlatColorPicker");
var k=f.observable({apply:function(){this.customColorButton.find(".k-icon").css("background-color",j.value());
this.colorPalette.value(null);
this._change(j.value());
h.close();
}.bind(this),close:function(){j.value(null);
h.close();
}});
f.bind(h.element.find(".k-action-buttons"),k);
},_resetButton:function(){this.resetButton=a("<a class='k-button k-reset-color' href='#'><span class='k-icon k-font-icon k-i-reset-color'></span>"+b.reset+"</a>").appendTo(this.element);
},_customColorButton:function(){this.customColorButton=a("<a class='k-button k-custom-color' href='#'><span class='k-icon'></span>"+b.customColor+"</a>").appendTo(this.element);
},resetColor:function(){this.colorPalette.value(null);
this.flatColorPicker.value(null);
this._change(null);
},customColor:function(){this.dialog.open();
}});
var d=f.ui.Widget.extend({init:function(h,i){f.ui.Widget.call(this,h,i);
this.element=h;
this.color="#000";
this.element.addClass("k-spreadsheet-border-palette");
this._borderTypePalette();
this._borderColorPalette();
this.element.on("click",".k-spreadsheet-border-type-palette .k-button",g(this._click.bind(this)));
},options:{name:"BorderPalette"},events:["change"],destroy:function(){this.colorChooser.destroy();
this.element.off("click");
},_borderTypePalette:function(){var j=b;
var h=c.map(function(k){return'<a title="'+j[k]+'" href="#" data-border-type="'+k+'" class="k-button k-button-icon"><span class="k-sprite k-font-icon k-icon k-i-'+f.toHyphens(k)+'"></span></a>';
}).join("");
var i=a("<div />",{"class":"k-spreadsheet-border-type-palette",html:h});
i.appendTo(this.element);
},_borderColorPalette:function(){var h=a("<div />",{"class":"k-spreadsheet-border-color-palette"});
h.appendTo(this.element);
this.colorChooser=new e(h,{color:this.color,change:this._colorChange.bind(this)});
},_click:function(h){this.type=a(h.currentTarget).data("borderType");
this.trigger("change",{type:this.type,color:this.color});
},_colorChange:function(h){this.color=h.value;
if(this.type){this.trigger("change",{type:this.type,color:this.color});
}}});
f.spreadsheet.ColorChooser=e;
f.spreadsheet.BorderPalette=d;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/toolbar",["kendo.toolbar","kendo.colorpicker","kendo.combobox","kendo.dropdownlist","kendo.popup","spreadsheet/borderpalette"],b);
}(function(){(function(y){if(y.support.browser.msie&&y.support.browser.version<9){return;
}var a=y.jQuery;
var I=y.ui.ToolBar;
var B=y.spreadsheet.messages.toolbar={addColumnLeft:"Add column left",addColumnRight:"Add column right",addRowAbove:"Add row above",addRowBelow:"Add row below",alignment:"Alignment",alignmentButtons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"},backgroundColor:"Background",bold:"Bold",borders:"Borders",colorPicker:{reset:"Reset color",customColor:"Custom color..."},copy:"Copy",cut:"Cut",deleteColumn:"Delete column",deleteRow:"Delete row",filter:"Filter",fontFamily:"Font",fontSize:"Font size",format:"Custom format...",formatTypes:{automatic:"Automatic",number:"Number",percent:"Percent",financial:"Financial",currency:"Currency",date:"Date",time:"Time",dateTime:"Date time",duration:"Duration",moreFormats:"More formats..."},formatDecreaseDecimal:"Decrease decimal",formatIncreaseDecimal:"Increase decimal",freeze:"Freeze panes",freezeButtons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"},italic:"Italic",merge:"Merge cells",mergeButtons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"},open:"Open...",paste:"Paste",quickAccess:{redo:"Redo",undo:"Undo"},exportAs:"Export...",toggleGridlines:"Toggle gridlines",sortAsc:"Sort ascending",sortDesc:"Sort descending",sortButtons:{sortSheetAsc:"Sort sheet A to Z",sortSheetDesc:"Sort sheet Z to A",sortRangeAsc:"Sort range A to Z",sortRangeDesc:"Sort range Z to A"},textColor:"Text Color",textWrap:"Wrap text",underline:"Underline",validation:"Data validation...",hyperlink:"Link"};
var k={home:["open","exportAs",["cut","copy","paste"],["bold","italic","underline"],"hyperlink","backgroundColor","textColor","borders","fontSize","fontFamily","alignment","textWrap",["formatDecreaseDecimal","formatIncreaseDecimal"],"format","merge","freeze","filter","toggleGridlines"],insert:[["addColumnLeft","addColumnRight","addRowBelow","addRowAbove"],["deleteColumn","deleteRow"]],data:["sort","filter","validation"]};
var J={open:{type:"open",overflow:"never",iconClass:"xlsa"},exportAs:{type:"exportAsDialog",dialogName:"exportAs",overflow:"never",text:"",iconClass:"xlsa"},bold:{type:"button",command:"PropertyChangeCommand",property:"bold",value:true,iconClass:"bold",togglable:true},italic:{type:"button",command:"PropertyChangeCommand",property:"italic",value:true,iconClass:"italic",togglable:true},underline:{type:"button",command:"PropertyChangeCommand",property:"underline",value:true,iconClass:"underline",togglable:true},formatDecreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:-1,iconClass:"decrease-decimal"},formatIncreaseDecimal:{type:"button",command:"AdjustDecimalsCommand",value:+1,iconClass:"increase-decimal"},textWrap:{type:"button",command:"TextWrapCommand",property:"wrap",value:true,iconClass:"text-wrap",togglable:true},cut:{type:"button",command:"ToolbarCutCommand",iconClass:"cut"},copy:{type:"button",command:"ToolbarCopyCommand",iconClass:"copy"},paste:{type:"button",command:"ToolbarPasteCommand",iconClass:"paste"},separator:{type:"separator"},alignment:{type:"alignment",iconClass:"justify-left"},backgroundColor:{type:"colorPicker",property:"background",iconClass:"background"},textColor:{type:"colorPicker",property:"color",iconClass:"text"},fontFamily:{type:"fontFamily",property:"fontFamily",iconClass:"text"},fontSize:{type:"fontSize",property:"fontSize",iconClass:"font-size"},format:{type:"format",property:"format",iconClass:"format-number"},filter:{type:"filter",property:"hasFilter",iconClass:"filter"},merge:{type:"merge",iconClass:"merge-cells"},freeze:{type:"freeze",iconClass:"freeze-panes"},borders:{type:"borders",iconClass:"all-borders"},formatCells:{type:"dialog",dialogName:"formatCells",overflow:"never"},hyperlink:{type:"dialog",dialogName:"hyperlink",iconClass:"hyperlink",overflow:"never",text:""},toggleGridlines:{type:"button",command:"GridLinesChangeCommand",property:"gridLines",value:true,iconClass:"no-borders",togglable:true},addColumnLeft:{type:"button",command:"AddColumnCommand",value:"left",iconClass:"add-column-left"},addColumnRight:{type:"button",command:"AddColumnCommand",value:"right",iconClass:"add-column-right"},addRowBelow:{type:"button",command:"AddRowCommand",value:"below",iconClass:"add-row-below"},addRowAbove:{type:"button",command:"AddRowCommand",value:"above",iconClass:"add-row-above"},deleteColumn:{type:"button",command:"DeleteColumnCommand",iconClass:"delete-column"},deleteRow:{type:"button",command:"DeleteRowCommand",iconClass:"delete-row"},sort:{type:"sort",iconClass:"sort-desc"},validation:{type:"dialog",dialogName:"validation",iconClass:"exception",overflow:"never"}};
var H=I.extend({init:function(K,M){M.items=this._expandTools(M.tools||H.prototype.options.tools[M.toolbarName]);
I.fn.init.call(this,K,M);
var L=this._click.bind(this);
this.element.addClass("k-spreadsheet-toolbar");
this._addSeparators(this.element);
this.bind({click:L,toggle:L});
},_addSeparators:function(K){var L=K.children(".k-widget, a.k-button, .k-button-group");
L.before("<span class='k-separator' />");
},_expandTools:function(L){function K(P){var M=a.isPlainObject(P)?P:J[P]||{};
var N="k-icon k-font-icon k-i-"+M.iconClass;
var Q=M.type;
var R={splitButton:{spriteCssClass:N},button:{showText:"overflow"},colorPicker:{toolIcon:N}};
var O=a.extend({name:M.name||P,text:B[M.name||P],spriteCssClass:N,attributes:{title:B[M.name||P]}},R[Q],M);
if(Q=="splitButton"){O.menuButtons=O.menuButtons.map(K);
}O.attributes["data-tool"]=P;
if(M.property){O.attributes["data-property"]=M.property;
}return O;
}return L.reduce(function(N,M){if(a.isArray(M)){N.push({type:"buttonGroup",buttons:M.map(K)});
}else{N.push(K.call(this,M));
}return N;
},[]);
},_click:function(M){var O=M.target.attr("data-tool");
var N=J[O]||{};
var L=N.command;
if(!L){return;
}var K={command:L,options:{property:N.property||null,value:N.value||null}};
if(typeof K.options.value==="boolean"){K.options.value=M.checked?true:null;
}this.action(K);
},events:["click","toggle","open","close","overflowOpen","overflowClose","action","dialog"],options:{name:"SpreadsheetToolBar",resizable:true,tools:k},action:function(K){this.trigger("action",K);
},dialog:function(K){this.trigger("dialog",K);
},refresh:function(K){var N=K;
var Q=this._tools();
function O(W,Y){var X=W.toolbar;
var T=W.overflow;
var U=X&&X.options.togglable||T&&T.options.togglable;
if(!U){return;
}var V=false;
if(typeof Y==="boolean"){V=Y;
}else{if(typeof Y==="string"){V=X.options.value===Y;
}}X.toggle(V);
if(T){T.toggle(V);
}}function R(U,W){var V=U.toolbar;
var T=U.overflow;
if(V&&V.update){V.update(W);
}if(T&&T.update){T.update(W);
}}for(var L=0;
L<Q.length;
L++){var M=Q[L].property;
var P=Q[L].tool;
var S=y.isFunction(N[M])?N[M]():N;
if(M=="gridLines"){S=N.sheet().showGridLines();
}if(P.type==="button"){O(P,S);
}else{R(P,S);
}}},_tools:function(){return this.element.find("[data-property]").toArray().map(function(K){K=a(K);
return{property:K.attr("data-property"),tool:this._getItem(K)};
}.bind(this));
},destroy:function(){this.element.find("[data-command],.k-button").each(function(){var K=a(this);
var L=K.data("instance");
if(L&&L.destroy){L.destroy();
}});
I.fn.destroy.call(this);
}});
y.spreadsheet.ToolBar=H;
var l=y.toolbar.Item.extend({init:function(L,M){var K=a("<select />").kendoDropDownList({height:"auto"}).data("kendoDropDownList");
this.dropDownList=K;
this.element=K.wrapper;
this.options=L;
this.toolbar=M;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
K.bind("open",this._open.bind(this));
K.bind("change",this._change.bind(this));
this.element.width(L.width).attr({"data-command":"PropertyChangeCommand","data-property":L.property});
},_open:function(){var K=this.dropDownList;
var L=K.list;
var M;
L.css({whiteSpace:"nowrap",width:"auto"});
M=L.width();
if(M){M+=20;
}else{M=K._listWidth;
}L.css("width",M+y.support.scrollbar());
K._listWidth=M;
},_change:function(L){var M=L.sender;
var O=M.value();
var K=M.dataItem();
var N=K?K.popup:undefined;
if(N){this.toolbar.dialog({name:N});
}else{this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:O=="null"?null:O}});
}},value:function(K){if(K!==undefined){this.dropDownList.value(K);
}else{return this.dropDownList.value();
}}});
var E=y.toolbar.Item.extend({init:function(K,L){this.element=a("<a href='#' class='k-button k-button-icon'><span class='"+K.spriteCssClass+"'></span><span class='k-icon k-i-arrow-s'></span></a>");
this.element.on("click",this.open.bind(this)).attr("data-command",K.command);
this.options=K;
this.toolbar=L;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this._popup();
},destroy:function(){this.popup.destroy();
},open:function(K){K.preventDefault();
this.popup.toggle();
},_popup:function(){var K=this.element;
this.popup=a("<div class='k-spreadsheet-popup' />").appendTo(K).kendoPopup({anchor:K}).data("kendoPopup");
}});
y.toolbar.registerComponent("dialog",y.toolbar.ToolBarButton.extend({init:function(K,L){y.toolbar.ToolBarButton.fn.init.call(this,K,L);
this._dialogName=K.dialogName;
this.element.bind("click",this.open.bind(this)).data("instance",this);
},open:function(){this.toolbar.dialog({name:this._dialogName});
}}));
y.toolbar.registerComponent("exportAsDialog",y.toolbar.Item.extend({init:function(K,L){this._dialogName=K.dialogName;
this.toolbar=L;
this.element=a("<button class='k-button k-button-icon' title='"+K.attributes.title+"'><span class='k-icon k-font-icon k-i-xls' /></button>").data("instance",this);
this.element.bind("click",this.open.bind(this)).data("instance",this);
},open:function(){this.toolbar.dialog({name:this._dialogName});
}}));
var D=y.toolbar.OverflowButton.extend({init:function(L,M){y.toolbar.OverflowButton.fn.init.call(this,L,M);
this.element.on("click",this._click.bind(this));
this.message=this.options.text;
var K=this.element.data("button");
this.element.data(this.options.type,K);
},_click:a.noop});
var f=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this.popup.element.addClass("k-spreadsheet-colorpicker");
this.colorChooser=new y.spreadsheet.ColorChooser(this.popup.element,{change:this._colorChange.bind(this)});
this.element.attr({"data-property":K.property});
this.element.data({type:"colorPicker",colorPicker:this,instance:this});
},destroy:function(){this.colorChooser.destroy();
E.fn.destroy.call(this);
},update:function(K){this.value(K);
},value:function(K){this.colorChooser.value(K);
},_colorChange:function(K){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:K.sender.value()}});
this.popup.close();
}});
var g=D.extend({init:function(K,L){K.iconName="text";
D.fn.init.call(this,K,L);
},_click:function(){this.toolbar.dialog({name:"colorPicker",options:{title:this.options.property,property:this.options.property}});
}});
y.toolbar.registerComponent("colorPicker",f,g);
var p=[8,9,10,11,12,13,14,16,18,20,22,24,26,28,36,48,72];
var i=12;
var s=y.toolbar.Item.extend({init:function(L,M){var K=a("<input />").kendoComboBox({change:this._valueChange.bind(this),clearButton:false,dataSource:L.fontSizes||p,value:i}).data("kendoComboBox");
this.comboBox=K;
this.element=K.wrapper;
this.options=L;
this.toolbar=M;
this.attributes();
this.addUidAttr();
this.addOverflowAttr();
this.element.width(L.width).attr({"data-command":"PropertyChangeCommand","data-property":L.property});
this.element.data({type:"fontSize",fontSize:this});
},_valueChange:function(K){this.toolbar.action({command:"PropertyChangeCommand",options:{property:this.options.property,value:y.parseInt(K.sender.value())}});
},update:function(K){this.value(y.parseInt(K)||i);
},value:function(K){if(K!==undefined){this.comboBox.value(K);
}else{return this.comboBox.value();
}}});
var t=D.extend({_click:function(){this.toolbar.dialog({name:"fontSize",options:{sizes:p,defaultSize:i}});
},update:function(K){this._value=K||i;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
y.toolbar.registerComponent("fontSize",s,t);
var o=["Arial","Courier New","Georgia","Times New Roman","Trebuchet MS","Verdana"];
var h="Arial";
var q=l.extend({init:function(L,M){l.fn.init.call(this,L,M);
var K=this.dropDownList;
K.setDataSource(L.fontFamilies||o);
K.value(h);
this.element.data({type:"fontFamily",fontFamily:this});
},update:function(K){this.value(K||h);
}});
var r=D.extend({_click:function(){this.toolbar.dialog({name:"fontFamily",options:{fonts:o,defaultFont:h}});
},update:function(K){this._value=K||h;
this.element.find(".k-text").text(this.message+" ("+this._value+") ...");
}});
y.toolbar.registerComponent("fontFamily",q,r);
var j=y.spreadsheet.formats={automatic:null,number:"#,0.00",percent:"0.00%",financial:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',currency:"$#,##0.00;[Red]$#,##0.00",date:"m/d/yyyy",time:"h:mm:ss AM/PM",dateTime:"m/d/yyyy h:mm",duration:"[h]:mm:ss"};
var u=l.extend({_revertTitle:function(K){K.sender.value("");
K.sender.wrapper.width("auto");
},init:function(M,N){l.fn.init.call(this,M,N);
var K=this.dropDownList;
var L="<span class='k-icon k-font-icon k-i-"+M.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>";
K.bind("change",this._revertTitle.bind(this));
K.bind("dataBound",this._revertTitle.bind(this));
K.setOptions({dataValueField:"format",dataTextField:"name",dataValuePrimitive:true,valueTemplate:L,template:"# if (data.sample) { #<span class='k-spreadsheet-sample'>#: data.sample #</span># } ##: data.name #"});
K.text(L);
K.setDataSource([{format:j.automatic,name:B.formatTypes.automatic},{format:j.number,name:B.formatTypes.number,sample:"1,499.99"},{format:j.percent,name:B.formatTypes.percent,sample:"14.50%"},{format:j.financial,name:B.formatTypes.financial,sample:"(1,000.12)"},{format:j.currency,name:B.formatTypes.currency,sample:"$1,499.99"},{format:j.date,name:B.formatTypes.date,sample:"4/21/2012"},{format:j.time,name:B.formatTypes.time,sample:"5:49:00 PM"},{format:j.dateTime,name:B.formatTypes.dateTime,sample:"4/21/2012 5:49:00"},{format:j.duration,name:B.formatTypes.duration,sample:"168:05:00"},{popup:"formatCells",name:B.formatTypes.moreFormats}]);
this.element.data({type:"format",format:this});
}});
var v=D.extend({_click:function(){this.toolbar.dialog({name:"formatCells"});
}});
y.toolbar.registerComponent("format",u,v);
var e=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this._borderPalette();
this.element.data({type:"borders",instance:this});
},destroy:function(){this.borderPalette.destroy();
E.fn.destroy.call(this);
},_borderPalette:function(){var K=a("<div />").appendTo(this.popup.element);
this.borderPalette=new y.spreadsheet.BorderPalette(K,{change:this._action.bind(this)});
},_action:function(K){this.toolbar.action({command:"BorderChangeCommand",options:{border:K.type,style:{size:1,color:K.color}}});
}});
var d=D.extend({_click:function(){this.toolbar.dialog({name:"borders"});
}});
y.toolbar.registerComponent("borders",e,d);
var c=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this.element.attr({"data-property":"alignment"});
this._commandPalette();
this.popup.element.on("click",".k-button",function(M){this._action(a(M.currentTarget));
}.bind(this));
this.element.data({type:"alignment",alignment:this,instance:this});
},buttons:[{property:"textAlign",value:"left",iconClass:"justify-left",text:B.alignmentButtons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"justify-center",text:B.alignmentButtons.justifyCenter},{property:"textAlign",value:"right",iconClass:"justify-right",text:B.alignmentButtons.justifyRight},{property:"textAlign",value:"justify",iconClass:"justify-full",text:B.alignmentButtons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:B.alignmentButtons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:B.alignmentButtons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:B.alignmentButtons.alignBottom}],destroy:function(){this.popup.element.off();
E.fn.destroy.call(this);
},update:function(L){var M=L.textAlign();
var N=L.verticalAlign();
var K=this.popup.element;
K.find(".k-button").removeClass("k-state-active");
if(M){K.find("[data-property=textAlign][data-value="+M+"]").addClass("k-state-active");
}if(N){K.find("[data-property=verticalAlign][data-value="+N+"]").addClass("k-state-active");
}},_commandPalette:function(){var K=this.buttons;
var L=a("<div />").appendTo(this.popup.element);
K.forEach(function(O,N){var M="<a title='"+O.text+"' data-property='"+O.property+"' data-value='"+O.value+"' class='k-button k-button-icon'><span class='k-icon k-font-icon k-i-"+O.iconClass+"'></span></a>";
if(N!==0&&K[N-1].property!==O.property){L.append(a("<span class='k-separator' />"));
}L.append(M);
});
},_action:function(K){var L=K.attr("data-property");
var M=K.attr("data-value");
this.toolbar.action({command:"PropertyChangeCommand",options:{property:L,value:M}});
}});
var b=D.extend({_click:function(){this.toolbar.dialog({name:"alignment"});
}});
y.toolbar.registerComponent("alignment",c,b);
var A=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this._commandPalette();
this.popup.element.on("click",".k-button",function(M){this._action(a(M.currentTarget));
}.bind(this));
this.element.data({type:"merge",merge:this,instance:this});
},buttons:[{value:"cells",iconClass:"merge-cells",text:B.mergeButtons.mergeCells},{value:"horizontally",iconClass:"merge-horizontally",text:B.mergeButtons.mergeHorizontally},{value:"vertically",iconClass:"merge-vertically",text:B.mergeButtons.mergeVertically},{value:"unmerge",iconClass:"normal-layout",text:B.mergeButtons.unmerge}],destroy:function(){this.popup.element.off();
E.fn.destroy.call(this);
},_commandPalette:function(){var K=a("<div />").appendTo(this.popup.element);
this.buttons.forEach(function(M){var L="<a title='"+M.text+"' data-value='"+M.value+"' class='k-button k-button-icontext'><span class='k-icon k-font-icon k-i-"+M.iconClass+"'></span>"+M.text+"</a>";
K.append(L);
});
},_action:function(K){var L=K.attr("data-value");
this.toolbar.action({command:"MergeCellCommand",options:{value:L}});
}});
var z=D.extend({_click:function(){this.toolbar.dialog({name:"merge"});
}});
y.toolbar.registerComponent("merge",A,z);
var x=E.extend({init:function(K,L){E.fn.init.call(this,K,L);
this._commandPalette();
this.popup.element.on("click",".k-button",function(M){this._action(a(M.currentTarget));
}.bind(this));
this.element.data({type:"freeze",freeze:this,instance:this});
},buttons:[{value:"panes",iconClass:"freeze-panes",text:B.freezeButtons.freezePanes},{value:"rows",iconClass:"freeze-row",text:B.freezeButtons.freezeRows},{value:"columns",iconClass:"freeze-col",text:B.freezeButtons.freezeColumns},{value:"unfreeze",iconClass:"normal-layout",text:B.freezeButtons.unfreeze}],destroy:function(){this.popup.element.off();
E.fn.destroy.call(this);
},_commandPalette:function(){var K=a("<div />").appendTo(this.popup.element);
this.buttons.forEach(function(M){var L="<a title='"+M.text+"' data-value='"+M.value+"' class='k-button k-button-icontext'><span class='k-icon k-font-icon k-i-"+M.iconClass+"'></span>"+M.text+"</a>";
K.append(L);
});
},_action:function(K){var L=K.attr("data-value");
this.toolbar.action({command:"FreezePanesCommand",options:{value:L}});
}});
var w=D.extend({_click:function(){this.toolbar.dialog({name:"freeze"});
}});
y.toolbar.registerComponent("freeze",x,w);
var F=l.extend({_revertTitle:function(K){K.sender.value("");
K.sender.wrapper.width("auto");
},init:function(L,M){l.fn.init.call(this,L,M);
var K=this.dropDownList;
K.bind("change",this._revertTitle.bind(this));
K.bind("dataBound",this._revertTitle.bind(this));
K.setOptions({valueTemplate:"<span class='k-icon k-font-icon k-i-"+L.iconClass+"' style='line-height: 1em; width: 1.35em;'></span>",template:"<span class='k-icon k-font-icon k-i-#= iconClass #' style='line-height: 1em; width: 1.35em;'></span>#=text#",dataTextField:"text",dataValueField:"value"});
K.setDataSource([{value:"asc",sheet:false,text:B.sortButtons.sortRangeAsc,iconClass:"sort-asc"},{value:"desc",sheet:false,text:B.sortButtons.sortRangeDesc,iconClass:"sort-desc"}]);
K.select(0);
this.element.data({type:"sort",sort:this});
},_change:function(L){var M=L.sender;
var K=M.dataItem();
if(K){this.toolbar.action({command:"SortCommand",options:{value:K.value,sheet:K.sheet}});
}},value:a.noop});
var G=D.extend({_click:function(){this.toolbar.dialog({name:"sort"});
}});
y.toolbar.registerComponent("sort",F,G);
var m=y.toolbar.ToolBarButton.extend({init:function(K,L){K.showText="overflow";
y.toolbar.ToolBarButton.fn.init.call(this,K,L);
this.element.on("click",this._click.bind(this));
this.element.data({type:"filter",filter:this});
},_click:function(){this.toolbar.action({command:"FilterCommand"});
},update:function(K){this.toggle(K);
}});
var n=D.extend({init:function(K,L){D.fn.init.call(this,K,L);
this.element.data({type:"filter",filter:this});
},_click:function(){this.toolbar.action({command:"FilterCommand"});
},update:function(K){this.toggle(K);
}});
y.toolbar.registerComponent("filter",m,n);
var C=y.toolbar.Item.extend({init:function(K,L){this.toolbar=L;
this.element=a("<div class='k-button k-upload-button k-button-icon'><span class='k-icon k-font-icon k-i-folder-open' /></div>").data("instance",this);
this._title=K.attributes.title;
this._reset();
},_reset:function(){this.element.remove("input");
a("<input type='file' autocomplete='off' accept='.xlsx'/>").attr("title",this._title).one("change",this._change.bind(this)).appendTo(this.element);
},_change:function(K){this.toolbar.action({command:"OpenCommand",options:{file:K.target.files[0]}});
this._reset();
}});
y.toolbar.registerComponent("open",C);
y.spreadsheet.TabStrip=y.ui.TabStrip.extend({init:function(K,L){y.ui.TabStrip.fn.init.call(this,K,L);
K.addClass("k-spreadsheet-tabstrip");
this._quickAccessButtons();
this.toolbars={};
var M=L.dataSource;
this.contentElements.each(function(O,N){this._toolbar(a(N),M[O].id,L.toolbarOptions[M[O].id]);
}.bind(this));
this.one("activate",function(){this.toolbars[this.options.dataSource[0].id].resize();
});
},events:y.ui.TabStrip.fn.events.concat(["action","dialog"]),destroy:function(){this.quickAccessToolBar.off("click");
y.ui.TabStrip.fn.destroy.call(this);
for(var K in this.toolbars){this.toolbars[K].destroy();
}},action:function(K){this.trigger("action",K);
},dialog:function(K){this.trigger("dialog",K);
},refreshTools:function(L){var M=this.toolbars;
for(var K in M){if(M.hasOwnProperty(K)){M[K].refresh(L);
}}},_quickAccessButtons:function(){var K=[{title:B.quickAccess.undo,iconClass:"undo-large",action:"undo"},{title:B.quickAccess.redo,iconClass:"redo-large",action:"redo"}];
var L=y.template("<a href='\\#' title='#= title #' data-action='#= action #' class='k-button k-button-icon'><span class='k-icon k-font-icon k-i-#=iconClass#'></span></a>");
this.quickAccessToolBar=a("<div />",{"class":"k-spreadsheet-quick-access-toolbar",html:y.render(L,K)}).insertBefore(this.wrapper);
this.quickAccessToolBar.on("click",".k-button",function(N){N.preventDefault();
var M=a(N.currentTarget).attr("data-action");
this.action({action:M});
}.bind(this));
this.quickAccessAdjust();
},quickAccessAdjust:function(){this.tabGroup.css("padding-left",this.quickAccessToolBar.outerWidth());
},_toolbar:function(K,M,O){var L;
var N;
if(this.toolbars[M]){this.toolbars[M].destroy();
K.children(".k-toolbar").remove();
}if(O){L=K.html("<div />").children("div");
N={tools:typeof O==="boolean"?undefined:O,toolbarName:M,action:this.action.bind(this),dialog:this.dialog.bind(this)};
this.toolbars[M]=new y.spreadsheet.ToolBar(L,N);
}}});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/dialogs",["kendo.core","kendo.binder","kendo.validator"],b);
}(function(){(function(o){if(o.support.browser.msie&&o.support.browser.version<9){return;
}var a=o.jQuery;
var t=o.data.ObservableObject;
var r=o.spreadsheet.messages.dialogs={apply:"Apply",save:"Save",cancel:"Cancel",remove:"Remove",retry:"Retry",revert:"Revert",okText:"OK",formatCellsDialog:{title:"Format",categories:{number:"Number",currency:"Currency",date:"Date"}},fontFamilyDialog:{title:"Font"},fontSizeDialog:{title:"Font size"},bordersDialog:{title:"Borders"},alignmentDialog:{title:"Alignment",buttons:{justtifyLeft:"Align left",justifyCenter:"Center",justifyRight:"Align right",justifyFull:"Justify",alignTop:"Align top",alignMiddle:"Align middle",alignBottom:"Align bottom"}},mergeDialog:{title:"Merge cells",buttons:{mergeCells:"Merge all",mergeHorizontally:"Merge horizontally",mergeVertically:"Merge vertically",unmerge:"Unmerge"}},freezeDialog:{title:"Freeze panes",buttons:{freezePanes:"Freeze panes",freezeRows:"Freeze rows",freezeColumns:"Freeze columns",unfreeze:"Unfreeze panes"}},validationDialog:{title:"Data Validation",hintMessage:"Please enter a valid {0} value {1}.",hintTitle:"Validation {0}",criteria:{any:"Any value",number:"Number",text:"Text",date:"Date",custom:"Custom Formula",list:"List"},comparers:{greaterThan:"greater than",lessThan:"less than",between:"between",notBetween:"not between",equalTo:"equal to",notEqualTo:"not equal to",greaterThanOrEqualTo:"greater than or equal to",lessThanOrEqualTo:"less than or equal to"},comparerMessages:{greaterThan:"greater than {0}",lessThan:"less than {0}",between:"between {0} and {1}",notBetween:"not between {0} and {1}",equalTo:"equal to {0}",notEqualTo:"not equal to {0}",greaterThanOrEqualTo:"greater than or equal to {0}",lessThanOrEqualTo:"less than or equal to {0}",custom:"that satisfies the formula: {0}"},labels:{criteria:"Criteria",comparer:"Comparer",min:"Min",max:"Max",value:"Value",start:"Start",end:"End",onInvalidData:"On invalid data",rejectInput:"Reject input",showWarning:"Show warning",showHint:"Show hint",hintTitle:"Hint title",hintMessage:"Hint message",ignoreBlank:"Ignore blank",showListButton:"Display button to show list",showCalendarButton:"Display button to show calendar"},placeholders:{typeTitle:"Type title",typeMessage:"Type message"}},exportAsDialog:{title:"Export...",labels:{scale:"Scale",fit:"Fit to page",fileName:"File name",saveAsType:"Save as type",exportArea:"Export",paperSize:"Paper size",margins:"Margins",orientation:"Orientation",print:"Print",guidelines:"Guidelines",center:"Center",horizontally:"Horizontally",vertically:"Vertically"}},modifyMergedDialog:{errorMessage:"Cannot change part of a merged cell."},overflowDialog:{errorMessage:"Cannot paste, because the copy area and the paste area are not the same size and shape."},useKeyboardDialog:{title:"Copying and pasting",errorMessage:"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:",labels:{forCopy:"for copy",forCut:"for cut",forPaste:"for paste"}},unsupportedSelectionDialog:{errorMessage:"That action cannot be performed on multiple selection."},linkDialog:{title:"Hyperlink",labels:{text:"Text",url:"Address",removeLink:"Remove link"}}};
var v={};
o.spreadsheet.dialogs={register:function(E,D){v[E]=D;
},registered:function(D){return !!v[D];
},create:function(E,F){var D=v[E];
if(D){return new D(F);
}}};
var w=o.spreadsheet.SpreadsheetDialog=o.Observable.extend({init:function(D){o.Observable.fn.init.call(this,D);
this.options=a.extend(true,{},this.options,D);
this.bind(this.events,D);
},events:["close","activate"],options:{autoFocus:true},dialog:function(){if(!this._dialog){this._dialog=a("<div class='k-spreadsheet-window k-action-window' />").addClass(this.options.className||"").append(o.template(this.options.template)({messages:o.spreadsheet.messages.dialogs||r})).appendTo(document.body).kendoWindow({autoFocus:this.options.autoFocus,scrollable:false,resizable:false,modal:true,visible:false,width:this.options.width||320,title:this.options.title,open:function(){this.center();
},close:this._onDialogClose.bind(this),activate:this._onDialogActivate.bind(this),deactivate:this._onDialogDeactivate.bind(this)}).data("kendoWindow");
}return this._dialog;
},_onDialogClose:function(){this.trigger("close",{action:this._action});
},_onDialogActivate:function(){this.trigger("activate");
},_onDialogDeactivate:function(){this.trigger("deactivate");
this.destroy();
},destroy:function(){if(this._dialog){this._dialog.destroy();
this._dialog=null;
}},open:function(){this.dialog().open();
},apply:function(){this.close();
},close:function(){this._action="close";
this.dialog().close();
}});
function l(E,D){return o.spreadsheet.formatting.text(E,D);
}var k=o.spreadsheet.FormatCellsViewModel=t.extend({init:function(D){t.fn.init.call(this,D);
this.useCategory(this.category);
},useCategory:function(D){var F=D&&D.type||"number";
var E=F=="currency";
this.category=D;
this.set("showCurrencyFilter",E&&this.currencies.length>1);
if(!E){this.set("formats",this.allFormats[F+"Formats"]);
}else{this.currency(this.currencies[0]);
}this.useFirstFormat();
},useFirstFormat:function(){if(this.formats.length){this.set("format",this.formats[0].value);
}},currency:function(D){if(D!==undefined){this._currency=D;
var F=D.value;
var E=[{currency:F,decimals:true},{currency:F,decimals:true,iso:true},{currency:F,decimals:false}];
E=E.map(function(G){G=k.convert.currency(G);
return{value:G,name:l(1000,G)};
});
this.set("formats",E);
this.useFirstFormat();
}return this._currency||this.currencies[0];
},categoryFilter:function(D){if(D!==undefined){this.useCategory(D);
}return this.category;
},preview:function(){var D=this.get("format");
var E=this.value||0;
if(D&&D.length){return l(E,D);
}else{return E;
}}});
k.convert={currency:function(F){function G(I,H){return new Array(H+1).join(I);
}var E=F.currency;
var D=E.pattern[1];
if(F.decimals){D=D.replace(/n/g,"n"+E["."]+G("0",E.decimals));
}if(F.iso){D='"'+E.abbr+'" '+D.replace(/\s*\$\s*/g,"");
}else{D=D.replace(/\$/g,E.symbol);
}D=D.replace(/n/g,"?");
return D;
},date:function(D){if(/T|Z/.test(D)){return"";
}return D.toLowerCase().replace(/tt/g,"AM/PM").replace(/'/g,'"');
}};
function x(E,D){var G=[];
var H=[];
for(var F=0;
F<D.length;
F++){if(a.inArray(D[F][E],H)==-1){G.push(D[F]);
H.push(D[F][E]);
}}return G;
}var j=w.extend({init:function(F){var E=o.spreadsheet.messages.dialogs.formatCellsDialog||r;
var D={title:E.title,categories:[{type:"number",name:E.categories.number},{type:"currency",name:E.categories.currency},{type:"date",name:E.categories.date}]};
w.fn.init.call(this,a.extend(D,F));
this._generateFormats();
},options:{className:"k-spreadsheet-format-cells",template:"<div class='k-root-tabs' data-role='tabstrip' data-text-field='name' data-bind='source: categories, value: categoryFilter' data-animation='false' /><div class='k-spreadsheet-preview' data-bind='text: preview' /><script type='text/x-kendo-template' id='format-item-template'>\\#: data.name \\#</script><select data-role='dropdownlist' class='k-format-filter' data-text-field='description' data-value-field='value.name' data-bind='visible: showCurrencyFilter, value: currency, source: currencies' /><ul data-role='staticlist' tabindex='0' class='k-list k-reset' data-template='format-item-template' data-value-primitive='true' data-value-field='value' data-bind='source: formats, value: format' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.apply #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div>"},_generateFormats:function(){var E=this.options;
if(!E.currencies){E.currencies=j.currenciesFrom(o.cultures);
}if(!E.numberFormats){E.numberFormats=[{value:"#.00%",name:"100.00%"},{value:"#%",name:"100%"},{value:"#.00",name:"1024.00"},{value:"#,###.00",name:"1,024.00"}];
}if(!E.dateFormats){var D=o.cultures.current.calendars.standard.patterns;
E.dateFormats=x("value",a.map(D,function(F){F=k.convert.date(F);
if(!F){return;
}return{value:F,name:l(34567.7678,F)};
}));
}},open:function(H){var G=this.options;
var I=H.value();
var D=G.categories.slice(0);
var F;
this.viewModel=new k({currencies:G.currencies.slice(0),allFormats:{numberFormats:G.numberFormats.slice(0),dateFormats:G.dateFormats.slice(0)},categories:D,format:H.format(),category:I instanceof Date?D[2]:D[0],apply:this.apply.bind(this),close:this.close.bind(this),value:I});
w.fn.open.call(this);
F=this.dialog().element;
o.bind(F,this.viewModel);
var E=F.find("select.k-format-filter").data("kendoDropDownList");
if(G.currencies.length>10){E.setOptions({filter:"contains"});
}F.find(o.roleSelector("staticlist")).parent().addClass("k-list-wrapper");
},apply:function(){var D=this.viewModel.format;
w.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"format",value:D}});
}});
j.currenciesFrom=function(D){return x("description",a.map(D,function(E,H){if(!/-/.test(H)){return;
}var F=E.numberFormat.currency;
var G=o.format("{0} ({1}, {2})",F.name,F.abbr,F.symbol);
return{description:G,value:F};
}));
};
o.spreadsheet.dialogs.register("formatCells",j);
o.spreadsheet.dialogs.FormatCellsDialog=j;
var q=w.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-bind='text: text' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: close'>#= messages.okText #</button></div>"},open:function(){w.fn.open.call(this);
var D=this.options;
var E=D.text;
if(D.messageId){E=o.getter(D.messageId,true)(o.spreadsheet.messages.dialogs);
}o.bind(this.dialog().element,{text:E,close:this.close.bind(this)});
}});
o.spreadsheet.dialogs.register("message",q);
var B=w.extend({options:{className:"k-spreadsheet-message",title:"",messageId:"",text:"",template:"<div class='k-spreadsheet-message-content' data-bind='text: text' /><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: close'>#= messages.retry #</button><button class='k-button' data-bind='click: revert'>#= messages.revert #</button></div>"},open:function(){w.fn.open.call(this);
var D=this.options;
var E=D.text;
if(D.messageId){E=o.getter(D.messageId,true)(o.spreadsheet.messages.dialogs);
}o.bind(this.dialog().element,{text:E,close:this.close.bind(this),revert:this.revert.bind(this)});
},activate:function(D){D.sender.dialog().element.find(".k-button").focus();
},revert:function(){this._action="revert";
this.dialog().close();
}});
o.spreadsheet.dialogs.register("validationError",B);
var h=w.extend({init:function(E){var D=o.spreadsheet.messages.dialogs.fontFamilyDialog||r;
w.fn.init.call(this,a.extend({title:D.title},E));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var F=this.dialog().element.find("ul");
var E=this.options.fonts;
var D=this.options.defaultFont;
this.list=new o.ui.StaticList(F,{dataSource:new o.data.DataSource({data:E}),template:"#: data #",value:D,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(D){w.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontFamily",value:D.sender.value()[0]}});
}});
o.spreadsheet.dialogs.register("fontFamily",h);
var i=w.extend({init:function(E){var D=o.spreadsheet.messages.dialogs.fontSizeDialog||r;
w.fn.init.call(this,a.extend({title:D.title},E));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var F=this.dialog().element.find("ul");
var E=this.options.sizes;
var D=this.options.defaultSize;
this.list=new o.ui.StaticList(F,{dataSource:new o.data.DataSource({data:E}),template:"#: data #",value:D,change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(D){w.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:"fontSize",value:o.parseInt(D.sender.value()[0])}});
}});
o.spreadsheet.dialogs.register("fontSize",i);
var c=w.extend({init:function(E){var D=o.spreadsheet.messages.dialogs.bordersDialog||r;
w.fn.init.call(this,a.extend({title:D.title},E));
this.element=this.dialog().element;
this._borderPalette();
this.viewModel=o.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
o.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{width:177,template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.apply #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div>"},apply:function(){w.fn.apply.call(this);
var D=this.value();
this.trigger("action",{command:"BorderChangeCommand",options:{border:D.type,style:{size:1,color:D.color}}});
},_borderPalette:function(){var D=this.dialog().element.find("div:first");
this.borderPalette=new o.spreadsheet.BorderPalette(D,{change:this.value.bind(this)});
},value:function(D){if(D===undefined){return this._state;
}else{this._state=D;
}}});
o.spreadsheet.dialogs.register("borders",c);
var d=w.extend({init:function(D){w.fn.init.call(this,D);
this.element=this.dialog().element;
this.property=D.property;
this.options.title=D.title;
this.viewModel=o.observable({apply:this.apply.bind(this),close:this.close.bind(this)});
o.bind(this.element.find(".k-action-buttons"),this.viewModel);
},options:{template:"<div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.apply #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div>"},apply:function(){w.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:this.property,value:this.value()}});
},value:function(D){if(D===undefined){return this._value;
}else{this._value=D.value;
}}});
var e=d.extend({init:function(D){D.width=177;
d.fn.init.call(this,D);
this._colorPalette();
},_colorPalette:function(){var D=this.dialog().element.find("div:first");
this.colorPalette=D.kendoColorPalette({palette:["#ffffff","#000000","#d6ecff","#4e5b6f","#7fd13b","#ea157a","#feb80a","#00addc","#738ac8","#1ab39f","#f2f2f2","#7f7f7f","#a7d6ff","#d9dde4","#e5f5d7","#fad0e4","#fef0cd","#c5f2ff","#e2e7f4","#c9f7f1","#d8d8d8","#595959","#60b5ff","#b3bcca","#cbecb0","#f6a1c9","#fee29c","#8be6ff","#c7d0e9","#94efe3","#bfbfbf","#3f3f3f","#007dea","#8d9baf","#b2e389","#f272af","#fed46b","#51d9ff","#aab8de","#5fe7d5","#a5a5a5","#262626","#003e75","#3a4453","#5ea226","#af0f5b","#c58c00","#0081a5","#425ea9","#138677","#7f7f7f","#0c0c0c","#00192e","#272d37","#3f6c19","#750a3d","#835d00","#00566e","#2c3f71","#0c594f"],change:this.value.bind(this)}).data("kendoColorPalette");
}});
o.spreadsheet.dialogs.register("colorPicker",e);
var f=d.extend({init:function(D){D.width=268;
d.fn.init.call(this,D);
this.dialog().setOptions({animation:false});
this.dialog().one("activate",this._colorPicker.bind(this));
},_colorPicker:function(){var D=this.dialog().element.find("div:first");
this.colorPicker=D.kendoFlatColorPicker({change:this.value.bind(this)}).data("kendoFlatColorPicker");
}});
o.spreadsheet.dialogs.register("customColor",f);
var b=w.extend({init:function(F){var E=o.spreadsheet.messages.dialogs.alignmentDialog||r;
var D={title:E.title,buttons:[{property:"textAlign",value:"left",iconClass:"justify-left",text:E.buttons.justtifyLeft},{property:"textAlign",value:"center",iconClass:"justify-center",text:E.buttons.justifyCenter},{property:"textAlign",value:"right",iconClass:"justify-right",text:E.buttons.justifyRight},{property:"textAlign",value:"justify",iconClass:"justify-full",text:E.buttons.justifyFull},{property:"verticalAlign",value:"top",iconClass:"align-top",text:E.buttons.alignTop},{property:"verticalAlign",value:"center",iconClass:"align-middle",text:E.buttons.alignMiddle},{property:"verticalAlign",value:"bottom",iconClass:"align-bottom",text:E.buttons.alignBottom}]};
w.fn.init.call(this,a.extend(D,F));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var D=this.dialog().element.find("ul");
this.list=new o.ui.StaticList(D,{dataSource:new o.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-property='#=property#' data-value='#=value#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(E){var D=E.sender.value()[0];
w.fn.apply.call(this);
this.trigger("action",{command:"PropertyChangeCommand",options:{property:D.property,value:D.value}});
}});
o.spreadsheet.dialogs.register("alignment",b);
var p=w.extend({init:function(F){var E=o.spreadsheet.messages.dialogs.mergeDialog||r;
var D={title:E.title,buttons:[{value:"cells",iconClass:"merge-cells",text:E.buttons.mergeCells},{value:"horizontally",iconClass:"merge-horizontally",text:E.buttons.mergeHorizontally},{value:"vertically",iconClass:"merge-vertically",text:E.buttons.mergeVertically},{value:"unmerge",iconClass:"normal-layout",text:E.buttons.unmerge}]};
w.fn.init.call(this,a.extend(D,F));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var D=this.dialog().element.find("ul");
this.list=new o.ui.StaticList(D,{dataSource:new o.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-value='#=value#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(E){var D=E.sender.value()[0];
w.fn.apply.call(this);
this.trigger("action",{command:"MergeCellCommand",options:{value:D.value}});
}});
o.spreadsheet.dialogs.register("merge",p);
var m=w.extend({init:function(F){var E=o.spreadsheet.messages.dialogs.freezeDialog||r;
var D={title:E.title,buttons:[{value:"panes",iconClass:"freeze-panes",text:E.buttons.freezePanes},{value:"rows",iconClass:"freeze-row",text:E.buttons.freezeRows},{value:"columns",iconClass:"freeze-col",text:E.buttons.freezeColumns},{value:"unfreeze",iconClass:"normal-layout",text:E.buttons.unfreeze}]};
w.fn.init.call(this,a.extend(D,F));
this._list();
},options:{template:"<ul class='k-list k-reset'></ul>"},_list:function(){var D=this.dialog().element.find("ul");
this.list=new o.ui.StaticList(D,{dataSource:new o.data.DataSource({data:this.options.buttons}),template:"<a title='#=text#' data-value='#=value#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</a>",change:this.apply.bind(this)});
this.list.dataSource.fetch();
},apply:function(E){var D=E.sender.value()[0];
w.fn.apply.call(this);
this.trigger("action",{command:"FreezePanesCommand",options:{value:D.value}});
}});
o.spreadsheet.dialogs.register("freeze",m);
var C=o.spreadsheet.ValidationCellsViewModel=t.extend({init:function(D){t.fn.init.call(this,D);
this.bind("change",function(E){if(E.field==="criterion"){this.reset();
if(this.criterion==="custom"||this.criterion==="list"){this.setHintMessageTemplate();
}}if(E.field==="comparer"){this.setHintMessageTemplate();
}if((E.field=="hintMessage"||E.field=="hintTitle")&&!this._mute){this.shouldBuild=false;
}if((E.field=="from"||E.field=="to"||E.field=="hintMessageTemplate"||E.field=="type")&&this.shouldBuild){this.buildMessages();
}}.bind(this));
this.reset();
},buildMessages:function(){this._mute=true;
this.set("hintTitle",this.hintTitleTemplate?o.format(this.hintTitleTemplate,this.type):"");
this.set("hintMessage",this.hintMessageTemplate?o.format(this.hintMessageTemplate,this.from,this.to):"");
this._mute=false;
},reset:function(){this.setComparers();
this.set("comparer",this.comparers[0].type);
this.set("from",null);
this.set("to",null);
this.set("useCustomMessages",false);
this.shouldBuild=true;
this.hintTitleTemplate=this.defaultHintTitle;
this.buildMessages();
},setComparers:function(){var D=this.defaultComparers;
var E=[];
if(this.criterion==="text"){var G=["equalTo","notEqualTo"];
for(var F=0;
F<D.length;
F++){if(G[0]==D[F].type){E.push(D[F]);
G.shift();
}}}else{E=D.slice();
}this.set("comparers",E);
},setHintMessageTemplate:function(){if(this.criterion!=="custom"&&this.criterion!=="list"){this.set("hintMessageTemplate",o.format(this.defaultHintMessage,this.criterion,this.comparerMessages[this.comparer]));
}else{this.set("hintMessageTemplate","");
this.set("hintMessage","");
}},isAny:function(){return this.get("criterion")==="any";
},isNumber:function(){return this.get("criterion")==="number";
},showToForNumber:function(){return this.showTo()&&this.isNumber();
},showToForDate:function(){return this.showTo()&&this.isDate();
},isText:function(){return this.get("criterion")==="text";
},isDate:function(){return this.get("criterion")==="date";
},isList:function(){return this.get("criterion")==="list";
},isCustom:function(){return this.get("criterion")==="custom";
},showRemove:function(){return this.get("hasValidation");
},showTo:function(){return this.get("comparer")=="between"||this.get("comparer")=="notBetween";
},update:function(D){this.set("hasValidation",!!D);
if(D){this.fromValidationObject(D);
}},fromValidationObject:function(D){this.set("criterion",D.dataType);
this.set("comparer",D.comparerType);
this.set("from",D.from);
this.set("to",D.to);
this.set("type",D.type);
this.set("ignoreBlank",D.allowNulls);
this.set("showButton",D.showButton);
if(D.messageTemplate||D.titleTemplate){this.hintMessageTemplate=D.messageTemplate;
this.hintMessage=D.messageTemplate;
this.hintTitleTemplate=D.titleTemplate;
this.hintTitle=D.titleTemplate;
this.useCustomMessages=true;
this.buildMessages();
}else{this.useCustomMessages=false;
}},toValidationObject:function(){if(this.criterion==="any"){return null;
}var D={type:this.type,dataType:this.criterion,comparerType:this.comparer,from:this.from,to:this.to,allowNulls:this.ignoreBlank,showButton:this.showButton};
if(this.useCustomMessages){D.messageTemplate=this.shouldBuild?this.hintMessageTemplate:this.hintMessage;
D.titleTemplate=this.hintTitle;
}return D;
}});
var A=w.extend({init:function(F){var E=o.spreadsheet.messages.dialogs.validationDialog||r;
var D={title:E.title,hintMessage:E.hintMessage,hintTitle:E.hintTitle,criteria:[{type:"any",name:E.criteria.any},{type:"number",name:E.criteria.number},{type:"text",name:E.criteria.text},{type:"date",name:E.criteria.date},{type:"custom",name:E.criteria.custom},{type:"list",name:E.criteria.list}],comparers:[{type:"greaterThan",name:E.comparers.greaterThan},{type:"lessThan",name:E.comparers.lessThan},{type:"between",name:E.comparers.between},{type:"notBetween",name:E.comparers.notBetween},{type:"equalTo",name:E.comparers.equalTo},{type:"notEqualTo",name:E.comparers.notEqualTo},{type:"greaterThanOrEqualTo",name:E.comparers.greaterThanOrEqualTo},{type:"lessThanOrEqualTo",name:E.comparers.lessThanOrEqualTo}],comparerMessages:E.comparerMessages};
w.fn.init.call(this,a.extend(D,F));
},options:{width:450,criterion:"any",type:"reject",ignoreBlank:true,showButton:true,useCustomMessages:false,errorTemplate:'<div class="k-widget k-tooltip k-tooltip-validation" style="margin:0.5em"><span class="k-icon k-i-warning"> </span>#= message #<div class="k-callout k-callout-n"></div></div>',template:'<div class="k-edit-form-container"><div class="k-edit-label"><label>#: messages.validationDialog.labels.criteria #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: criterion, source: criteria" /></div><div data-bind="visible: isNumber"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.min #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.min #" placeholder="e.g. 10" class="k-textbox" data-bind="value: from, enabled: isNumber" required="required" /></div><div data-bind="visible: showTo"><div class="k-edit-label"><label>#: messages.validationDialog.labels.max #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.max #" placeholder="e.g. 100" class="k-textbox" data-bind="value: to, enabled: showToForNumber" required="required" /></div></div></div><div data-bind="visible: isText"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.value #" class="k-textbox" data-bind="value: from, enabled: isText" required="required" /></div></div><div data-bind="visible: isDate"><div class="k-edit-label"><label>#: messages.validationDialog.labels.comparer #:</label></div><div class="k-edit-field"><select data-role="dropdownlist" data-text-field="name" data-value-field="type" data-bind="value: comparer, source: comparers" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.start #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.start #" class="k-textbox" data-bind="value: from, enabled: isDate" required="required" /></div><div data-bind="visible: showTo"><div class="k-edit-label"><label>#: messages.validationDialog.labels.end #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.end #" class="k-textbox" data-bind="value: to, enabled: showToForDate" required="required" /></div></div></div><div data-bind="visible: isCustom"><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.value #" class="k-textbox" data-bind="value: from, enabled: isCustom" required="required" /></div></div><div data-bind="visible: isList"><div class="k-edit-label"><label>#: messages.validationDialog.labels.value #:</label></div><div class="k-edit-field"><input name="#: messages.validationDialog.labels.value #" class="k-textbox" data-bind="value: from, enabled: isList" required="required" /></div></div><div data-bind="visible: isList"><div class="k-edit-field"><input type="checkbox" name="showButton" id="showButton" class="k-checkbox" data-bind="checked: showButton"/><label for="showButton" class="k-checkbox-label"> #: messages.validationDialog.labels.showListButton #</label></div></div><div data-bind="visible: isDate"><div class="k-edit-field"><input type="checkbox" name="showButton" id="showButton" class="k-checkbox" data-bind="checked: showButton"/><label for="showButton" class="k-checkbox-label"> #: messages.validationDialog.labels.showCalendarButton #</label></div></div><div data-bind="invisible: isAny"><div class="k-edit-field"><input type="checkbox" name="ignoreBlank" id="ignoreBlank" class="k-checkbox" data-bind="checked: ignoreBlank"/><label for="ignoreBlank" class="k-checkbox-label"> #: messages.validationDialog.labels.ignoreBlank #</label></div></div><div data-bind="invisible: isAny"><div class="k-action-buttons"></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div><div class="k-edit-field"><input type="radio" id="validationTypeReject" name="validationType" value="reject" data-bind="checked: type" class="k-radio" /><label for="validationTypeReject" class="k-radio-label">#: messages.validationDialog.labels.rejectInput #</label> <input type="radio" id="validationTypeWarning" name="validationType" value="warning" data-bind="checked: type" class="k-radio" /><label for="validationTypeWarning" class="k-radio-label">#: messages.validationDialog.labels.showWarning #</label></div></div><div data-bind="invisible: isAny" class="hint-wrapper"><div class="k-edit-field"><input type="checkbox" name="useCustomMessages" id="useCustomMessages" class="k-checkbox" data-bind="checked: useCustomMessages" /><label class="k-checkbox-label" for="useCustomMessages"> #: messages.validationDialog.labels.showHint #</label></div><div data-bind="visible: useCustomMessages"><div class="k-edit-label"><label>#: messages.validationDialog.labels.hintTitle #:</label></div><div class="k-edit-field"><input class="k-textbox" placeholder="#: messages.validationDialog.placeholders.typeTitle #" data-bind="value: hintTitle" /></div><div class="k-edit-label"><label>#: messages.validationDialog.labels.hintMessage #:</label></div><div class="k-edit-field"><input class="k-textbox" placeholder="#: messages.validationDialog.placeholders.typeMessage #" data-bind="value: hintMessage" /></div></div></div><div class="k-action-buttons"><button class="k-button" data-bind="visible: showRemove, click: remove">#: messages.remove #</button><button class="k-button k-primary" data-bind="click: apply">#: messages.apply #</button><button class="k-button" data-bind="click: close">#: messages.cancel #</button></div></div>'},open:function(F){var E=this.options;
var D;
this.viewModel=new C({type:E.type,defaultHintMessage:E.hintMessage,defaultHintTitle:E.hintTitle,defaultComparers:E.comparers.slice(0),comparerMessages:E.comparerMessages,criteria:E.criteria.slice(0),criterion:E.criterion,ignoreBlank:E.ignoreBlank,showButton:E.showButton,apply:this.apply.bind(this),close:this.close.bind(this),remove:this.remove.bind(this)});
this.viewModel.update(F.validation());
w.fn.open.call(this);
D=this.dialog().element;
if(this.validatable){this.validatable.destroy();
}o.bind(D,this.viewModel);
this.validatable=new o.ui.Validator(D.find(".k-edit-form-container"),{validateOnBlur:false,errorTemplate:this.options.errorTemplate||undefined});
},apply:function(){if(this.validatable.validate()){w.fn.apply.call(this);
this.trigger("action",{command:"EditValidationCommand",options:{value:this.viewModel.toValidationObject()}});
}},remove:function(){this.viewModel.set("criterion","any");
this.apply();
}});
o.spreadsheet.dialogs.register("validation",A);
o.spreadsheet.dialogs.ValidationDialog=A;
var g=w.extend({init:function(E){var D=o.spreadsheet.messages.dialogs.exportAsDialog||r;
w.fn.init.call(this,a.extend({title:D.title},E));
this.viewModel=o.observable({title:this.options.title,name:this.options.name,extension:this.options.extension,fileFormats:this.options.fileFormats,excel:E.excelExport,pdf:{proxyURL:E.pdfExport.proxyURL,forceProxy:E.pdfExport.forceProxy,title:E.pdfExport.title,author:E.pdfExport.author,subject:E.pdfExport.subject,keywords:E.pdfExport.keywords,creator:E.pdfExport.creator,date:E.pdfExport.date,fitWidth:this.options.pdf.fitWidth,area:this.options.pdf.area,areas:this.options.pdf.areas,paperSize:this.options.pdf.paperSize,paperSizes:this.options.pdf.paperSizes,margin:this.options.pdf.margin,margins:this.options.pdf.margins,landscape:this.options.pdf.landscape,guidelines:this.options.pdf.guidelines,hCenter:this.options.pdf.hCenter,vCenter:this.options.pdf.vCenter},apply:this.apply.bind(this),close:this.close.bind(this)});
this.viewModel.bind("change",function(F){if(F.field==="extension"){this.set("showPdfOptions",this.extension===".pdf"?true:false);
}});
o.bind(this.dialog().element,this.viewModel);
},options:{name:"Workbook",extension:".xlsx",fileFormats:[{description:"Excel Workbook (.xlsx)",extension:".xlsx"},{description:"Portable Document Format(.pdf)",extension:".pdf"}],pdf:{fitWidth:true,area:"workbook",areas:[{area:"workbook",text:"Entire Workbook"},{area:"sheet",text:"Active Sheet"},{area:"selection",text:"Selection"}],paperSize:"a4",paperSizes:[{value:"a2",text:"A2 (420 mm \xD7 594 mm)     "},{value:"a3",text:"A3 (297 mm x 420 mm)     "},{value:"a4",text:"A4 (210 mm x 297 mm)     "},{value:"a5",text:"A5 (148 mm x 210 mm)     "},{value:"b3",text:"B3 (353 mm \xD7 500 mm)     "},{value:"b4",text:"B4 (250 mm x 353 mm)     "},{value:"b5",text:"B5 (176 mm x 250 mm)     "},{value:"folio",text:'Folio (8.5" x 13")       '},{value:"legal",text:'Legal (8.5" x 14")       '},{value:"letter",text:'Letter (8.5" x 11")      '},{value:"tabloid",text:'Tabloid (11" x 17")      '},{value:"executive",text:'Executive (7.25" x 10.5")'}],margin:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},margins:[{value:{bottom:"0.75in",left:"0.7in",right:"0.7in",top:"0.75in"},text:"Normal"},{value:{bottom:"0.75in",left:"0.25in",right:"0.25in",top:"0.75in"},text:"Narrow"},{value:{bottom:"1in",left:"1in",right:"1in",top:"1in"},text:"Wide"}],landscape:true,guidelines:true,hCenter:true,vCenter:true},width:520,template:"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.fileName #:</label></div><div class='k-edit-field'><input class='k-textbox' data-bind='value: name' /></div><div ><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='description' data-value-field='extension' data-bind='value: extension, source: fileFormats' /></div></div><div class='export-config' data-bind='visible: showPdfOptions'><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='text' data-value-field='area' data-bind='value: pdf.area, source: pdf.areas' /></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-text-field='text' data-value-field='value' data-bind='value: pdf.paperSize, source: pdf.paperSizes' /></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.margins #:</label></div><div class='k-edit-field'><select data-role='dropdownlist' class='k-file-format' data-value-primitive='true'data-text-field='text' data-value-field='value' data-bind='value: pdf.margin, source: pdf.margins' /></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.orientation #:</label></div><div class='k-edit-field'><input type='radio' id='k-orientation-portrait' name='orientation' data-type='boolean' data-bind='checked: pdf.landscape' value='false' /><label class='k-orientation-label k-orientation-portrait-label' for='k-orientation-portrait'></label><input type='radio' id='k-orientation-landscape' name='orientation' data-type='boolean' data-bind='checked: pdf.landscape' value='true' /><label class='k-orientation-label k-orientation-landscape-label' for='k-orientation-landscape'></label></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.print #:</label></div><div class='k-edit-field'><input class='k-checkbox' id='guidelines' type='checkbox' data-bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>#: messages.exportAsDialog.labels.guidelines#</label></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.scale #:</label></div><div class='k-edit-field'><input class='k-checkbox' id='fitWidth' type='checkbox' data-bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>#: messages.exportAsDialog.labels.fit #</label></div><div class='k-edit-label'><label>#: messages.exportAsDialog.labels.center #:</label></div><div class='k-edit-field'><input class='k-checkbox' id='hCenter' type='checkbox' data-bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>#: messages.exportAsDialog.labels.horizontally #</label><input class='k-checkbox' id='vCenter' type='checkbox' data-bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>#: messages.exportAsDialog.labels.vertically #</label></div><div class='k-page-orientation' data-bind='css: {k-page-landscape: pdf.landscape}'><div class='k-margins-horizontal'></div><div class='k-margins-vertical'></div></div></div><div class='k-action-buttons'><button class='k-button k-primary' data-bind='click: apply'>#: messages.save #</button><button class='k-button' data-bind='click: close'>#: messages.cancel #</button></div>"},apply:function(){w.fn.apply.call(this);
this.trigger("action",{command:"SaveAsCommand",options:this.viewModel});
}});
o.spreadsheet.dialogs.register("exportAs",g);
var s=q.extend({options:{messageId:"modifyMergedDialog.errorMessage"}});
o.spreadsheet.dialogs.register("modifyMerged",s);
var u=q.extend({options:{messageId:"overflowDialog.errorMessage"}});
o.spreadsheet.dialogs.register("overflow",u);
var z=q.extend({init:function(E){var D=o.spreadsheet.messages.dialogs.useKeyboardDialog||r;
w.fn.init.call(this,a.extend({title:D.title},E));
},options:{template:"#: messages.useKeyboardDialog.errorMessage #<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div><div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div><div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div><div class=\"k-action-buttons\"><button class='k-button k-primary' data-bind='click: close'>#= messages.okText #</button></div>"}});
o.spreadsheet.dialogs.register("useKeyboard",z);
var y=q.extend({options:{messageId:"unsupportedSelectionDialog.errorMessage"}});
o.spreadsheet.dialogs.register("unsupportedSelection",y);
var n=w.extend({options:{template:"<div class='k-edit-label'><label>#: messages.linkDialog.labels.url #:</label></div><div class='k-edit-field'><input class='k-textbox' data-bind='value: url' /></div><div class='k-action-buttons'>"+("<button style='float: left' class='k-button' data-bind='click: remove'>#= messages.linkDialog.labels.removeLink #</button><button class='k-button k-primary' data-bind='click: apply'>#= messages.okText #</button><button class='k-button' data-bind='click: cancel'>#= messages.cancel #</button>")+"</div>",title:r.linkDialog.title,autoFocus:false},open:function(F){var G=this;
w.fn.open.apply(G,arguments);
var D=G.dialog().element;
var E=o.observable({url:F.link(),apply:function(){if(!/\S/.test(E.url)){E.url=null;
}G.trigger("action",{command:"HyperlinkCommand",options:{link:E.url}});
G.close();
},remove:function(){E.url=null;
E.apply();
},cancel:G.close.bind(G)});
o.bind(D,E);
D.find("input").focus().on("keydown",function(H){if(H.keyCode==13){E.url=a(this).val();
H.stopPropagation();
H.preventDefault();
E.apply();
}else{if(H.keyCode==27){H.stopPropagation();
H.preventDefault();
E.cancel();
}}});
}});
o.spreadsheet.dialogs.register("hyperlink",n);
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/sheetbinder",["kendo.core","kendo.data","spreadsheet/sheet"],b);
}(function(){(function(b){if(b.support.browser.msie&&b.support.browser.version<9){return;
}var a=function(d){return d;
};
var c=b.Class.extend({init:function(d){this.options=$.extend({},this.options,d);
this.columns=this._normalizeColumns(this.options.columns);
this._sheet();
this._dataSource();
this._header();
this._boundRowsCount=0;
this.dataSource.fetch();
},_sheet:function(){this.sheet=this.options.sheet;
this._sheetChangeHandler=this._sheetChange.bind(this);
this._sheetDeleteRowHandler=this._sheetDeleteRow.bind(this);
this._sheetInsertRowHandler=this._sheetInsertRow.bind(this);
this.sheet.bind("change",this._sheetChangeHandler).bind("deleteRow",this._sheetDeleteRowHandler).bind("insertRow",this._sheetInsertRowHandler);
},_sheetInsertRow:function(d){if(d.index!==undefined){this.dataSource.insert(Math.max(d.index-1,0),{});
}},_sheetDeleteRow:function(f){if(f.index!==undefined){var d=this.dataSource;
var g=d.view()[f.index-1];
if(g){d.remove(g);
}}},_header:function(){this.sheet.batch(function(){this.columns.forEach(function(d,e){this.sheet.range(0,e).value(d.title);
}.bind(this));
}.bind(this));
},_sheetChange:function(h){if(h.insertRow||h.deleteRow){return;
}if(h.recalc&&h.ref){var g=this.dataSource;
var f=g.view();
var d=this.columns;
var i;
if(g.reader.model){i=g.reader.model.fields;
}if(!d.length&&f.length){d=Object.keys(f[0].toJSON());
}var j=d.map(function(e){var l=e.field;
if(l&&i&&i[l]&&i[l].type=="date"){return b.spreadsheet.numberToDate;
}return a;
});
this._skipRebind=true;
var k=this.sheet.range(h.ref).values();
h.ref.forEach(function(n){n=n.toRangeRef();
var m;
var p=0;
for(var o=n.topLeft.row;
o<=n.bottomRight.row;
o++){m=f[o-1];
if(!m){m=g.insert(o-1,{});
f=g.view();
}var l=0;
for(var e=n.topLeft.col;
e<=n.bottomRight.col&&e<d.length;
e++){m.set(d[e].field,j[e](k[p][l++]));
}p++;
}});
this._boundRowsCount=g.view().length;
this._skipRebind=false;
}},_normalizeColumns:function(d){return d.map(function(e){var f=e.field||e;
return{field:f,title:e.title||f};
});
},_dataSource:function(){var e=this.options;
var d=e.dataSource;
d=Array.isArray(d)?{data:d}:d;
if(this.dataSource&&this._changeHandler){this.dataSource.unbind("change",this._changeHandler);
}else{this._changeHandler=this._change.bind(this);
}this.dataSource=b.data.DataSource.create(d).bind("change",this._changeHandler);
},_change:function(){if(this._skipRebind){return;
}var e=this.dataSource.view();
var d=this.columns;
if(!d.length&&e.length){this.columns=d=this._normalizeColumns(Object.keys(e[0].toJSON()));
this._header();
}var f=d.map(function(g){return b.getter(g.field);
});
this.sheet.batch(function(){var i=Math.max(e.length,this._boundRowsCount);
for(var h=0;
h<i;
h++){for(var g=0;
g<f.length;
g++){var j=e[h]?f[g](e[h]):null;
this.sheet.range(h+1,g).value(j);
}}}.bind(this));
this._boundRowsCount=e.length;
},destroy:function(){this.dataSource.unbind("change",this._changeHandler);
this.sheet.unbind("change",this._sheetChangeHandler).unbind("deleteRow",this._sheetDeleteRowHandler).unbind("insertRow",this._sheetInsertRowHandler);
},options:{columns:[]}});
b.spreadsheet.SheetDataSourceBinder=c;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/filtermenu",["kendo.core","kendo.popup","kendo.treeview","kendo.numerictextbox","kendo.datepicker","kendo.datetimepicker"],b);
}(function(){(function(k){if(k.support.browser.msie&&k.support.browser.version<9){return;
}var a=k.jQuery;
var n=k.ui.Widget;
var b={details:"k-details",button:"k-button",detailsSummary:"k-details-summary",detailsContent:"k-details-content",icon:"k-icon k-font-icon",iconCollapse:"k-i-collapse-se",iconExpand:"k-i-expand-e",iconSearch:"k-i-search",textbox:"k-textbox",wrapper:"k-spreadsheet-filter-menu",filterByCondition:"k-spreadsheet-condition-filter",filterByValue:"k-spreadsheet-value-filter",valuesTreeViewWrapper:"k-spreadsheet-value-treeview-wrapper",actionButtons:"k-action-buttons"};
var c=n.extend({init:function(o,q){n.fn.init.call(this,o,q);
this.element.addClass(f.classNames.details);
this._summary=this.element.find("."+f.classNames.detailsSummary).on("click",this._toggle.bind(this));
var p=q.expanded?f.classNames.iconCollapse:f.classNames.iconExpand;
this._icon=a("<span />",{"class":f.classNames.icon+" "+p}).prependTo(this._summary);
this._container=k.wrap(this._summary.next(),true);
if(!q.expanded){this._container.hide();
}},options:{name:"Details"},events:["toggle"],visible:function(){return this.options.expanded;
},toggle:function(p){var o=k.fx(this._container).expand("vertical");
o.stop()[p?"reverse":"play"]();
this._icon.toggleClass(f.classNames.iconExpand,p).toggleClass(f.classNames.iconCollapse,!p);
this.options.expanded=!p;
},_toggle:function(){var o=this.visible();
this.toggle(o);
this.trigger("toggle",{show:o});
}});
var g=k.spreadsheet.messages.filterMenu={sortAscending:"Sort range A to Z",sortDescending:"Sort range Z to A",filterByValue:"Filter by value",filterByCondition:"Filter by condition",apply:"Apply",search:"Search",addToCurrent:"Add to current selection",clear:"Clear",blanks:"(Blanks)",operatorNone:"None",and:"AND",or:"OR",operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}};
k.data.binders.spreadsheetFilterValue=k.data.Binder.extend({init:function(p,o,q){k.data.Binder.fn.init.call(this,p,o,q);
this._change=a.proxy(this.change,this);
a(this.element).on("change",this._change);
},refresh:function(){var o=this,p=o.bindings.spreadsheetFilterValue.get();
a(o.element).val(p instanceof Date?"":p);
},change:function(){var o=this.element.value;
this.bindings.spreadsheetFilterValue.set(o);
}});
k.data.binders.widget.spreadsheetFilterValue=k.data.Binder.extend({init:function(q,o,p){k.data.Binder.fn.init.call(this,q.element[0],o,p);
this.widget=q;
this._change=a.proxy(this.change,this);
this.widget.first("change",this._change);
},refresh:function(){var o=this.bindings.spreadsheetFilterValue,q=o.get(),p=a(this.widget.element).data("filterType");
if(p==="date"&&q instanceof Date||p==="number"&&!isNaN(q)){this.widget.value(q);
}else{this.widget.value(null);
}},change:function(){var p=this.widget.value(),o=this.bindings.spreadsheetFilterValue;
o.set(p);
}});
var l={filterByValue:"<div class='"+b.detailsSummary+"'>#= messages.filterByValue #</div><div class='"+b.detailsContent+"'><div class='k-textbox k-space-right'><input placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' /><span class='k-icon k-font-icon k-i-search' /></div><div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#' /><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div><div class='"+b.valuesTreeViewWrapper+"'><div data-#=ns#role='treeview' data-#=ns#checkboxes='{ checkChildren: true }' data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' /></div></div>",filterByCondition:"<div class='"+b.detailsSummary+"'>#= messages.filterByCondition #</div><div class='"+b.detailsContent+'\'><div><select data-#=ns#role="dropdownlist"data-#=ns#bind="value: operator, source: operators, events: { change: operatorChange } "data-value-primitive="false"data-option-label="#=messages.operatorNone#"data-height="auto"data-text-field="text"data-value-field="unique"></select></div><div data-#=ns#bind="visible: isString"><input data-filter-type="string" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" class="k-textbox" /></div><div data-#=ns#bind="visible: isNumber"><input data-filter-type="number" data-#=ns#role="numerictextbox" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div><div data-#=ns#bind="visible: isDate"><input data-filter-type="date" data-#=ns#role="datepicker" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div></div>',menuItem:"<li data-command='#=command#' data-dir='#=dir#'><span class='k-icon k-font-icon k-i-#=iconClass#'></span>#=text#</li>",actionButtons:"<button data-#=ns#bind='click: apply' class='k-button k-primary'>#=messages.apply#</button><button data-#=ns#bind='click: clear' class='k-button'>#=messages.clear#</button>"};
function d(r){var o={};
var q=[];
for(var p=0;
p<r.length;
p++){if(!o[r[p].value]){o[r[p].value]=r[p];
q.push(r[p]);
}else{if(!o[r[p].value].checked&&r[p].checked){o[r[p].value].checked=true;
}}}return q;
}function e(q,v){var r=false;
var p=q instanceof k.data.HierarchicalDataSource&&q.data();
for(var s=0;
s<p.length;
s++){var t=p[s];
var w=t.text.toString().toLowerCase();
var u=v===true||v===""||w.indexOf(v)>=0;
var o=e(t.children,u||v);
r=r||o||u;
t.hidden=!u&&!o;
t.checked=!t.hidden;
}if(p){q.filter({field:"hidden",operator:"neq",value:true});
}return r;
}function m(p){var o=p instanceof k.data.HierarchicalDataSource&&p.data();
for(var q=0;
q<o.length;
q++){var r=o[q];
r.checked=false;
if(r.hasChildren){m(r.children);
}}}var i=k.spreadsheet.FilterMenuViewModel=k.data.ObservableObject.extend({valuesChange:function(s){var r=s?s.sender.dataSource:this.valuesDataSource;
var p=function(w){return w.checked;
};
var u=function(w){return w.dataType==="date"?k.spreadsheet.dateToNumber(w.value):w.value;
};
var t=function(y,x,w){return w.lastIndexOf(y)===x;
};
var q=r.data();
var v=q[0].children.data().toJSON();
var o=v.filter(function(w){return w.dataType==="blank";
});
o=o.length?o[0].checked:false;
v=v.filter(p).map(u);
if(this.appendToSearch&&this.valueFilter&&this.valueFilter.values.length){v=v.concat(this.valueFilter.values.toJSON()).sort().filter(t);
}this.set("valueFilter",{values:v,blanks:o});
},valueSelect:function(o){o.preventDefault();
var p=o.sender.dataItem(o.node);
p.set("checked",!p.checked);
},hasActiveSearch:false,appendToSearch:false,filterValues:function(p){var q=typeof p=="string"?p:a(p.target).val().toLowerCase();
var o=this.valuesDataSource;
this.set("hasActiveSearch",!!q);
m(o);
e(o,q);
},reset:function(){this.set("customFilter",{logic:"and",criteria:[{operator:null,value:null}]});
this.set("valueFilter",{values:[]});
},operatorChange:function(p){var o=p.sender.dataItem();
this.set("operatorType",o.type);
this.set("customFilter.criteria[0].operator",o.value);
},isNone:function(){return this.get("operatorType")===undefined;
},isString:function(){return this.get("operatorType")==="string";
},isNumber:function(){return this.get("operatorType")==="number";
},isDate:function(){return this.get("operatorType")==="date";
}});
function j(q){var o=g.operators;
var r=[];
for(var s in q){if(!q.hasOwnProperty(s)){continue;
}for(var p in q[s]){if(!q[s].hasOwnProperty(p)){continue;
}r.push({text:o[s][p],value:p,unique:s+"_"+p,type:s});
}}return r;
}var h=k.spreadsheet.FilterMenuController={valuesTree:function(p,o){return[{text:"All",expanded:true,checked:true,items:this.values(p.resize({top:1}),o)}];
},values:function(r,o){var t=[];
var q=g;
var p=r.column(o);
var s=r.sheet();
p.forEachCell(function(x,v,u){if(s.isHiddenRow(x)){return;
}var z=u.value;
var w=u.dataType;
var y=u.text;
if(z===undefined){w="blank";
}else{if(u.format){w=k.spreadsheet.formatting.type(z,u.format);
}else{w=typeof z;
}}if(z!==null&&u.format){y=k.spreadsheet.formatting.text(z,u.format);
}else{y=w=="blank"?q.blanks:z;
}if(w==="percent"){w="number";
}if(w==="date"){z=k.spreadsheet.numberToDate(z);
}t.push({dataType:w,value:z,text:y,checked:true});
});
t=d(t);
t.sort(function(u,v){if(u.dataType===v.dataType){return 0;
}if(u.dataType==="blank"||v.dataType==="blank"){return u.dataType==="blank"?-1:1;
}if(u.dataType==="number"||v.dataType==="number"){return u.dataType==="number"?-1:1;
}if(u.dataType==="date"||v.dataType==="date"){return u.dataType==="date"?-1:1;
}return 0;
});
return t;
},filterType:function(q,o){var r=q.sheet();
var p=this.filterForColumn(o,r);
var t;
p=p&&p.filter.toJSON();
if(p&&p.filter=="custom"){var u=p.criteria[0].value;
if(u instanceof Date){t="date";
}else{if(typeof u=="string"){t="string";
}else{if(typeof u=="number"){t="number";
}}}}if(!t){var s=this.values(q.row(1),o)[0];
t=s&&s.dataType;
if(t=="blank"){t=null;
}}return t;
},filterForColumn:function(p,r){var o=r.filter();
var q;
if(o){q=o.columns.filter(function(s){return s.index===p;
})[0];
}return q;
},filter:function(o,t){var p=this.filterForColumn(o,t);
if(!p){return;
}var r=p.filter.toJSON();
var u=r.filter;
delete r.filter;
var s={type:u,options:r};
var q=r.criteria;
if(q&&q.length){s.operator=q[0].operator;
}return s;
}};
var f=n.extend({init:function(o,p){n.call(this,o,p);
this.element.addClass(f.classNames.wrapper);
this.viewModel=new i({active:"value",operator:null,operators:j(this.options.operators),clear:this.clear.bind(this),apply:this.apply.bind(this)});
this._filterInit();
this._popup();
this._sort();
this._filterByCondition();
this._filterByValue();
this._actionButtons();
},options:{name:"FilterMenu",column:0,range:null,operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}},events:["action"],destroy:function(){n.fn.destroy.call(this);
this.menu.destroy();
this.valuesTreeView.destroy();
this.popup.destroy();
},openFor:function(o){this.popup.setOptions({anchor:o});
this.popup.open();
},close:function(){this.popup.close();
},clear:function(){this.action({command:"ClearFilterCommand",options:{column:this.options.column}});
this.viewModel.reset();
this.close();
},apply:function(){this._active();
var p={operatingRange:this.options.range,column:this.options.column};
var q;
var o;
if(this.viewModel.active==="value"){this.viewModel.valuesChange({sender:this.valuesTreeView});
q=this.viewModel.valueFilter.toJSON();
if(q.blanks||q.values&&q.values.length){p.valueFilter=q;
}}else{if(this.viewModel.active==="custom"){o=this.viewModel.customFilter.toJSON();
if(o.criteria.length&&o.criteria[0].value!==null){p.customFilter=o;
}}}if(p.valueFilter||p.customFilter){this.action({command:"ApplyFilterCommand",options:p});
}},action:function(o){this.trigger("action",a.extend({},o));
},_filterInit:function(){var p=this.options.column;
var r=this.options.range;
var s=r.sheet();
var o=h.filter(p,s);
if(o){var q=h.filterType(r,p);
this.viewModel.set("active",o.type);
this.viewModel.set(o.type+"Filter",o.options);
if(o.type=="custom"){this.viewModel.set("operator",q+"_"+o.operator);
this.viewModel.set("operatorType",q);
}}else{this.viewModel.reset();
}},_popup:function(){this.popup=this.element.kendoPopup({copyAnchorStyles:false}).data("kendoPopup");
},_sort:function(){var q=k.template(f.templates.menuItem);
var p=g;
var o=[{command:"sort",dir:"asc",text:p.sortAscending,iconClass:"sort-asc"},{command:"sort",dir:"desc",text:p.sortDescending,iconClass:"sort-desc"}];
var r=a("<ul />",{html:k.render(q,o)}).appendTo(this.element);
this.menu=r.kendoMenu({orientation:"vertical",select:function(t){var s=a(t.item).data("dir");
var v=this.options.range.resize({top:1});
var u={value:s,sheet:false,operatingRange:v,column:this.options.column};
if(v.isSortable()){this.action({command:"SortCommand",options:u});
}else{this.close();
}}.bind(this)}).data("kendoMenu");
},_appendTemplate:function(s,o,q,r){var p=k.template(s);
var t=a("<div class='"+o+"'/>").html(p({messages:g,guid:k.guid(),ns:k.ns}));
this.element.append(t);
if(q){q=new c(t,{expanded:r,toggle:this._detailToggle.bind(this)});
}k.bind(t,this.viewModel);
return t;
},_detailToggle:function(o){this.element.find("[data-role=details]").not(o.sender.element).data("kendoDetails").toggle(!o.show);
},_filterByCondition:function(){var o=this.viewModel.active==="custom";
this._appendTemplate(f.templates.filterByCondition,f.classNames.filterByCondition,true,o);
},_filterByValue:function(){var o=this.viewModel.active==="value";
var q=this._appendTemplate(f.templates.filterByValue,f.classNames.filterByValue,true,o);
this.valuesTreeView=q.find("[data-role=treeview]").data("kendoTreeView");
var p=h.valuesTree(this.options.range,this.options.column);
this.viewModel.set("valuesDataSource",new k.data.HierarchicalDataSource({data:p}));
},_actionButtons:function(){this._appendTemplate(f.templates.actionButtons,f.classNames.actionButtons,false);
},_active:function(){var o=this.element.find("[data-role=details]").filter(function(q,p){return a(p).data("kendoDetails").visible();
});
if(o.hasClass(f.classNames.filterByValue)){this.viewModel.set("active","value");
}else{if(o.hasClass(f.classNames.filterByCondition)){this.viewModel.set("active","custom");
}}}});
k.spreadsheet.FilterMenu=f;
a.extend(true,f,{classNames:b,templates:l});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/editor",["kendo.core"],b);
}(function(){(function(a){if(a.support.browser.msie&&a.support.browser.version<9){return;
}var c=a.Observable.extend({init:function(d){a.Observable.fn.init.call(this);
this.view=d;
this.formulaBar=d.formulaBar;
this._active=false;
this.barInput=d.formulaBar.formulaInput;
this.cellInput=d.formulaInput;
this.barInput.syncWith(this.cellInput);
this.cellInput.syncWith(this.barInput);
this.barInput.bind("keyup",this._triggerUpdate.bind(this));
this.cellInput.bind("keyup",this._triggerUpdate.bind(this));
this.barInput.bind("focus",this._focus.bind(this));
this.cellInput.bind("focus",this._focus.bind(this));
this.barInput.bind("blur",this._blur.bind(this));
this.cellInput.bind("blur",this._blur.bind(this));
},events:["activate","deactivate","change","update"],_focus:function(d){this.lastActive=d.sender==this.barInput?"bar":"cell";
},_blur:function(){},_triggerUpdate:function(){this.trigger("update",{value:this.value()});
},activeEditor:function(){var e=null;
var d=a._activeElement();
if(this.barElement()[0]===d){e=this.barInput;
}else{if(this.cellElement()[0]===d){e=this.cellInput;
}}return e;
},activate:function(d){this._active=true;
this._rect=d.rect;
this.cellInput.position(d.rect);
this.cellInput.resize(d.rect);
this.cellInput.tooltip(d.tooltip);
this.cellInput.activeCell=this.barInput.activeCell=d.range.topLeft;
this.trigger("activate");
return this;
},deactivate:function(){var d=this.cellInput;
if(!this._active){return;
}if(d.value()!=this._value){if(this.trigger("change",{value:d.value()})){return;
}}this._active=false;
this._rect=null;
d.hide();
this.trigger("deactivate");
},enable:function(d){this.barInput.enable(d);
this.cellInput.enable(d);
},enableEditing:function(d){this.barInput.enableEditing(d);
this.cellInput.enableEditing(d);
},barElement:function(){return this.barInput.element;
},cellElement:function(){return this.cellInput.element;
},focusLastActive:function(){this.focus(this.lastActive);
},focus:function(d){d=d||"cell";
if(d==="cell"){this.cellInput.element.focus();
this.cellInput.end();
}else{this.barInput.element.focus();
}},isActive:function(){return this._active;
},isFiltered:function(){return this.barInput.popup.visible()||this.cellInput.popup.visible();
},canInsertRef:function(e){var d=this.activeEditor();
return d&&d.canInsertRef(e);
},highlightedRefs:function(){var d=this.activeEditor();
var e=[];
if(d){e=d.highlightedRefs();
}return e;
},scale:function(){this.cellInput.scale();
},toggleTooltip:function(d){this.cellInput.toggleTooltip(b(this._rect,d));
},value:function(d){if(d===undefined){return this.barInput.value();
}if(d===null){d="";
}this._value=d;
this.barInput.value(d);
this.cellInput.value(d);
},insertNewline:function(){this.activeEditor().insertNewline();
this.scale();
}});
function b(e,d){return e&&(e.top!==d.top||e.left!==d.left);
}a.spreadsheet.SheetEditor=c;
}(kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/autofill",["spreadsheet/runtime","spreadsheet/range"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var o=kendo.spreadsheet;
var m=o.Range;
var n=o.calc.runtime;
var g=n.Formula;
var j="Incompatible ranges in fillFrom";
var k="Cannot determine fill direction";
var l="Destination range contains disabled cells";
var b=m.FillError=function(r){this.msg=r;
};
b.prototype.toString=function(){return this.msg;
};
m.prototype._previewFillFrom=function(J,x){var w=this,G=w._sheet;
if(typeof J=="string"){J=G.range(J);
}var H=J._ref.toRangeRef();
var v=w._ref.toRangeRef();
if(H.intersects(v)){if(H.eq(v)){return null;
}v=v.clone();
if(H.topLeft.eq(v.topLeft)){if(H.width()==v.width()){v.topLeft.row+=H.height();
x=0;
}else{if(H.height()==v.height()){v.topLeft.col+=H.width();
x=1;
}else{throw new b(j);
}}}else{if(H.bottomRight.eq(v.bottomRight)){if(H.width()==v.width()){v.bottomRight.row-=H.height();
x=2;
}else{if(H.height()==v.height()){v.bottomRight.col-=H.width();
x=3;
}else{throw new b(j);
}}}else{throw new b(j);
}}return G.range(v)._previewFillFrom(J,x);
}if(x==null){if(H.topLeft.col==v.topLeft.col){x=H.topLeft.row<v.topLeft.row?0:2;
}else{if(H.topLeft.row==v.topLeft.row){x=H.topLeft.col<v.topLeft.col?1:3;
}else{throw new b(k);
}}}var A=x&1;
var u=x&2;
if(A&&H.height()!=v.height()||!A&&H.width()!=v.width()){throw new b(j);
}var t=J._properties(),E;
if(!A){t=q(t);
E=v.height();
}else{E=v.width();
}var z=new Array(t.length);
for(var B=0;
B<t.length;
++B){var F=t[B];
var y=c(F);
var r=z[B]=new Array(E);
for(var D=0;
D<E;
++D){var C=u?-D-1:F.length+D;
var I=u?F.length-D%F.length-1:D%F.length;
r[u?E-D-1:D]=y(C,I);
}}if(!A){z=q(z);
}return{props:z,direction:x,dest:w};
};
m.prototype.fillFrom=function(s,r){var t=this._previewFillFrom(s,r);
if(!t.dest.enable()){throw new b(l);
}t.dest._properties(t.props);
return t.dest;
};
function i(t){var x=t.length;
var v=(x+1)/2,w=t.reduce(function(C,D){return C+D;
},0)/x;
var y=0,z=0;
for(var u=0;
u<x;
u++){var A=u+1-v,B=t[u]-w;
y+=A*B;
z+=A*A;
}if(!z){return function(C){return t[C%t.length];
};
}var s=y/z,r=w-s*v;
return function(C){return r+s*(C+1);
};
}function c(u){function s(w){var x=w[1]-w[0];
for(var y=2;
y<w.length;
++y){if(w[y]-w[y-1]!=x){return null;
}}return x;
}function t(w){return w.map(function(x){return x.number;
});
}var v=[];
var r=u.map(function(w){return w.formula||w.value;
});
e(r,function(x,z,D,w){var A,E;
if(D=="number"){E=t(w);
if(E.length==1&&(x>0||z<r.length||f(E[0],u[x].format)=="date")){E.push(E[0]+1);
}A=i(E);
}else{if(D=="string"||D=="formula"||D=="boolean"){A=function(G,F){return r[F];
};
}else{if(Array.isArray(D)){if(w.length==1){A=function(F){return D[(w[0].number+F)%D.length];
};
}else{var y=s(t(w));
if(y==null){A=function(F){return w[F%w.length].value;
};
}else{A=function(G){var F=w[0].number+y*G;
return D[F%D.length];
};
}}}else{if(D!="null"){E=t(w);
if(E.length==1){E.push(E[0]+1);
}E=i(E);
A=function(G,F){return r[F].replace(/^(.*\D)\d+/,"$1"+E(G,F));
};
}else{A=function(){return null;
};
}}}}var C={f:A,begin:x,end:z,len:z-x};
for(var B=x;
B<z;
++B){v[B]=C;
}});
return function(y,w){var C=v[w];
var A=y/r.length|0;
var B=y%r.length;
var x=A*C.len+B-C.begin;
var D=C.f(x,w);
var z=a(u[w]);
delete z.enable;
if(D instanceof g){z.formula=D;
}else{z.value=D;
}return z;
};
}function f(s,r){if(r!=null){return o.formatting.type(s,r);
}}function a(s){var r={};
Object.keys(s||{}).forEach(function(t){r[t]=s[t];
});
return r;
}function e(s,t){var v=null,w=0,r=[],x;
for(var u=0;
u<s.length;
++u){x=h(s[u]);
r.push(x);
if(v!=null&&x.type!==v.type){t(w,u,v.type,r.slice(w,u));
w=u;
}v=x;
}t(w,u,v.type,r.slice(w,u));
}function h(r){if(typeof r=="number"){return{type:"number",number:r};
}if(typeof r=="string"){var s=d(r);
if(s){return s;
}var t=/^(.*\D)(\d+)/.exec(r);
if(t){r=r.replace(/^(.*\D)\d+/,"$1-######");
return{type:r,match:t,number:parseFloat(t[2])};
}return{type:"string"};
}if(typeof r=="boolean"){return{type:"boolean"};
}if(r==null){return{type:"null"};
}if(r instanceof g){return{type:"formula"};
}window.console.error(r);
throw new Error("Cannot fill data");
}function p(){var r=kendo.culture();
return[r.calendars.standard.days.namesAbbr,r.calendars.standard.days.names,r.calendars.standard.months.namesAbbr,r.calendars.standard.months.names];
}function d(w){var x=w.toLowerCase();
var v=p();
for(var t=0;
t<v.length;
++t){var r=v[t];
for(var u=r.length;
--u>=0;
){var s=r[u].toLowerCase();
if(s==x){return{type:r,number:u,value:w};
}}}}function q(r){var s=r.length,x=r[0].length;
var w=[];
for(var u=0;
u<x;
++u){w[u]=[];
for(var v=0;
v<s;
++v){w[u][v]=r[v][u];
}}return w;
}},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/nameeditor",["kendo.core"],b);
}(function(){(function(c){if(c.support.browser.msie&&c.support.browser.version<9){return;
}var a=c.jQuery;
var b={input:"k-spreadsheet-name-editor",list:"k-spreadsheet-name-list"};
var d=c.ui.Widget.extend({init:function(f,g){c.ui.Widget.call(this,f,g);
f.addClass(b.input);
var e=new c.data.DataSource({transport:{read:function(i){var h=[];
this._workbook.forEachName(function(j){if(!j.hidden&&j.value instanceof c.spreadsheet.Ref){h.push({name:j.name});
}});
i.success(h);
}.bind(this),cache:false}});
this.combo=a("<input />").appendTo(f).kendoComboBox({clearButton:false,dataTextField:"name",dataValueField:"name",template:"#:data.name#<a class='k-button-delete' href='\\#'><span class='k-icon k-i-close'></span></a>",dataSource:e,autoBind:false,ignoreCase:true,change:this._on_listChange.bind(this),noDataTemplate:"<div></div>",open:function(){e.read();
}}).getKendoComboBox();
this.combo.input.on("keydown",this._on_keyDown.bind(this)).on("focus",this._on_focus.bind(this));
this.combo.popup.element.addClass("k-spreadsheet-names-popup").on("mousemove",function(h){h.stopPropagation();
}).on("click",".k-button-delete",function(h){h.preventDefault();
h.stopPropagation();
var i=a(h.target).closest(".k-item");
i=this.combo.dataItem(i);
this._deleteItem(i.name);
}.bind(this));
},value:function(e){if(e===undefined){return this.combo.value();
}else{this.combo.value(e);
}},_deleteItem:function(e){this.trigger("delete",{name:e});
},_on_keyDown:function(e){switch(e.keyCode){case 27:this.combo.value(this._prevValue);
this.trigger("cancel");
break;
case 13:this.trigger("enter");
break;
}},_on_focus:function(){this._prevValue=this.combo.value();
},_on_listChange:function(){var e=this.combo.value();
if(e){this.trigger("select",{name:e});
}}});
c.spreadsheet.NameEditor=d;
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("spreadsheet/print",["kendo.pdf","spreadsheet/sheet","spreadsheet/range","spreadsheet/references","spreadsheet/numformat","util/text-metrics"],b);
}(function(){if(kendo.support.browser.msie&&kendo.support.browser.version<9){return;
}var r=kendo.spreadsheet;
var a=r.CellRef;
var f=kendo.drawing;
var i=r.formatting;
var j=kendo.geometry;
var l=0.8;
function b(v,x){var u=0;
var w=[];
var y=0.2*x;
var t=x;
v.forEach(function(z){if(x&&u+z>t){if(t-u<y){u=x*Math.ceil(u/x);
}t+=x*Math.ceil(z/x);
}w.push(u);
u+=z;
});
w.push(u);
return w;
}function k(x,v){var t=x._grid;
var u={};
var w={};
x.forEachMergedCell(v,function(y){var z=y.topLeft;
t.forEach(y,function(A){if(z.eq(A)){u[A.print()]=y;
}else{if(v.contains(A)){w[A.print()]=z;
}}});
});
return{primary:u,secondary:w};
}function c(G,D,A){var v=[];
var E=[];
var w=[];
var z=k(G,D);
var y=-1,x=-1;
G.forEach(D,function(T,L,K){var R=T-D.topLeft.row;
var Q=L-D.topLeft.col;
var S=G.rowHeight(T);
var M=G.columnWidth(L);
if(!Q){E.push(S);
}if(!R){w.push(M);
}if(G.isHiddenColumn(L)||G.isHiddenRow(T)||!S||!M){return;
}var P=A.forScreen||q(K);
if(!(A.emptyCells||P)){return;
}var N=new a(T,L).print();
if(z.secondary[N]){return;
}if(P){y=Math.max(y,R);
x=Math.max(x,Q);
}else{K.empty=true;
}var O=z.primary[N];
if(O){delete z.primary[N];
K.merged=true;
K.rowspan=O.height();
K.colspan=O.width();
if(A.forScreen){K.width=G._columns.sum(O.topLeft.col,O.bottomRight.col);
K.height=G._rows.sum(O.topLeft.row,O.bottomRight.row);
}}else{K.rowspan=1;
K.colspan=1;
}K.row=R;
K.col=Q;
v.push(K);
});
E=E.slice(0,y+1);
w=w.slice(0,x+1);
var C=A.pageWidth;
var B=A.pageHeight;
var F=1;
if(A.fitWidth){var H=w.reduce(s,0);
if(H>C){F=C/H;
C/=F;
B/=F;
}}var J=b(E,B||0);
var I=b(w,C||0);
var u=0;
var t=0;
v=v.filter(function(K){if(K.empty&&(K.row>y||K.col>x)){return false;
}K.left=I[K.col];
K.top=J[K.row];
if(K.merged){if(!A.forScreen){K.right=p(I,K.col+K.colspan);
K.bottom=p(J,K.row+K.rowspan);
K.width=K.right-K.left;
K.height=K.bottom-K.top;
}else{K.right=K.left+K.width;
K.bottom=K.top+K.height;
}}else{K.width=w[K.col];
K.height=E[K.row];
K.bottom=K.top+K.height;
K.right=K.left+K.width;
}u=Math.max(u,K.right);
t=Math.max(t,K.bottom);
return true;
});
Object.keys(z.primary).forEach(function(K){var L=z.primary[K];
G.forEach(L.topLeft.toRangeRef(),function(Q,N,M){var P=Q-D.topLeft.row;
var O=N-D.topLeft.col;
M.merged=true;
M.colspan=L.height();
M.rowspan=L.width();
if(P<0){M.top=-G._rows.sum(Q,Q-P-1);
}else{M.top=J[P];
}if(O<0){M.left=-G._columns.sum(N,N-O-1);
}else{M.left=I[O];
}M.height=G._rows.sum(L.topLeft.row,L.bottomRight.row);
M.width=G._columns.sum(L.topLeft.col,L.bottomRight.col);
if(M.height>0&&M.width>0){M.right=M.left+M.width;
M.bottom=M.top+M.height;
v.push(M);
}});
});
return{width:u,height:t,cells:v.sort(o),scale:F,xCoords:I,yCoords:J};
}function s(t,u){return t+u;
}function p(t,u){return u<t.length?t[u]:t[t.length-1];
}function q(t){return t.value!=null||t.merged||t.background!=null||t.borderTop!=null||t.borderRight!=null||t.borderBottom!=null||t.borderLeft!=null||t.validation!=null&&!t.validation.value;
}function o(t,u){if(t.top<u.top){return -1;
}else{if(t.top==u.top){if(t.left<u.left){return -1;
}else{if(t.left==u.left){return 0;
}else{return 1;
}}}else{return 1;
}}}function g(x,u,A){var y=Math.ceil(x.width/A.pageWidth);
var z=Math.ceil(x.height/A.pageHeight);
var C=A.pageWidth/x.scale;
var B=A.pageHeight/x.scale;
for(var v=0;
v<y;
++v){for(var w=0;
w<z;
++w){t(w,v);
}}function t(P,G){var K=G*C;
var O=K+C;
var Q=P*B;
var E=Q+B;
var I=0,J=0;
var F=x.cells.filter(function(R){if(R.right<=K||R.left>=O||R.bottom<=Q||R.top>=E){return false;
}I=Math.max(R.bottom,I);
J=Math.max(R.right,J);
return true;
});
if(F.length>0){var M=new f.Group();
u.append(M);
M.clip(f.Path.fromRect(new j.Rect([0,0],[A.pageWidth,A.pageHeight])));
var H=new f.Group();
M.append(H);
var L=j.Matrix.scale(x.scale,x.scale).multiplyCopy(j.Matrix.translate(-K,-Q));
if(A.hCenter||A.vCenter){L=L.multiplyCopy(j.Matrix.translate(A.hCenter?(O-J)/2:0,A.vCenter?(E-I)/2:0));
}H.transform(L);
if(A.guidelines){var N=null;
x.xCoords.forEach(function(R){R=Math.min(R,J);
if(R!==N&&R>=K&&R<=O){N=R;
H.append(new f.Path().moveTo(R,Q).lineTo(R,I).close().stroke("#999",l));
}});
var N=null;
x.yCoords.forEach(function(R){R=Math.min(R,I);
if(R!==N&&R>=Q&&R<=E){N=R;
H.append(new f.Path().moveTo(K,R).lineTo(J,R).close().stroke("#999",l));
}});
}var D=new f.Group();
F.forEach(function(R){e(R,H,D,A);
});
H.append(D);
}}}function e(u,w,t,z){var y=new f.Group();
w.append(y);
var B=new j.Rect([u.left,u.top],[u.width,u.height]);
if(u.background||u.merged){var A=B;
if(z.guidelines){A=B.clone();
A.origin.x+=l/2;
A.origin.y+=l/2;
A.size.width-=l;
A.size.height-=l;
}y.append(new f.Rect(A).fill(u.background||"#fff").stroke(null));
}if(u.borderLeft){t.append(new f.Path().moveTo(u.left,u.top).lineTo(u.left,u.bottom).close().stroke(u.borderLeft.color,u.borderLeft.size));
}if(u.borderTop){t.append(new f.Path().moveTo(u.left,u.top).lineTo(u.right,u.top).close().stroke(u.borderTop.color,u.borderTop.size));
}if(u.borderRight){t.append(new f.Path().moveTo(u.right,u.top).lineTo(u.right,u.bottom).close().stroke(u.borderRight.color,u.borderRight.size));
}if(u.borderBottom){t.append(new f.Path().moveTo(u.left,u.bottom).lineTo(u.right,u.bottom).close().stroke(u.borderBottom.color,u.borderBottom.size));
}var D=u.value;
if(D!=null){var C=typeof D=="number"?"number":null;
var v=new f.Group();
v.clip(f.Path.fromRect(B));
y.append(v);
var x;
if(u.format){x=i.textAndColor(D,u.format);
D=x.text;
if(x.type){C=x.type;
}}else{D+="";
}if(!u.textAlign){switch(C){case"number":case"date":case"percent":u.textAlign="right";
break;
case"boolean":u.textAlign="center";
break;
}}h(D,x&&x.color||u.color||"#000",u,v);
}}function h(G,v,u,y){var C=u.left+2;
var D=u.top+2;
var E=u.width-4;
var B=u.height-4;
var x=n(u);
var F={font:x};
var A={font:x,fill:{color:v}};
var z=[],H=0,J=D;
if(u.wrap){m(G,F,E).forEach(function(L){var M=new f.Text(L.text,[C,J],A);
J+=L.box.height;
z.push({el:M,box:L.box});
});
H=J-D;
}else{var I=new f.Text(G,[C,J],A);
var t=kendo.util.measureText(G,F);
z.push({el:I,box:t});
H=t.height;
}var w=new f.Group();
y.append(w);
var K=0;
switch(u.verticalAlign){case"center":K=B-H>>1;
break;
case undefined:case null:case"bottom":K=B-H;
break;
}if(K<0){K=0;
}z.forEach(function(M){w.append(M.el);
var L=0;
switch(u.textAlign){case"center":L=E-M.box.width>>1;
break;
case"right":L=E-M.box.width;
break;
}if(L<0){L=0;
}if(L||K){M.el.transform(j.Matrix.translate(L,K));
}});
}function m(y,x,z){var u=[];
var t=y.length;
var w=0;
while(w<t){v(w,t,t);
}return u;
function v(D,B,C){var E=y.substring(w,B).trim();
var A=kendo.util.measureText(E,x);
if(A.width<=z){if(B<C-1){v(B,B+C>>1,C);
}else{u.push({text:E,box:A});
w=B;
}}else{if(D<B){v(D,D+B>>1,B);
}}}}function n(t){var u=[];
if(t.italic){u.push("italic");
}if(t.bold){u.push("bold");
}u.push((t.fontSize||12)+"px");
u.push(t.fontFamily||"Arial");
return u.join(" ");
}function d(B,A,w,t){if(w==null&&t==null){t=A;
w={};
A=r.SHEETREF;
}if(t==null){t=w;
if(A instanceof r.Range||A instanceof r.Ref||typeof A=="string"){w={};
}else{w=A;
A=r.SHEETREF;
}}w=kendo.jQuery.extend({paperSize:"A4",landscape:true,margin:"1cm",guidelines:true,emptyCells:true,fitWidth:false,center:false},w);
var u=new f.Group();
var z=kendo.pdf.getPaperOptions(w);
u.options.set("pdf",{author:w.author,creator:w.creator,date:w.date,keywords:w.keywords,margin:z.margin,multiPage:true,paperSize:z.paperSize,subject:w.subject,title:w.title});
var y=z.paperSize[0];
var x=z.paperSize[1];
if(z.margin){y-=z.margin.left+z.margin.right;
x-=z.margin.top+z.margin.bottom;
}w.pageWidth=y;
w.pageHeight=x;
var v=c(B,B._ref(A),w);
g(v,u,w);
t(u);
}r.Sheet.prototype.draw=function(v,u,t){var w=this;
if(w._workbook){w.recalc(w._workbook._context,function(){d(w,v,u,t);
});
}else{d(w,v,u,t);
}};
r.draw={doLayout:c,drawLayout:g,shouldDrawCell:q};
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
(function(b,a){a("kendo.spreadsheet",["util/undoredostack","util/text-metrics","util/parse-xml","kendo.excel","kendo.progressbar","kendo.pdf","spreadsheet/commands","spreadsheet/formulabar","spreadsheet/formulainput","spreadsheet/eventlistener","spreadsheet/rangelist","spreadsheet/propertybag","spreadsheet/references","spreadsheet/navigator","spreadsheet/axismanager","spreadsheet/clipboard","spreadsheet/range","spreadsheet/sheet","spreadsheet/sheetsbar","spreadsheet/excel-reader","spreadsheet/workbook","spreadsheet/formulacontext","spreadsheet/controller","spreadsheet/view","spreadsheet/customeditors","spreadsheet/grid","spreadsheet/axis","spreadsheet/filter","spreadsheet/sorter","spreadsheet/runtime","spreadsheet/calc","spreadsheet/numformat","spreadsheet/runtime.functions","spreadsheet/runtime.functions.2","spreadsheet/toolbar","spreadsheet/dialogs","spreadsheet/sheetbinder","spreadsheet/filtermenu","spreadsheet/editor","spreadsheet/autofill","spreadsheet/nameeditor","spreadsheet/print"],b);
}(function(){var a={id:"spreadsheet",name:"Spreadsheet",category:"web",description:"Spreadsheet component",depends:["core","binder","colorpicker","combobox","data","dom","dropdownlist","menu","ooxml","popup","sortable","tabstrip","toolbar","treeview","window","validator","excel","pdf","drawing"]};
(function(f,i){if(f.support.browser.msie&&f.support.browser.version<9){return;
}var b=f.jQuery;
var k=f.ui.Widget;
var l=f.spreadsheet.Workbook;
var e=f.spreadsheet.Controller;
var j=f.spreadsheet.View;
var g=".kendoSpreadsheet";
var c={recalc:true,selection:true,activeCell:true,layout:true,sheetSelection:true,resize:true,editorChange:false,editorClose:false};
var d={wrapper:"k-widget k-spreadsheet"};
var h=f.ui.Widget.extend({init:function(m,n){k.fn.init.call(this,m,n);
this.element.addClass(h.classNames.wrapper);
this._view=new j(this.element,{messages:this.options.messages.view,toolbar:this.options.toolbar,sheetsbar:this.options.sheetsbar});
this._workbook=new l(this.options,this._view);
this._controller=new e(this._view,this._workbook);
this._autoRefresh=true;
this._bindWorkbookEvents();
this._view.workbook(this._workbook);
this.refresh();
this._resizeHandler=function(){this.resize();
}.bind(this);
b(window).on("resize"+g,this._resizeHandler);
},_resize:function(){this.refresh({layout:true});
},_workbookChange:function(m){if(this._autoRefresh){this.refresh(m);
}if(m.recalc&&m.ref){var n=new f.spreadsheet.Range(m.ref,this.activeSheet());
this.trigger("change",{range:n});
}},activeSheet:function(m){return this._workbook.activeSheet(m);
},moveSheetToIndex:function(n,m){return this._workbook.moveSheetToIndex(n,m);
},insertSheet:function(m){return this._workbook.insertSheet(m);
},sheets:function(){return this._workbook.sheets();
},removeSheet:function(m){return this._workbook.removeSheet(m);
},sheetByName:function(m){return this._workbook.sheetByName(m);
},sheetIndex:function(m){return this._workbook.sheetIndex(m);
},sheetByIndex:function(m){return this._workbook.sheetByIndex(m);
},renameSheet:function(n,m){return this._workbook.renameSheet(n,m);
},refresh:function(m){if(!m){m=c;
}if(!m.editorClose){this._view.sheet(this._workbook.activeSheet());
this._controller.sheet(this._workbook.activeSheet());
this._workbook.refresh(m);
}if(!m.editorChange){this._view.refresh(m);
this._controller.refresh();
this._view.render();
this.trigger("render");
}return this;
},openDialog:function(m,n){return this._view.openDialog(m,n);
},autoRefresh:function(m){if(m!==i){this._autoRefresh=m;
if(m===true){this.refresh();
}return this;
}return this._autoRefresh;
},toJSON:function(){return this._workbook.toJSON();
},fromJSON:function(m){if(m.sheets){this._workbook.destroy();
this._workbook=new l(b.extend({},this.options,m));
this._bindWorkbookEvents();
this._view.workbook(this._workbook);
this._controller.workbook(this._workbook);
this.activeSheet(this.activeSheet());
}else{this.refresh();
}},fromFile:function(m,n){return this._workbook.fromFile(m,n);
},saveAsPDF:function(m){this._workbook.saveAsPDF(b.extend({},this.options.pdf,m,{workbook:this._workbook}));
},saveAsExcel:function(m){this._workbook.saveAsExcel(m);
},draw:function(n,m){this._workbook.draw(n,m);
},_workbookExcelExport:function(m){if(this.trigger("excelExport",m)){m.preventDefault();
}},_workbookExcelImport:function(m){if(this.trigger("excelImport",m)){m.preventDefault();
}else{this._initProgress(m.promise);
}},_initProgress:function(m){var n=b("<div class='k-loading-mask' style='width: 100%; height: 100%; top: 0;'><div class='k-loading-color'/></div>").appendTo(this.element);
var o=b("<div class='k-loading-progress'>").appendTo(n).kendoProgressBar({type:"chunk",chunkCount:10,min:0,max:1,value:0}).data("kendoProgressBar");
m.progress(function(p){o.value(p.progress);
}).always(function(){f.destroy(n);
n.remove();
});
},_workbookPdfExport:function(m){if(this.trigger("pdfExport",m)){m.preventDefault();
}},_bindWorkbookEvents:function(){this._workbook.bind("change",this._workbookChange.bind(this));
this._workbook.bind("excelExport",this._workbookExcelExport.bind(this));
this._workbook.bind("excelImport",this._workbookExcelImport.bind(this));
this._workbook.bind("pdfExport",this._workbookPdfExport.bind(this));
},destroy:function(){f.ui.Widget.fn.destroy.call(this);
this._workbook.destroy();
this._controller.destroy();
this._view.destroy();
if(this._resizeHandler){b(window).off("resize"+g,this._resizeHandler);
}},options:{name:"Spreadsheet",toolbar:true,sheetsbar:true,rows:200,columns:50,rowHeight:20,columnWidth:64,headerHeight:20,headerWidth:32,excel:{proxyURL:"",fileName:"Workbook.xlsx"},messages:{},pdf:{area:"workbook",fileName:"Workbook.pdf",proxyURL:"",paperSize:"a4",landscape:true,margin:null,title:null,author:null,subject:null,keywords:null,creator:"Kendo UI PDF Generator v."+f.version,date:null}},defineName:function(n,o,m){return this._workbook.defineName(n,o,m);
},undefineName:function(m){return this._workbook.undefineName(m);
},nameValue:function(m){return this._workbook.nameValue(m);
},forEachName:function(m){return this._workbook.forEachName(m);
},events:["pdfExport","excelExport","excelImport","change","render"]});
f.spreadsheet.ALL_REASONS=c;
f.ui.plugin(h);
b.extend(true,h,{classNames:d});
}(window.kendo));
},typeof define=="function"&&define.amd?define:function(a,b,c){(c||b)();
}));
